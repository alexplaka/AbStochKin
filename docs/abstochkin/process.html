<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>abstochkin.process API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../abstochkin.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;abstochkin</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Process">Process</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Process.__init__">Process</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.reactants">reactants</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.products">products</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.k">k</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.volume">volume</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.order">order</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.is_heterogeneous">is_heterogeneous</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.species">species</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.reacts_">reacts_</a>
                        </li>
                        <li>
                                <a class="variable" href="#Process.prods_">prods_</a>
                        </li>
                        <li>
                                <a class="function" href="#Process.from_string">from_string</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ReversibleProcess">ReversibleProcess</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ReversibleProcess.__init__">ReversibleProcess</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReversibleProcess.k_rev">k_rev</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReversibleProcess.is_heterogeneous_rev">is_heterogeneous_rev</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReversibleProcess.order_rev">order_rev</a>
                        </li>
                        <li>
                                <a class="function" href="#ReversibleProcess.from_string">from_string</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MichaelisMentenProcess">MichaelisMentenProcess</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MichaelisMentenProcess.__init__">MichaelisMentenProcess</a>
                        </li>
                        <li>
                                <a class="variable" href="#MichaelisMentenProcess.catalyst">catalyst</a>
                        </li>
                        <li>
                                <a class="variable" href="#MichaelisMentenProcess.Km">Km</a>
                        </li>
                        <li>
                                <a class="variable" href="#MichaelisMentenProcess.is_heterogeneous_Km">is_heterogeneous_Km</a>
                        </li>
                        <li>
                                <a class="function" href="#MichaelisMentenProcess.from_string">from_string</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RegulatedProcess">RegulatedProcess</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RegulatedProcess.__init__">RegulatedProcess</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedProcess.alpha">alpha</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedProcess.K50">K50</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedProcess.nH">nH</a>
                        </li>
                        <li>
                                <a class="function" href="#RegulatedProcess.from_string">from_string</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RegulatedMichaelisMentenProcess">RegulatedMichaelisMentenProcess</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RegulatedMichaelisMentenProcess.__init__">RegulatedMichaelisMentenProcess</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedMichaelisMentenProcess.catalyst">catalyst</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedMichaelisMentenProcess.Km">Km</a>
                        </li>
                        <li>
                                <a class="variable" href="#RegulatedMichaelisMentenProcess.is_heterogeneous_Km">is_heterogeneous_Km</a>
                        </li>
                        <li>
                                <a class="function" href="#RegulatedMichaelisMentenProcess.from_string">from_string</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#NullSpeciesNameError">NullSpeciesNameError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="function" href="#update_all_species">update_all_species</a>
            </li>
    </ul>


            <footer>Â© Copyright 2024-2025, Alex Plakantonakis.</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../abstochkin.html">abstochkin</a><wbr>.process    </h1>

                        <div class="docstring"><p>Define a process of the form Reactants -> Products.</p>
</div>

                        <input id="mod-process-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-process-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot; Define a process of the form Reactants -&gt; Products. &quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="c1">#  Copyright (c) 2024-2025, Alex Plakantonakis.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="c1">#</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="c1">#  This program is free software: you can redistribute it and/or modify</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1">#  it under the terms of the GNU General Public License as published by</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="c1">#  the Free Software Foundation, either version 3 of the License, or</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="c1">#  (at your option) any later version.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="c1">#</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="c1">#  This program is distributed in the hope that it will be useful,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="c1">#  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="c1">#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="c1">#  GNU General Public License for more details.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="c1">#</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="c1">#  You should have received a copy of the GNU General Public License</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="c1">#  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">import</span> <span class="nn">contextlib</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Self</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span> <span class="nn">abstochkin.utils</span> <span class="kn">import</span> <span class="n">macro_to_micro</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="k">class</span> <span class="nc">Process</span><span class="p">:</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">    Define a unidirectional process: Reactants -&gt; Products, where the</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">    Reactants and Products are specified using standard chemical notation.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">    That is, stoichiometric coefficients (integers) and species names are</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">    specified. For example: 2A + B -&gt; C.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">    Attributes</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">    ----------</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">    reactants : dict</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">        The reactants of a given process are specified with</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">        key-value pairs describing each species name and its</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">        stoichiometric coefficient, respectively.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">    products : dict</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">        The products of a given process are specified with</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">        key-value pairs describing each species name and its</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">        stoichiometric coefficient, respectively.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">    k : float, int, list of floats, tuple of floats</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">        The *microscopic* rate constant(s) for the given process. The data</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">        type of `k` determines the &quot;structure&quot; of the population as follows:</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">            - A homogeneous population: if `k` is a single value (float or int),</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">              then the population is assumed to be homogeneous with all agents</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">              of the reactant species having kinetics defined by this value.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">            - A heterogeneous population with a distinct number of subspecies</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">              (each with a corresponding `k` value): if `k` is a list of floats,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">              then the population is assumed to be heterogeneous with a number</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">              of subspecies equal to the length of the list.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">            - A heterogeneous population with normally-distributed `k` values:</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">              If `k` is a tuple whose length is 2, then the population is</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">              assumed to be heterogeneous with a normally distributed `k` value.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">              The two entries in the tuple represent the mean and standard</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">              deviation (in that order) of the desired normal distribution.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">    volume : float, default : None, optional</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">        The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">        are taking place.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">    order : int</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">        The order of the process (or the molecularity of an elementary process).</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">        It is the sum of the stoichiometric coefficients of the reactants.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    species : set of strings</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">        A set of all species in a process.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    reacts_ : list of strings</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">        A list containing all the reactants in a process.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    prods_ : list of strings</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        A list containing all the products in a process.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    Methods</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    -------</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    from_string</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">        Class method for creating a Process object from a string.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">=</span> <span class="n">reactants</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">=</span> <span class="n">products</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nums</span><span class="p">()</span>  <span class="c1"># make sure there are no errors in given numbers</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>        <span class="c1"># For consistency with processes instantiated using the class method `from_string()`,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>        <span class="c1"># species denoted as &#39;None&#39; for a 0th order process are renamed to &#39;&#39;.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Since a birth process does not depended on the presence of agents, &quot;</span> \
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>                  <span class="s2">&quot;heterogeneity does not make sense in this context. Please define &quot;</span> \
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>                  <span class="s2">&quot;the rate constant k as a number. &quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span><span class="p">,</span> <span class="n">msg</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="c1"># Convert macroscopic to microscopic rate constant</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="c1"># Two ways of storing the involved species:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>        <span class="c1"># 1) A set of all species</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># remove empty species name from any 0th order processes</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>        <span class="c1"># 2) Separate lists</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [reactant species]</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [product species]</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_reacts_prods_</span><span class="p">()</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Because Process objects are used as keys in dictionaries used </span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">        in an AbStochKin simulation, it&#39;s much faster to generate the object&#39;s </span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">        string representation once, and then access it whenever it&#39;s needed </span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">        (which could be thousands of times during a simulation). &quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="k">def</span> <span class="nf">_get_reacts_prods_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Make lists of the reactant and product species. Repeated</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">        elements of a list reflect the order or molecularity of the</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">        species in the given process. For example, for the process</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">        `2A + B -&gt; C + D, reacts_ = [&#39;A&#39;, &#39;A&#39;, &#39;B&#39;], prods_ = [&#39;C&#39;, &#39;D&#39;]`. &quot;&quot;&quot;</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="k">if</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="p">:</span>  <span class="c1"># remove empty reactant species names</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># from 0th order processes</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>        <span class="k">if</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="p">:</span>  <span class="c1"># remove empty product species names</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># from degradation processes</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a process from a string.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">        Parameters</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="sd">        ----------</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="sd">        proc_str : str</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">            The rate constant for the given process. If `k` is a float or</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">            int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">            are taking place.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        Notes</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        -----</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        Examples</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        --------</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;2A + B -&gt; X&quot;, 0.3)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot; -&gt; Y&quot;, 0.1)  # for a 0th order (birth) process.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;Protein_X -&gt; None&quot;, 0.15)  # for a 1st order degradation process.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>    <span class="k">def</span> <span class="nf">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">        The `Process` class accepts additional arguments (`**kwargs`).</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">        Since the Process class is a base class for other subclasses,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">        this is done so that the Liskov Substitution Principle (LSP)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">        is not violated.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        (https://en.wikipedia.org/wiki/Liskov_substitution_principle).</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">        This way, subclasses override the `from_string` method and have</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">        additional parameters while remaining consistent with this method</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">        from their base class. Calling the base instance with the additional</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">        parameters gives a warning that they will have no effect so that</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        the user can intervene, if that&#39;s desired.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Warning: Additional parameters </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>              <span class="sa">f</span><span class="s2">&quot;will have no effect. &quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="k">if</span> <span class="s1">&#39;k_rev&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>                   <span class="sa">f</span><span class="s2">&quot;using ReversibleProcess().&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="k">if</span> <span class="s1">&#39;regulating_species&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> \
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="s1">&#39;nH&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;K50&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>                   <span class="sa">f</span><span class="s2">&quot;using RegulatedProcess().&quot;</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="k">if</span> <span class="s1">&#39;catalyst&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>                   <span class="sa">f</span><span class="s2">&quot;using MichaelisMentenProcess().&quot;</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="k">def</span> <span class="nf">_to_dict</span><span class="p">(</span><span class="n">terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Convert the information for a side (left, right) of a process</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        to a dictionary. &quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="n">side_terms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># for storing the information of a side of a process</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="n">patt</span> <span class="o">=</span> <span class="s1">&#39;^[</span><span class="se">\\</span><span class="s1">-]*[1-9]+&#39;</span>  <span class="c1"># regex pattern (accounts for leading erroneous minus sign)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>            <span class="n">spec</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># Zeroth order process</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>            <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>                <span class="n">term</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="n">term</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">())]</span>  <span class="c1"># extract stoichiometric coef</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>                    <span class="n">spec</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># extract species name</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>                    <span class="k">if</span> <span class="n">spec</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">stoic_coef</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>                        <span class="k">raise</span> <span class="n">NullSpeciesNameError</span><span class="p">()</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stoic_coef</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># when there is no specified stoichiometric coefficient</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>                    <span class="n">spec</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># extract species name</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>                <span class="k">if</span> <span class="n">spec</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">side_terms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>                    <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoic_coef</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>                    <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">+=</span> <span class="n">stoic_coef</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="k">return</span> <span class="n">side_terms</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>    <span class="k">def</span> <span class="nf">_validate_nums</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Make sure coefficients, rate constant, and volume values are not negative. &quot;&quot;&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>        <span class="c1"># Check coefficients</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>            <span class="k">assert</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Coefficient cannot be negative: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="c1"># Check rate constants</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rate constant values have to be positive: k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>  <span class="c1"># heterogeneous population</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">error_msg</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># when k is a float or int, the population is homogeneous</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">error_msg</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>        <span class="c1"># For normally-distributed k values, specification is a 2-tuple.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># normal distribution of k values</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Please specify the mean and standard deviation &quot;</span> \
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>                                     <span class="s2">&quot;of k in a 2-tuple: (mean, std).&quot;</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="c1"># Check volume</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Volume cannot be negative: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Process</span><span class="p">):</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Process Object: Process.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process.&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed k with &quot;</span> \
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>                      <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct_string</span><span class="p">()</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="n">vol_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, volume = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2"> L&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>        <span class="k">return</span> <span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">])</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;, k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}{</span><span class="n">vol_str</span><span class="si">}</span><span class="s1">; </span><span class="si">{</span><span class="n">het_str</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>    <span class="k">def</span> <span class="nf">_reconstruct_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="n">lhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>        <span class="n">rhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>        <span class="k">return</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="k">class</span> <span class="nc">ReversibleProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a reversible process.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">    The class-specific attributes are listed below.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">    Attributes</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">    ----------</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">    k_rev : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        The *microscopic* rate constant for the reverse process.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">    is_heterogeneous_rev : bool</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        Denotes if the parameter `k_rev` exhibits heterogeneity</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">    Notes</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">    -----</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">    A `ReversibleProcess` object gets split into two `Process` objects</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">    (forward and reverse process) when the algorithm runs.</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>                 <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">k_rev</span>  <span class="c1"># rate constant for reverse process</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_rev</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic rate constants</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">k_rev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>                    <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a reversible process from a string.</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        Parameters</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        ----------</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        proc_str : str</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">            (e.g., &#39;A + B &lt;-&gt; C&#39;)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a><span class="sd">            The *microscopic* rate constant for the forward process.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="sd">        k_rev : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">            The *microscopic* rate constant for the reverse process.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">            are taking place.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        sep : str, default: &#39;&lt;-&gt;&#39;</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">            products. The default is &#39;&lt;-&gt;&#39;. The code also treats `&lt;--&gt;` as a</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">        Notes</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">        -----</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">        Examples</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">        --------</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">        &gt;&gt;&gt; ReversibleProcess.from_string(&quot;2A + B &lt;-&gt; X&quot;, 0.3, k_rev=0.2)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;--&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;==&gt;&#39;</span><span class="p">]:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>            <span class="n">sep</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;&lt;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>                   <span class="n">k_rev</span><span class="o">=</span><span class="n">k_rev</span><span class="p">,</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="n">repr_k_rev</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>                                    <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ReversibleProcess Object: ReversibleProcess.from_string(&quot;</span> \
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>               <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>               <span class="sa">f</span><span class="s2">&quot;k_rev=</span><span class="si">{</span><span class="n">repr_k_rev</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="s2">&quot;Forward homogeneous process.&quot;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Forward heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>                      <span class="sa">f</span><span class="s2">&quot;distinct subspecies.&quot;</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Forward heterogeneous process with normally-distributed &quot;</span> \
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>                      <span class="sa">f</span><span class="s2">&quot;k with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="s2">&quot;Reverse homogeneous process.&quot;</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Reverse heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                          <span class="sa">f</span><span class="s2">&quot;distinct subspecies.&quot;</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Reverse heterogeneous process with normally-distributed &quot;</span> \
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                          <span class="sa">f</span><span class="s2">&quot;k with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct_string</span><span class="p">()</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="n">vol_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, volume = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2"> L&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="k">return</span> <span class="s2">&quot; &lt;-&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">])</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;, k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}</span><span class="s2">, k_rev = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="si">}{</span><span class="n">vol_str</span><span class="si">}</span><span class="s2">; &quot;</span> \
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>                                          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">het_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">het_rev_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>    <span class="k">def</span> <span class="nf">_reconstruct_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="n">lhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>        <span class="n">rhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>        <span class="k">return</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ReversibleProcess</span><span class="p">):</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k_rev</span> <span class="ow">and</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order_rev</span> <span class="ow">and</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="k">class</span> <span class="nc">MichaelisMentenProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that obeys Michaelis-Menten kinetics.</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">    The class-specific attributes are listed below.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">    Attributes</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a><span class="sd">    ----------</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">    catalyst : str</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">        Name of the species acting as a catalyst for this process.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">    Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="sd">        *Microscopic* Michaelis constant. Corresponds to the number</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        of `catalyst` agents that would produce half-maximal activity.</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="sd">    is_heterogeneous_Km : bool</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        Denotes if the parameter `Km` exhibits heterogeneity</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a Michaelis-Menten process from a string.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">        Parameters</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">        ----------</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        proc_str : str</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">            The *microscopic* rate constant for the given process. If `k` is a</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">            float or int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        catalyst : str</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">            are taking place.</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="sd">        Notes</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="sd">        -----</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">        Examples</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a><span class="sd">        --------</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;E&#39;, Km=10)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;alpha&#39;, Km=(10, 1))</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="n">repr_Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Km</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MichaelisMentenProcess Object: &quot;</span> \
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>               <span class="sa">f</span><span class="s2">&quot;MichaelisMentenProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>               <span class="sa">f</span><span class="s2">&quot;catalyst=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>               <span class="sa">f</span><span class="s2">&quot;Km=</span><span class="si">{</span><span class="n">repr_Km</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to Km.&quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to Km &quot;</span> \
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                         <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed Km with &quot;</span> \
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                         <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Catalyst: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Km_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MichaelisMentenProcess</span><span class="p">):</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">catalyst</span> <span class="ow">and</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Km</span> <span class="ow">and</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="k">class</span> <span class="nc">RegulatedProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that is regulated.</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">    This class allows a Process to be defined in terms of how it is regulated.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">    If there is only one regulating species, then the parameters have the same</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">    type as would be expected for a homogeneous/heterogeneous process.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">    If there are multiple regulating species, then all parameters are a list</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">    of their expected type, with the length of the list being equal to the</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">    number of regulating species.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">    The class-specific attributes (except for `k`, which requires some</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">    additional notes) are listed below.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">    </span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">    Attributes</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">    ----------</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">    k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a><span class="sd">        The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">        and the maximum rate constant in the case of repression.</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">    regulating_species : str or list of str</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">        Name of the regulating species. Multiple species can be specified as</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">        comma-separated in a string or a list of strings with the species names.</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">    alpha : float or int or list[float or int]</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">        Parameter denoting the degree of activation/repression.</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">            </span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        alpha is a multiplier: in the case of activation, the maximum </span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        rate constant value will be `alpha * k`. </span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">        In the case of repression, the minimum </span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        rate constant value will be `alpha * k`. </span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">    K50 : float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        *Microscopic* constant that corresponds to the number of</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        `regulating_species` agents that would produce </span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        half-maximal activation/repression. </span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">    nH : float or int or list[float or int]</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">        Hill coefficient for the given process. Indicates the degree of </span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">        cooperativity in the regulatory interaction. </span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">    is_heterogeneous_K50 : bool or list of bool</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        Denotes if the parameter `K50` exhibits heterogeneity</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">    regulation_type : str or list of str</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        The type of regulation for this process based on the value of alpha:</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">        &#39;activation&#39; or &#39;repression&#39; or &#39;no regulation&#39;.</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">    Notes</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">    -----</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">    Allowing a 0th order process to be regulated. However, heterogeneity</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">    in `k` and `K50` (or any other parameters) is not allowed for such</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">    a process.</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="n">reg_sp_list</span> <span class="o">=</span> <span class="n">regulating_species</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">reg_sp_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reg_sp_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">reg_sp_list</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if it is a list</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">regulating_species</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">K50</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">=</span> <span class="n">nH</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">val</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>                                         <span class="ow">in</span> <span class="n">K50</span><span class="p">]</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic K50 value</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, regulating_species = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                     <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>                <span class="n">reg_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg_type</span><span class="p">)</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>    <span class="k">def</span> <span class="nf">_validate_reg_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Validate the parameters specific to the regulation. &quot;&quot;&quot;</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># multiple regulating species</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>            <span class="c1"># First check that the right number of values for each parameter are specified</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>            <span class="n">rs_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Must specify </span><span class="si">{</span><span class="n">rs_num</span><span class="si">}</span><span class="s2"> # values when there are </span><span class="si">{</span><span class="n">rs_num</span><span class="si">}</span><span class="s2"> regulating species.&quot;</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;K50&#39;</span><span class="p">)</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;nH&#39;</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">)):</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The alpha parameter must be nonnegative.&quot;</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: alpha=1 means the process is not regulated.&quot;</span><span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;K50 has to be positive.&quot;</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>                    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> \
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>                        <span class="s2">&quot;Subspecies K50 values have to be positive.&quot;</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>                <span class="k">else</span><span class="p">:</span>  <span class="c1"># isinstance(self.K50, tuple)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>                        <span class="s2">&quot;Mean and std of K50 have to be positive.&quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>                    <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                        <span class="s2">&quot;Heterogeneity in parameter K50 is not allowed for a 0th order process.&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;nH has to be positive.&quot;</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># just one regulating species</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The alpha parameter must be nonnegative.&quot;</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: alpha=1 means the process is not regulated.&quot;</span><span class="p">)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;K50 has to be positive.&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>                <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">]),</span> \
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>                    <span class="s2">&quot;Subspecies K50 values have to be positive.&quot;</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># isinstance(self.K50, tuple)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>                    <span class="s2">&quot;Mean and std of K50 have to be positive.&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>                <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span><span class="p">,</span> \
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>                    <span class="s2">&quot;Heterogeneity in parameter K50 is not allowed for a 0th order process.&quot;</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;nH has to be positive.&quot;</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated process from a string.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        Parameters</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">        ----------</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">        proc_str : str</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value) </span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">            and the maximum rate constant in the case of repression. </span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous. </span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">            If `k` is a list, then the population of the reactants </span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">            constsists of distinct subspecies or subinteractions </span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">                - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">                - alpha = 1: no regulation</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">                - alpha &gt; 1: activation</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">                </span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum </span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">            In the case of repression, the minimum </span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">            `regulating_species` agents that would produce </span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">            half-maximal activation/repression. </span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of </span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">            are taking place.</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">        Notes</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        -----</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">        Examples</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">        --------</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;X&#39;, alpha=0.5, K50=[10, 15], nH=2)</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A + B -&gt; X&quot;, k=0.5, regulating_species=&#39;B, X&#39;, alpha=[2, 0], K50=[(15, 5), [10, 15]], nH=[1, 2])</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="n">repr_K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;RegulatedProcess Object: &quot;</span> \
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>               <span class="sa">f</span><span class="s2">&quot;RegulatedProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>               <span class="sa">f</span><span class="s2">&quot;regulating_species=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>               <span class="sa">f</span><span class="s2">&quot;alpha=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>               <span class="sa">f</span><span class="s2">&quot;K50=</span><span class="si">{</span><span class="n">repr_K50</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>               <span class="sa">f</span><span class="s2">&quot;nH=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">,&quot;</span> \
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>            <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">):</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Homogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50. &quot;</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 &quot;</span> \
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>                                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2"> distinct subspecies. &quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed &quot;</span> \
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>                                   <span class="sa">f</span><span class="s2">&quot;species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and &quot;</span> \
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>                                   <span class="sa">f</span><span class="s2">&quot;standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to K50.&quot;</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to K50 &quot;</span> \
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                              <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed K50 with &quot;</span> \
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>                              <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Regulating Species: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>                                   <span class="sa">f</span><span class="s2">&quot;alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>                                   <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">K50_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RegulatedProcess</span><span class="p">):</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">regulating_species</span> <span class="ow">and</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">and</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">K50</span> <span class="ow">and</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nH</span> <span class="ow">and</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="k">class</span> <span class="nc">RegulatedMichaelisMentenProcess</span><span class="p">(</span><span class="n">RegulatedProcess</span><span class="p">):</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that is regulated and obeys Michaelis-Menten kinetics.</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">    This class allows a Michaelis-Menten Process to be defined</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">    in terms of how it is regulated.</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">    If there is only one regulating species, then the parameters have the same</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">    type as would be expected for a homogeneous/heterogeneous process.</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">    If there are multiple regulating species, then all parameters are a list</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">    of their expected type, with the length of the list being equal to the</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">    number of regulating species.</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">    The class-specific attributes (except for `k`, which requires some</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">    additional notes) are listed below.</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">    Attributes</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">    ----------</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">    k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        and the maximum rate constant in the case of repression.</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">    regulating_species : str or list of str</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">        Name of the regulating species. Multiple species can be specified as</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">        comma-separated in a string or a list of strings with the species names.</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">    alpha : float or int or list[float or int]</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        Parameter denoting the degree of activation/repression.</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">        alpha is a multiplier: in the case of activation, the maximum</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">        rate constant value will be `alpha * k`.</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">        In the case of repression, the minimum</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">        rate constant value will be `alpha * k`.</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">    K50 : float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">        *Microscopic* constant that corresponds to the number of</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        `regulating_species` agents that would produce</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        half-maximal activation/repression.</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">    nH : float or int or list[float or int]</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">        Hill coefficient for the given process. Indicates the degree of</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">        cooperativity in the regulatory interaction.</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">    is_heterogeneous_K50 : bool or list of bool</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">        Denotes if the parameter `K50` exhibits heterogeneity</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">    regulation_type : str or list of str</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        The type of regulation for this process based on the value of alpha:</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">        &#39;activation&#39; or &#39;repression&#39; or &#39;no regulation&#39;.</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">    catalyst : str</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">        Name of the species acting as a catalyst for this process.</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">    Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        *Microscopic* Michaelis constant. Corresponds to the number</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        of `catalyst` agents that would produce half-maximal activity.</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">    is_heterogeneous_Km : bool</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">        Denotes if the parameter `Km` exhibits heterogeneity</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">    Notes</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">    -----</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">    Currently only implemented for 1st order processes. 0th order processes</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">    cannot obey Michaelis-Menten kinetics and 2nd order Michaelis-Menten</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">    processes are not implemented yet.</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>                         <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>                         <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>                         <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>                         <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated Michaelis-Menten process from a string.</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        Parameters</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        ----------</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        proc_str : str</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="sd">            and the maximum rate constant in the case of repression.</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous.</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a><span class="sd">            If `k` is a list, then the population of the reactants</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a><span class="sd">            constsists of distinct subspecies or subinteractions</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">            In the case of repression, the minimum</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">            `regulating_species` agents that would produce</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">            half-maximal activation/repression.</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        catalyst : str</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="sd">            are taking place.</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        Notes</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">        -----</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">        Examples</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">        --------</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1, catalyst=&#39;E&#39;, Km=15)</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;A&#39;, alpha=0.5, K50=[10, 15], nH=2, catalyst=&#39;C&#39;, Km=5)</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>        <span class="n">repr_K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>        <span class="n">repr_Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Km</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;RegulatedMichaelisMentenProcess Object: &quot;</span> \
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>               <span class="sa">f</span><span class="s2">&quot;RegulatedMichaelisMentenProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>               <span class="sa">f</span><span class="s2">&quot;regulating_species=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>               <span class="sa">f</span><span class="s2">&quot;alpha=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>               <span class="sa">f</span><span class="s2">&quot;K50=</span><span class="si">{</span><span class="n">repr_K50</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>               <span class="sa">f</span><span class="s2">&quot;nH=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>               <span class="sa">f</span><span class="s2">&quot;catalyst=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>               <span class="sa">f</span><span class="s2">&quot;Km=</span><span class="si">{</span><span class="n">repr_Km</span><span class="si">}</span><span class="s2">,&quot;</span> \
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>            <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">):</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Homogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50. &quot;</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 &quot;</span> \
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>                                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2"> distinct subspecies. &quot;</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed &quot;</span> \
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>                                   <span class="sa">f</span><span class="s2">&quot;species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and &quot;</span> \
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>                                   <span class="sa">f</span><span class="s2">&quot;standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to K50.&quot;</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to K50 &quot;</span> \
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>                              <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed K50 with &quot;</span> \
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>                              <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to Km.&quot;</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to Km &quot;</span> \
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>                         <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed Km with &quot;</span> \
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>                         <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Regulating Species: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>                                   <span class="sa">f</span><span class="s2">&quot;alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>                                   <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">K50_het_str</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Catalyst: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Km_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RegulatedMichaelisMentenProcess</span><span class="p">):</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">regulating_species</span> <span class="ow">and</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">and</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">K50</span> <span class="ow">and</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nH</span> <span class="ow">and</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">catalyst</span> <span class="ow">and</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Km</span> <span class="ow">and</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="k">class</span> <span class="nc">NullSpeciesNameError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Error when the species name is an empty string. &quot;&quot;&quot;</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="k">return</span> <span class="s2">&quot;A species name cannot be an empty string.&quot;</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="k">def</span> <span class="nf">update_all_species</span><span class="p">(</span><span class="n">procs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Process</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Categorize all species in a list of processes.</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">    Extract all species from a list of processes. Then categorize each of them</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">    as a reactant or product and list the process(es) it takes part in.</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">    Parameters</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">    ----------</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">    procs : tuple</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">        A tuple of objects of type `Process` or its subclasses.</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    Returns</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">    -------</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">    tuple</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">        all_species : set of strings</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">            A set of all species present in the processes.</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        procs_by_reactant : dict</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">            A dictionary whose keys are the species that are</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">            reactants in one or more processes. The value for each</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">            key is a list of processes.</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="sd">        procs_by_product : dict</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a><span class="sd">            A dictionary whose keys are the species that are</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a><span class="sd">            products in one or more processes. The value for each</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a><span class="sd">            key is a list of processes.</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="n">procs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">procs</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="c1"># For a reversible process, replace it with separate instances</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>        <span class="c1"># of Process objects representing the forward and reverse reactions.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">ReversibleProcess</span><span class="p">):</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="n">forward_proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>            <span class="n">reverse_proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">k_rev</span><span class="p">)</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>            <span class="n">procs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>            <span class="n">procs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">forward_proc</span><span class="p">,</span> <span class="n">reverse_proc</span><span class="p">])</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">procs</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">procs</span><span class="p">),</span> \
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>        <span class="s2">&quot;WARNING: Duplicate processes found. Examine the list of processes to resolve this.&quot;</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>    <span class="n">all_species</span><span class="p">,</span> <span class="n">rspecies</span><span class="p">,</span> <span class="n">pspecies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>    <span class="n">procs_by_reactant</span><span class="p">,</span> <span class="n">procs_by_product</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="n">all_species</span> <span class="o">=</span> <span class="n">all_species</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">species</span><span class="p">)</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="n">rspecies</span> <span class="o">=</span> <span class="n">rspecies</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>        <span class="n">pspecies</span> <span class="o">=</span> <span class="n">pspecies</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">)</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>    <span class="c1"># Make a list containing the processes each reactant species takes part in.</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>    <span class="c1"># This will be used when solving the system ODEs.</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>    <span class="k">for</span> <span class="n">rspec</span> <span class="ow">in</span> <span class="n">rspecies</span><span class="p">:</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>        <span class="k">if</span> <span class="n">rspec</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>  <span class="c1"># omit reactant species parsed from 0th order processes</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>            <span class="n">procs_by_reactant</span><span class="p">[</span><span class="n">rspec</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">proc</span> <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span> <span class="k">if</span> <span class="n">rspec</span> <span class="ow">in</span> <span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">]</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>            <span class="c1"># deleted 1st clause in above `if`: `rspec != &#39;&#39; and`</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>    <span class="c1"># Make a list containing the processes each product species takes part in.</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>    <span class="c1"># This will be used for solving the system ODEs.</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>    <span class="k">for</span> <span class="n">pspec</span> <span class="ow">in</span> <span class="n">pspecies</span><span class="p">:</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="k">if</span> <span class="n">pspec</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>  <span class="c1"># omitting product species parsed from degradation processes</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>            <span class="n">procs_by_product</span><span class="p">[</span><span class="n">pspec</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">proc</span> <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span> <span class="k">if</span> <span class="n">pspec</span> <span class="ow">in</span> <span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">]</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>    <span class="k">return</span> <span class="n">all_species</span><span class="p">,</span> <span class="n">procs_by_reactant</span><span class="p">,</span> <span class="n">procs_by_product</span>
</span></pre></div>


            </section>
                <section id="Process">
                            <input id="Process-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Process</span>:

                <label class="view-source-button" for="Process-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Process"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Process-28"><a href="#Process-28"><span class="linenos"> 28</span></a><span class="k">class</span> <span class="nc">Process</span><span class="p">:</span>
</span><span id="Process-29"><a href="#Process-29"><span class="linenos"> 29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Process-30"><a href="#Process-30"><span class="linenos"> 30</span></a><span class="sd">    Define a unidirectional process: Reactants -&gt; Products, where the</span>
</span><span id="Process-31"><a href="#Process-31"><span class="linenos"> 31</span></a><span class="sd">    Reactants and Products are specified using standard chemical notation.</span>
</span><span id="Process-32"><a href="#Process-32"><span class="linenos"> 32</span></a><span class="sd">    That is, stoichiometric coefficients (integers) and species names are</span>
</span><span id="Process-33"><a href="#Process-33"><span class="linenos"> 33</span></a><span class="sd">    specified. For example: 2A + B -&gt; C.</span>
</span><span id="Process-34"><a href="#Process-34"><span class="linenos"> 34</span></a>
</span><span id="Process-35"><a href="#Process-35"><span class="linenos"> 35</span></a><span class="sd">    Attributes</span>
</span><span id="Process-36"><a href="#Process-36"><span class="linenos"> 36</span></a><span class="sd">    ----------</span>
</span><span id="Process-37"><a href="#Process-37"><span class="linenos"> 37</span></a><span class="sd">    reactants : dict</span>
</span><span id="Process-38"><a href="#Process-38"><span class="linenos"> 38</span></a><span class="sd">        The reactants of a given process are specified with</span>
</span><span id="Process-39"><a href="#Process-39"><span class="linenos"> 39</span></a><span class="sd">        key-value pairs describing each species name and its</span>
</span><span id="Process-40"><a href="#Process-40"><span class="linenos"> 40</span></a><span class="sd">        stoichiometric coefficient, respectively.</span>
</span><span id="Process-41"><a href="#Process-41"><span class="linenos"> 41</span></a><span class="sd">    products : dict</span>
</span><span id="Process-42"><a href="#Process-42"><span class="linenos"> 42</span></a><span class="sd">        The products of a given process are specified with</span>
</span><span id="Process-43"><a href="#Process-43"><span class="linenos"> 43</span></a><span class="sd">        key-value pairs describing each species name and its</span>
</span><span id="Process-44"><a href="#Process-44"><span class="linenos"> 44</span></a><span class="sd">        stoichiometric coefficient, respectively.</span>
</span><span id="Process-45"><a href="#Process-45"><span class="linenos"> 45</span></a><span class="sd">    k : float, int, list of floats, tuple of floats</span>
</span><span id="Process-46"><a href="#Process-46"><span class="linenos"> 46</span></a><span class="sd">        The *microscopic* rate constant(s) for the given process. The data</span>
</span><span id="Process-47"><a href="#Process-47"><span class="linenos"> 47</span></a><span class="sd">        type of `k` determines the &quot;structure&quot; of the population as follows:</span>
</span><span id="Process-48"><a href="#Process-48"><span class="linenos"> 48</span></a><span class="sd">            - A homogeneous population: if `k` is a single value (float or int),</span>
</span><span id="Process-49"><a href="#Process-49"><span class="linenos"> 49</span></a><span class="sd">              then the population is assumed to be homogeneous with all agents</span>
</span><span id="Process-50"><a href="#Process-50"><span class="linenos"> 50</span></a><span class="sd">              of the reactant species having kinetics defined by this value.</span>
</span><span id="Process-51"><a href="#Process-51"><span class="linenos"> 51</span></a><span class="sd">            - A heterogeneous population with a distinct number of subspecies</span>
</span><span id="Process-52"><a href="#Process-52"><span class="linenos"> 52</span></a><span class="sd">              (each with a corresponding `k` value): if `k` is a list of floats,</span>
</span><span id="Process-53"><a href="#Process-53"><span class="linenos"> 53</span></a><span class="sd">              then the population is assumed to be heterogeneous with a number</span>
</span><span id="Process-54"><a href="#Process-54"><span class="linenos"> 54</span></a><span class="sd">              of subspecies equal to the length of the list.</span>
</span><span id="Process-55"><a href="#Process-55"><span class="linenos"> 55</span></a><span class="sd">            - A heterogeneous population with normally-distributed `k` values:</span>
</span><span id="Process-56"><a href="#Process-56"><span class="linenos"> 56</span></a><span class="sd">              If `k` is a tuple whose length is 2, then the population is</span>
</span><span id="Process-57"><a href="#Process-57"><span class="linenos"> 57</span></a><span class="sd">              assumed to be heterogeneous with a normally distributed `k` value.</span>
</span><span id="Process-58"><a href="#Process-58"><span class="linenos"> 58</span></a><span class="sd">              The two entries in the tuple represent the mean and standard</span>
</span><span id="Process-59"><a href="#Process-59"><span class="linenos"> 59</span></a><span class="sd">              deviation (in that order) of the desired normal distribution.</span>
</span><span id="Process-60"><a href="#Process-60"><span class="linenos"> 60</span></a><span class="sd">    volume : float, default : None, optional</span>
</span><span id="Process-61"><a href="#Process-61"><span class="linenos"> 61</span></a><span class="sd">        The volume *in liters* of the compartment in which the processes</span>
</span><span id="Process-62"><a href="#Process-62"><span class="linenos"> 62</span></a><span class="sd">        are taking place.</span>
</span><span id="Process-63"><a href="#Process-63"><span class="linenos"> 63</span></a><span class="sd">    order : int</span>
</span><span id="Process-64"><a href="#Process-64"><span class="linenos"> 64</span></a><span class="sd">        The order of the process (or the molecularity of an elementary process).</span>
</span><span id="Process-65"><a href="#Process-65"><span class="linenos"> 65</span></a><span class="sd">        It is the sum of the stoichiometric coefficients of the reactants.</span>
</span><span id="Process-66"><a href="#Process-66"><span class="linenos"> 66</span></a><span class="sd">    species : set of strings</span>
</span><span id="Process-67"><a href="#Process-67"><span class="linenos"> 67</span></a><span class="sd">        A set of all species in a process.</span>
</span><span id="Process-68"><a href="#Process-68"><span class="linenos"> 68</span></a><span class="sd">    reacts_ : list of strings</span>
</span><span id="Process-69"><a href="#Process-69"><span class="linenos"> 69</span></a><span class="sd">        A list containing all the reactants in a process.</span>
</span><span id="Process-70"><a href="#Process-70"><span class="linenos"> 70</span></a><span class="sd">    prods_ : list of strings</span>
</span><span id="Process-71"><a href="#Process-71"><span class="linenos"> 71</span></a><span class="sd">        A list containing all the products in a process.</span>
</span><span id="Process-72"><a href="#Process-72"><span class="linenos"> 72</span></a>
</span><span id="Process-73"><a href="#Process-73"><span class="linenos"> 73</span></a><span class="sd">    Methods</span>
</span><span id="Process-74"><a href="#Process-74"><span class="linenos"> 74</span></a><span class="sd">    -------</span>
</span><span id="Process-75"><a href="#Process-75"><span class="linenos"> 75</span></a><span class="sd">    from_string</span>
</span><span id="Process-76"><a href="#Process-76"><span class="linenos"> 76</span></a><span class="sd">        Class method for creating a Process object from a string.</span>
</span><span id="Process-77"><a href="#Process-77"><span class="linenos"> 77</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Process-78"><a href="#Process-78"><span class="linenos"> 78</span></a>
</span><span id="Process-79"><a href="#Process-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Process-80"><a href="#Process-80"><span class="linenos"> 80</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="Process-81"><a href="#Process-81"><span class="linenos"> 81</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="Process-82"><a href="#Process-82"><span class="linenos"> 82</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="Process-83"><a href="#Process-83"><span class="linenos"> 83</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Process-84"><a href="#Process-84"><span class="linenos"> 84</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="Process-85"><a href="#Process-85"><span class="linenos"> 85</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Process-86"><a href="#Process-86"><span class="linenos"> 86</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Process-87"><a href="#Process-87"><span class="linenos"> 87</span></a>
</span><span id="Process-88"><a href="#Process-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">=</span> <span class="n">reactants</span>
</span><span id="Process-89"><a href="#Process-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">=</span> <span class="n">products</span>
</span><span id="Process-90"><a href="#Process-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
</span><span id="Process-91"><a href="#Process-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>
</span><span id="Process-92"><a href="#Process-92"><span class="linenos"> 92</span></a>
</span><span id="Process-93"><a href="#Process-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nums</span><span class="p">()</span>  <span class="c1"># make sure there are no errors in given numbers</span>
</span><span id="Process-94"><a href="#Process-94"><span class="linenos"> 94</span></a>
</span><span id="Process-95"><a href="#Process-95"><span class="linenos"> 95</span></a>        <span class="c1"># For consistency with processes instantiated using the class method `from_string()`,</span>
</span><span id="Process-96"><a href="#Process-96"><span class="linenos"> 96</span></a>        <span class="c1"># species denoted as &#39;None&#39; for a 0th order process are renamed to &#39;&#39;.</span>
</span><span id="Process-97"><a href="#Process-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-98"><a href="#Process-98"><span class="linenos"> 98</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="Process-99"><a href="#Process-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-100"><a href="#Process-100"><span class="linenos">100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="Process-101"><a href="#Process-101"><span class="linenos">101</span></a>
</span><span id="Process-102"><a href="#Process-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Process-103"><a href="#Process-103"><span class="linenos">103</span></a>
</span><span id="Process-104"><a href="#Process-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="Process-105"><a href="#Process-105"><span class="linenos">105</span></a>
</span><span id="Process-106"><a href="#Process-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process-107"><a href="#Process-107"><span class="linenos">107</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Since a birth process does not depended on the presence of agents, &quot;</span> \
</span><span id="Process-108"><a href="#Process-108"><span class="linenos">108</span></a>                  <span class="s2">&quot;heterogeneity does not make sense in this context. Please define &quot;</span> \
</span><span id="Process-109"><a href="#Process-109"><span class="linenos">109</span></a>                  <span class="s2">&quot;the rate constant k as a number. &quot;</span>
</span><span id="Process-110"><a href="#Process-110"><span class="linenos">110</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span><span class="p">,</span> <span class="n">msg</span>
</span><span id="Process-111"><a href="#Process-111"><span class="linenos">111</span></a>
</span><span id="Process-112"><a href="#Process-112"><span class="linenos">112</span></a>        <span class="c1"># Convert macroscopic to microscopic rate constant</span>
</span><span id="Process-113"><a href="#Process-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Process-114"><a href="#Process-114"><span class="linenos">114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
</span><span id="Process-115"><a href="#Process-115"><span class="linenos">115</span></a>
</span><span id="Process-116"><a href="#Process-116"><span class="linenos">116</span></a>        <span class="c1"># Two ways of storing the involved species:</span>
</span><span id="Process-117"><a href="#Process-117"><span class="linenos">117</span></a>        <span class="c1"># 1) A set of all species</span>
</span><span id="Process-118"><a href="#Process-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Process-119"><a href="#Process-119"><span class="linenos">119</span></a>        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
</span><span id="Process-120"><a href="#Process-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># remove empty species name from any 0th order processes</span>
</span><span id="Process-121"><a href="#Process-121"><span class="linenos">121</span></a>
</span><span id="Process-122"><a href="#Process-122"><span class="linenos">122</span></a>        <span class="c1"># 2) Separate lists</span>
</span><span id="Process-123"><a href="#Process-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [reactant species]</span>
</span><span id="Process-124"><a href="#Process-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [product species]</span>
</span><span id="Process-125"><a href="#Process-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_reacts_prods_</span><span class="p">()</span>
</span><span id="Process-126"><a href="#Process-126"><span class="linenos">126</span></a>
</span><span id="Process-127"><a href="#Process-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Because Process objects are used as keys in dictionaries used </span>
</span><span id="Process-128"><a href="#Process-128"><span class="linenos">128</span></a><span class="sd">        in an AbStochKin simulation, it&#39;s much faster to generate the object&#39;s </span>
</span><span id="Process-129"><a href="#Process-129"><span class="linenos">129</span></a><span class="sd">        string representation once, and then access it whenever it&#39;s needed </span>
</span><span id="Process-130"><a href="#Process-130"><span class="linenos">130</span></a><span class="sd">        (which could be thousands of times during a simulation). &quot;&quot;&quot;</span>
</span><span id="Process-131"><a href="#Process-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Process-132"><a href="#Process-132"><span class="linenos">132</span></a>
</span><span id="Process-133"><a href="#Process-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process-134"><a href="#Process-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Process-135"><a href="#Process-135"><span class="linenos">135</span></a>
</span><span id="Process-136"><a href="#Process-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">_get_reacts_prods_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-137"><a href="#Process-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Make lists of the reactant and product species. Repeated</span>
</span><span id="Process-138"><a href="#Process-138"><span class="linenos">138</span></a><span class="sd">        elements of a list reflect the order or molecularity of the</span>
</span><span id="Process-139"><a href="#Process-139"><span class="linenos">139</span></a><span class="sd">        species in the given process. For example, for the process</span>
</span><span id="Process-140"><a href="#Process-140"><span class="linenos">140</span></a><span class="sd">        `2A + B -&gt; C + D, reacts_ = [&#39;A&#39;, &#39;A&#39;, &#39;B&#39;], prods_ = [&#39;C&#39;, &#39;D&#39;]`. &quot;&quot;&quot;</span>
</span><span id="Process-141"><a href="#Process-141"><span class="linenos">141</span></a>        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Process-142"><a href="#Process-142"><span class="linenos">142</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="Process-143"><a href="#Process-143"><span class="linenos">143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="Process-144"><a href="#Process-144"><span class="linenos">144</span></a>
</span><span id="Process-145"><a href="#Process-145"><span class="linenos">145</span></a>        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Process-146"><a href="#Process-146"><span class="linenos">146</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="Process-147"><a href="#Process-147"><span class="linenos">147</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="Process-148"><a href="#Process-148"><span class="linenos">148</span></a>
</span><span id="Process-149"><a href="#Process-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="p">:</span>  <span class="c1"># remove empty reactant species names</span>
</span><span id="Process-150"><a href="#Process-150"><span class="linenos">150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># from 0th order processes</span>
</span><span id="Process-151"><a href="#Process-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="p">:</span>  <span class="c1"># remove empty product species names</span>
</span><span id="Process-152"><a href="#Process-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># from degradation processes</span>
</span><span id="Process-153"><a href="#Process-153"><span class="linenos">153</span></a>
</span><span id="Process-154"><a href="#Process-154"><span class="linenos">154</span></a>    <span class="nd">@classmethod</span>
</span><span id="Process-155"><a href="#Process-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="Process-156"><a href="#Process-156"><span class="linenos">156</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="Process-157"><a href="#Process-157"><span class="linenos">157</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="Process-158"><a href="#Process-158"><span class="linenos">158</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Process-159"><a href="#Process-159"><span class="linenos">159</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="Process-160"><a href="#Process-160"><span class="linenos">160</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Process-161"><a href="#Process-161"><span class="linenos">161</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
</span><span id="Process-162"><a href="#Process-162"><span class="linenos">162</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Process-163"><a href="#Process-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a process from a string.</span>
</span><span id="Process-164"><a href="#Process-164"><span class="linenos">164</span></a>
</span><span id="Process-165"><a href="#Process-165"><span class="linenos">165</span></a><span class="sd">        Parameters</span>
</span><span id="Process-166"><a href="#Process-166"><span class="linenos">166</span></a><span class="sd">        ----------</span>
</span><span id="Process-167"><a href="#Process-167"><span class="linenos">167</span></a><span class="sd">        proc_str : str</span>
</span><span id="Process-168"><a href="#Process-168"><span class="linenos">168</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="Process-169"><a href="#Process-169"><span class="linenos">169</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="Process-170"><a href="#Process-170"><span class="linenos">170</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="Process-171"><a href="#Process-171"><span class="linenos">171</span></a><span class="sd">            The rate constant for the given process. If `k` is a float or</span>
</span><span id="Process-172"><a href="#Process-172"><span class="linenos">172</span></a><span class="sd">            int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="Process-173"><a href="#Process-173"><span class="linenos">173</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="Process-174"><a href="#Process-174"><span class="linenos">174</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="Process-175"><a href="#Process-175"><span class="linenos">175</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="Process-176"><a href="#Process-176"><span class="linenos">176</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="Process-177"><a href="#Process-177"><span class="linenos">177</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="Process-178"><a href="#Process-178"><span class="linenos">178</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="Process-179"><a href="#Process-179"><span class="linenos">179</span></a><span class="sd">            are taking place.</span>
</span><span id="Process-180"><a href="#Process-180"><span class="linenos">180</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="Process-181"><a href="#Process-181"><span class="linenos">181</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="Process-182"><a href="#Process-182"><span class="linenos">182</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="Process-183"><a href="#Process-183"><span class="linenos">183</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="Process-184"><a href="#Process-184"><span class="linenos">184</span></a>
</span><span id="Process-185"><a href="#Process-185"><span class="linenos">185</span></a><span class="sd">        Notes</span>
</span><span id="Process-186"><a href="#Process-186"><span class="linenos">186</span></a><span class="sd">        -----</span>
</span><span id="Process-187"><a href="#Process-187"><span class="linenos">187</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="Process-188"><a href="#Process-188"><span class="linenos">188</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="Process-189"><a href="#Process-189"><span class="linenos">189</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="Process-190"><a href="#Process-190"><span class="linenos">190</span></a>
</span><span id="Process-191"><a href="#Process-191"><span class="linenos">191</span></a><span class="sd">        Examples</span>
</span><span id="Process-192"><a href="#Process-192"><span class="linenos">192</span></a><span class="sd">        --------</span>
</span><span id="Process-193"><a href="#Process-193"><span class="linenos">193</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;2A + B -&gt; X&quot;, 0.3)</span>
</span><span id="Process-194"><a href="#Process-194"><span class="linenos">194</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot; -&gt; Y&quot;, 0.1)  # for a 0th order (birth) process.</span>
</span><span id="Process-195"><a href="#Process-195"><span class="linenos">195</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;Protein_X -&gt; None&quot;, 0.15)  # for a 1st order degradation process.</span>
</span><span id="Process-196"><a href="#Process-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Process-197"><a href="#Process-197"><span class="linenos">197</span></a>
</span><span id="Process-198"><a href="#Process-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process-199"><a href="#Process-199"><span class="linenos">199</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Process-200"><a href="#Process-200"><span class="linenos">200</span></a>
</span><span id="Process-201"><a href="#Process-201"><span class="linenos">201</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="Process-202"><a href="#Process-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="Process-203"><a href="#Process-203"><span class="linenos">203</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Process-204"><a href="#Process-204"><span class="linenos">204</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="Process-205"><a href="#Process-205"><span class="linenos">205</span></a>
</span><span id="Process-206"><a href="#Process-206"><span class="linenos">206</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="Process-207"><a href="#Process-207"><span class="linenos">207</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="Process-208"><a href="#Process-208"><span class="linenos">208</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="Process-209"><a href="#Process-209"><span class="linenos">209</span></a>
</span><span id="Process-210"><a href="#Process-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="Process-211"><a href="#Process-211"><span class="linenos">211</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="Process-212"><a href="#Process-212"><span class="linenos">212</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="Process-213"><a href="#Process-213"><span class="linenos">213</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Process-214"><a href="#Process-214"><span class="linenos">214</span></a>
</span><span id="Process-215"><a href="#Process-215"><span class="linenos">215</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Process-216"><a href="#Process-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="nf">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Process-217"><a href="#Process-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Process-218"><a href="#Process-218"><span class="linenos">218</span></a><span class="sd">        The `Process` class accepts additional arguments (`**kwargs`).</span>
</span><span id="Process-219"><a href="#Process-219"><span class="linenos">219</span></a><span class="sd">        Since the Process class is a base class for other subclasses,</span>
</span><span id="Process-220"><a href="#Process-220"><span class="linenos">220</span></a><span class="sd">        this is done so that the Liskov Substitution Principle (LSP)</span>
</span><span id="Process-221"><a href="#Process-221"><span class="linenos">221</span></a><span class="sd">        is not violated.</span>
</span><span id="Process-222"><a href="#Process-222"><span class="linenos">222</span></a><span class="sd">        (https://en.wikipedia.org/wiki/Liskov_substitution_principle).</span>
</span><span id="Process-223"><a href="#Process-223"><span class="linenos">223</span></a><span class="sd">        This way, subclasses override the `from_string` method and have</span>
</span><span id="Process-224"><a href="#Process-224"><span class="linenos">224</span></a><span class="sd">        additional parameters while remaining consistent with this method</span>
</span><span id="Process-225"><a href="#Process-225"><span class="linenos">225</span></a><span class="sd">        from their base class. Calling the base instance with the additional</span>
</span><span id="Process-226"><a href="#Process-226"><span class="linenos">226</span></a><span class="sd">        parameters gives a warning that they will have no effect so that</span>
</span><span id="Process-227"><a href="#Process-227"><span class="linenos">227</span></a><span class="sd">        the user can intervene, if that&#39;s desired.</span>
</span><span id="Process-228"><a href="#Process-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Process-229"><a href="#Process-229"><span class="linenos">229</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Warning: Additional parameters </span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="Process-230"><a href="#Process-230"><span class="linenos">230</span></a>              <span class="sa">f</span><span class="s2">&quot;will have no effect. &quot;</span>
</span><span id="Process-231"><a href="#Process-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="s1">&#39;k_rev&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-232"><a href="#Process-232"><span class="linenos">232</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="Process-233"><a href="#Process-233"><span class="linenos">233</span></a>                   <span class="sa">f</span><span class="s2">&quot;using ReversibleProcess().&quot;</span>
</span><span id="Process-234"><a href="#Process-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="s1">&#39;regulating_species&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> \
</span><span id="Process-235"><a href="#Process-235"><span class="linenos">235</span></a>                <span class="s1">&#39;nH&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;K50&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-236"><a href="#Process-236"><span class="linenos">236</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="Process-237"><a href="#Process-237"><span class="linenos">237</span></a>                   <span class="sa">f</span><span class="s2">&quot;using RegulatedProcess().&quot;</span>
</span><span id="Process-238"><a href="#Process-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="s1">&#39;catalyst&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-239"><a href="#Process-239"><span class="linenos">239</span></a>            <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;If that&#39;s not what you intended, define the process &quot;</span> \
</span><span id="Process-240"><a href="#Process-240"><span class="linenos">240</span></a>                   <span class="sa">f</span><span class="s2">&quot;using MichaelisMentenProcess().&quot;</span>
</span><span id="Process-241"><a href="#Process-241"><span class="linenos">241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Process-242"><a href="#Process-242"><span class="linenos">242</span></a>
</span><span id="Process-243"><a href="#Process-243"><span class="linenos">243</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Process-244"><a href="#Process-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">_to_dict</span><span class="p">(</span><span class="n">terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="Process-245"><a href="#Process-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Convert the information for a side (left, right) of a process</span>
</span><span id="Process-246"><a href="#Process-246"><span class="linenos">246</span></a><span class="sd">        to a dictionary. &quot;&quot;&quot;</span>
</span><span id="Process-247"><a href="#Process-247"><span class="linenos">247</span></a>        <span class="n">side_terms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># for storing the information of a side of a process</span>
</span><span id="Process-248"><a href="#Process-248"><span class="linenos">248</span></a>        <span class="n">patt</span> <span class="o">=</span> <span class="s1">&#39;^[</span><span class="se">\\</span><span class="s1">-]*[1-9]+&#39;</span>  <span class="c1"># regex pattern (accounts for leading erroneous minus sign)</span>
</span><span id="Process-249"><a href="#Process-249"><span class="linenos">249</span></a>
</span><span id="Process-250"><a href="#Process-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]:</span>
</span><span id="Process-251"><a href="#Process-251"><span class="linenos">251</span></a>            <span class="n">spec</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># Zeroth order process</span>
</span><span id="Process-252"><a href="#Process-252"><span class="linenos">252</span></a>            <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Process-253"><a href="#Process-253"><span class="linenos">253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Process-254"><a href="#Process-254"><span class="linenos">254</span></a>            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Process-255"><a href="#Process-255"><span class="linenos">255</span></a>                <span class="n">term</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="Process-256"><a href="#Process-256"><span class="linenos">256</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Process-257"><a href="#Process-257"><span class="linenos">257</span></a>                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
</span><span id="Process-258"><a href="#Process-258"><span class="linenos">258</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="n">term</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">())]</span>  <span class="c1"># extract stoichiometric coef</span>
</span><span id="Process-259"><a href="#Process-259"><span class="linenos">259</span></a>                    <span class="n">spec</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># extract species name</span>
</span><span id="Process-260"><a href="#Process-260"><span class="linenos">260</span></a>                    <span class="k">if</span> <span class="n">spec</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">stoic_coef</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process-261"><a href="#Process-261"><span class="linenos">261</span></a>                        <span class="k">raise</span> <span class="n">NullSpeciesNameError</span><span class="p">()</span>
</span><span id="Process-262"><a href="#Process-262"><span class="linenos">262</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stoic_coef</span><span class="p">)</span>
</span><span id="Process-263"><a href="#Process-263"><span class="linenos">263</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># when there is no specified stoichiometric coefficient</span>
</span><span id="Process-264"><a href="#Process-264"><span class="linenos">264</span></a>                    <span class="n">spec</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">patt</span><span class="p">,</span> <span class="n">term</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># extract species name</span>
</span><span id="Process-265"><a href="#Process-265"><span class="linenos">265</span></a>                    <span class="n">stoic_coef</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Process-266"><a href="#Process-266"><span class="linenos">266</span></a>
</span><span id="Process-267"><a href="#Process-267"><span class="linenos">267</span></a>                <span class="k">if</span> <span class="n">spec</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">side_terms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process-268"><a href="#Process-268"><span class="linenos">268</span></a>                    <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoic_coef</span>
</span><span id="Process-269"><a href="#Process-269"><span class="linenos">269</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Process-270"><a href="#Process-270"><span class="linenos">270</span></a>                    <span class="n">side_terms</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">+=</span> <span class="n">stoic_coef</span>
</span><span id="Process-271"><a href="#Process-271"><span class="linenos">271</span></a>
</span><span id="Process-272"><a href="#Process-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="n">side_terms</span>
</span><span id="Process-273"><a href="#Process-273"><span class="linenos">273</span></a>
</span><span id="Process-274"><a href="#Process-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">_validate_nums</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-275"><a href="#Process-275"><span class="linenos">275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Make sure coefficients, rate constant, and volume values are not negative. &quot;&quot;&quot;</span>
</span><span id="Process-276"><a href="#Process-276"><span class="linenos">276</span></a>        <span class="c1"># Check coefficients</span>
</span><span id="Process-277"><a href="#Process-277"><span class="linenos">277</span></a>        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Process-278"><a href="#Process-278"><span class="linenos">278</span></a>            <span class="k">assert</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Coefficient cannot be negative: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Process-279"><a href="#Process-279"><span class="linenos">279</span></a>
</span><span id="Process-280"><a href="#Process-280"><span class="linenos">280</span></a>        <span class="c1"># Check rate constants</span>
</span><span id="Process-281"><a href="#Process-281"><span class="linenos">281</span></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rate constant values have to be positive: k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Process-282"><a href="#Process-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>  <span class="c1"># heterogeneous population</span>
</span><span id="Process-283"><a href="#Process-283"><span class="linenos">283</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">error_msg</span>
</span><span id="Process-284"><a href="#Process-284"><span class="linenos">284</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># when k is a float or int, the population is homogeneous</span>
</span><span id="Process-285"><a href="#Process-285"><span class="linenos">285</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">error_msg</span>
</span><span id="Process-286"><a href="#Process-286"><span class="linenos">286</span></a>
</span><span id="Process-287"><a href="#Process-287"><span class="linenos">287</span></a>        <span class="c1"># For normally-distributed k values, specification is a 2-tuple.</span>
</span><span id="Process-288"><a href="#Process-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># normal distribution of k values</span>
</span><span id="Process-289"><a href="#Process-289"><span class="linenos">289</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Please specify the mean and standard deviation &quot;</span> \
</span><span id="Process-290"><a href="#Process-290"><span class="linenos">290</span></a>                                     <span class="s2">&quot;of k in a 2-tuple: (mean, std).&quot;</span>
</span><span id="Process-291"><a href="#Process-291"><span class="linenos">291</span></a>
</span><span id="Process-292"><a href="#Process-292"><span class="linenos">292</span></a>        <span class="c1"># Check volume</span>
</span><span id="Process-293"><a href="#Process-293"><span class="linenos">293</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Process-294"><a href="#Process-294"><span class="linenos">294</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Volume cannot be negative: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Process-295"><a href="#Process-295"><span class="linenos">295</span></a>
</span><span id="Process-296"><a href="#Process-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Process-297"><a href="#Process-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Process</span><span class="p">):</span>
</span><span id="Process-298"><a href="#Process-298"><span class="linenos">298</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="Process-299"><a href="#Process-299"><span class="linenos">299</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="Process-300"><a href="#Process-300"><span class="linenos">300</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="Process-301"><a href="#Process-301"><span class="linenos">301</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="Process-302"><a href="#Process-302"><span class="linenos">302</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="Process-303"><a href="#Process-303"><span class="linenos">303</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Process-304"><a href="#Process-304"><span class="linenos">304</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="Process-305"><a href="#Process-305"><span class="linenos">305</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Process-306"><a href="#Process-306"><span class="linenos">306</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="Process-307"><a href="#Process-307"><span class="linenos">307</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Process-308"><a href="#Process-308"><span class="linenos">308</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="Process-309"><a href="#Process-309"><span class="linenos">309</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Process-310"><a href="#Process-310"><span class="linenos">310</span></a>
</span><span id="Process-311"><a href="#Process-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-312"><a href="#Process-312"><span class="linenos">312</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span><span id="Process-313"><a href="#Process-313"><span class="linenos">313</span></a>
</span><span id="Process-314"><a href="#Process-314"><span class="linenos">314</span></a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="Process-315"><a href="#Process-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="Process-316"><a href="#Process-316"><span class="linenos">316</span></a>
</span><span id="Process-317"><a href="#Process-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-318"><a href="#Process-318"><span class="linenos">318</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="Process-319"><a href="#Process-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Process Object: Process.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="Process-320"><a href="#Process-320"><span class="linenos">320</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="Process-321"><a href="#Process-321"><span class="linenos">321</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Process-322"><a href="#Process-322"><span class="linenos">322</span></a>
</span><span id="Process-323"><a href="#Process-323"><span class="linenos">323</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-324"><a href="#Process-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="Process-325"><a href="#Process-325"><span class="linenos">325</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process.&quot;</span>
</span><span id="Process-326"><a href="#Process-326"><span class="linenos">326</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Process-327"><a href="#Process-327"><span class="linenos">327</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="Process-328"><a href="#Process-328"><span class="linenos">328</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Process-329"><a href="#Process-329"><span class="linenos">329</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed k with &quot;</span> \
</span><span id="Process-330"><a href="#Process-330"><span class="linenos">330</span></a>                      <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="Process-331"><a href="#Process-331"><span class="linenos">331</span></a>
</span><span id="Process-332"><a href="#Process-332"><span class="linenos">332</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct_string</span><span class="p">()</span>
</span><span id="Process-333"><a href="#Process-333"><span class="linenos">333</span></a>
</span><span id="Process-334"><a href="#Process-334"><span class="linenos">334</span></a>        <span class="n">vol_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, volume = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2"> L&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="Process-335"><a href="#Process-335"><span class="linenos">335</span></a>        <span class="k">return</span> <span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">])</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;, k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}{</span><span class="n">vol_str</span><span class="si">}</span><span class="s1">; </span><span class="si">{</span><span class="n">het_str</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Process-336"><a href="#Process-336"><span class="linenos">336</span></a>
</span><span id="Process-337"><a href="#Process-337"><span class="linenos">337</span></a>    <span class="k">def</span> <span class="nf">_reconstruct_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Process-338"><a href="#Process-338"><span class="linenos">338</span></a>        <span class="n">lhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="Process-339"><a href="#Process-339"><span class="linenos">339</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="Process-340"><a href="#Process-340"><span class="linenos">340</span></a>        <span class="n">rhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="Process-341"><a href="#Process-341"><span class="linenos">341</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="Process-342"><a href="#Process-342"><span class="linenos">342</span></a>        <span class="k">return</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span>
</span></pre></div>


            <div class="docstring"><p>Define a unidirectional process: Reactants -> Products, where the
Reactants and Products are specified using standard chemical notation.
That is, stoichiometric coefficients (integers) and species names are
specified. For example: 2A + B -> C.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>reactants</strong> (dict):
The reactants of a given process are specified with
key-value pairs describing each species name and its
stoichiometric coefficient, respectively.</li>
<li><strong>products</strong> (dict):
The products of a given process are specified with
key-value pairs describing each species name and its
stoichiometric coefficient, respectively.</li>
<li><strong>k</strong> (float, int, list of floats, tuple of floats):
The <em>microscopic</em> rate constant(s) for the given process. The data
type of <code><a href="#Process.k">k</a></code> determines the "structure" of the population as follows:
    - A homogeneous population: if <code><a href="#Process.k">k</a></code> is a single value (float or int),
      then the population is assumed to be homogeneous with all agents
      of the reactant species having kinetics defined by this value.
    - A heterogeneous population with a distinct number of subspecies
      (each with a corresponding <code><a href="#Process.k">k</a></code> value): if <code><a href="#Process.k">k</a></code> is a list of floats,
      then the population is assumed to be heterogeneous with a number
      of subspecies equal to the length of the list.
    - A heterogeneous population with normally-distributed <code><a href="#Process.k">k</a></code> values:
      If <code><a href="#Process.k">k</a></code> is a tuple whose length is 2, then the population is
      assumed to be heterogeneous with a normally distributed <code><a href="#Process.k">k</a></code> value.
      The two entries in the tuple represent the mean and standard
      deviation (in that order) of the desired normal distribution.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>order</strong> (int):
The order of the process (or the molecularity of an elementary process).
It is the sum of the stoichiometric coefficients of the reactants.</li>
<li><strong>species</strong> (set of strings):
A set of all species in a process.</li>
<li><strong>reacts_</strong> (list of strings):
A list containing all the reactants in a process.</li>
<li><strong>prods_</strong> (list of strings):
A list containing all the products in a process.</li>
</ul>

<h6 id="methods">Methods</h6>

<p>from_string
    Class method for creating a Process object from a string.</p>
</div>


                            <div id="Process.__init__" class="classattr">
                                        <input id="Process.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Process</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Process.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Process.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Process.__init__-79"><a href="#Process.__init__-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Process.__init__-80"><a href="#Process.__init__-80"><span class="linenos"> 80</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="Process.__init__-81"><a href="#Process.__init__-81"><span class="linenos"> 81</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="Process.__init__-82"><a href="#Process.__init__-82"><span class="linenos"> 82</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="Process.__init__-83"><a href="#Process.__init__-83"><span class="linenos"> 83</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Process.__init__-84"><a href="#Process.__init__-84"><span class="linenos"> 84</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="Process.__init__-85"><a href="#Process.__init__-85"><span class="linenos"> 85</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Process.__init__-86"><a href="#Process.__init__-86"><span class="linenos"> 86</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Process.__init__-87"><a href="#Process.__init__-87"><span class="linenos"> 87</span></a>
</span><span id="Process.__init__-88"><a href="#Process.__init__-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">=</span> <span class="n">reactants</span>
</span><span id="Process.__init__-89"><a href="#Process.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">=</span> <span class="n">products</span>
</span><span id="Process.__init__-90"><a href="#Process.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
</span><span id="Process.__init__-91"><a href="#Process.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>
</span><span id="Process.__init__-92"><a href="#Process.__init__-92"><span class="linenos"> 92</span></a>
</span><span id="Process.__init__-93"><a href="#Process.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nums</span><span class="p">()</span>  <span class="c1"># make sure there are no errors in given numbers</span>
</span><span id="Process.__init__-94"><a href="#Process.__init__-94"><span class="linenos"> 94</span></a>
</span><span id="Process.__init__-95"><a href="#Process.__init__-95"><span class="linenos"> 95</span></a>        <span class="c1"># For consistency with processes instantiated using the class method `from_string()`,</span>
</span><span id="Process.__init__-96"><a href="#Process.__init__-96"><span class="linenos"> 96</span></a>        <span class="c1"># species denoted as &#39;None&#39; for a 0th order process are renamed to &#39;&#39;.</span>
</span><span id="Process.__init__-97"><a href="#Process.__init__-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process.__init__-98"><a href="#Process.__init__-98"><span class="linenos"> 98</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="Process.__init__-99"><a href="#Process.__init__-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Process.__init__-100"><a href="#Process.__init__-100"><span class="linenos">100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</span><span id="Process.__init__-101"><a href="#Process.__init__-101"><span class="linenos">101</span></a>
</span><span id="Process.__init__-102"><a href="#Process.__init__-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="Process.__init__-103"><a href="#Process.__init__-103"><span class="linenos">103</span></a>
</span><span id="Process.__init__-104"><a href="#Process.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="Process.__init__-105"><a href="#Process.__init__-105"><span class="linenos">105</span></a>
</span><span id="Process.__init__-106"><a href="#Process.__init__-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process.__init__-107"><a href="#Process.__init__-107"><span class="linenos">107</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Since a birth process does not depended on the presence of agents, &quot;</span> \
</span><span id="Process.__init__-108"><a href="#Process.__init__-108"><span class="linenos">108</span></a>                  <span class="s2">&quot;heterogeneity does not make sense in this context. Please define &quot;</span> \
</span><span id="Process.__init__-109"><a href="#Process.__init__-109"><span class="linenos">109</span></a>                  <span class="s2">&quot;the rate constant k as a number. &quot;</span>
</span><span id="Process.__init__-110"><a href="#Process.__init__-110"><span class="linenos">110</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous</span><span class="p">,</span> <span class="n">msg</span>
</span><span id="Process.__init__-111"><a href="#Process.__init__-111"><span class="linenos">111</span></a>
</span><span id="Process.__init__-112"><a href="#Process.__init__-112"><span class="linenos">112</span></a>        <span class="c1"># Convert macroscopic to microscopic rate constant</span>
</span><span id="Process.__init__-113"><a href="#Process.__init__-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Process.__init__-114"><a href="#Process.__init__-114"><span class="linenos">114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
</span><span id="Process.__init__-115"><a href="#Process.__init__-115"><span class="linenos">115</span></a>
</span><span id="Process.__init__-116"><a href="#Process.__init__-116"><span class="linenos">116</span></a>        <span class="c1"># Two ways of storing the involved species:</span>
</span><span id="Process.__init__-117"><a href="#Process.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># 1) A set of all species</span>
</span><span id="Process.__init__-118"><a href="#Process.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Process.__init__-119"><a href="#Process.__init__-119"><span class="linenos">119</span></a>        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
</span><span id="Process.__init__-120"><a href="#Process.__init__-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># remove empty species name from any 0th order processes</span>
</span><span id="Process.__init__-121"><a href="#Process.__init__-121"><span class="linenos">121</span></a>
</span><span id="Process.__init__-122"><a href="#Process.__init__-122"><span class="linenos">122</span></a>        <span class="c1"># 2) Separate lists</span>
</span><span id="Process.__init__-123"><a href="#Process.__init__-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reacts_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [reactant species]</span>
</span><span id="Process.__init__-124"><a href="#Process.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prods_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># [product species]</span>
</span><span id="Process.__init__-125"><a href="#Process.__init__-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_reacts_prods_</span><span class="p">()</span>
</span><span id="Process.__init__-126"><a href="#Process.__init__-126"><span class="linenos">126</span></a>
</span><span id="Process.__init__-127"><a href="#Process.__init__-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Because Process objects are used as keys in dictionaries used </span>
</span><span id="Process.__init__-128"><a href="#Process.__init__-128"><span class="linenos">128</span></a><span class="sd">        in an AbStochKin simulation, it&#39;s much faster to generate the object&#39;s </span>
</span><span id="Process.__init__-129"><a href="#Process.__init__-129"><span class="linenos">129</span></a><span class="sd">        string representation once, and then access it whenever it&#39;s needed </span>
</span><span id="Process.__init__-130"><a href="#Process.__init__-130"><span class="linenos">130</span></a><span class="sd">        (which could be thousands of times during a simulation). &quot;&quot;&quot;</span>
</span><span id="Process.__init__-131"><a href="#Process.__init__-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Process.__init__-132"><a href="#Process.__init__-132"><span class="linenos">132</span></a>
</span><span id="Process.__init__-133"><a href="#Process.__init__-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process.__init__-134"><a href="#Process.__init__-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Process.reactants" class="classattr">
                                <div class="attr variable">
            <span class="name">reactants</span>

        
    </div>
    <a class="headerlink" href="#Process.reactants"></a>
    
    

                            </div>
                            <div id="Process.products" class="classattr">
                                <div class="attr variable">
            <span class="name">products</span>

        
    </div>
    <a class="headerlink" href="#Process.products"></a>
    
    

                            </div>
                            <div id="Process.k" class="classattr">
                                <div class="attr variable">
            <span class="name">k</span>

        
    </div>
    <a class="headerlink" href="#Process.k"></a>
    
    

                            </div>
                            <div id="Process.volume" class="classattr">
                                <div class="attr variable">
            <span class="name">volume</span>

        
    </div>
    <a class="headerlink" href="#Process.volume"></a>
    
    

                            </div>
                            <div id="Process.order" class="classattr">
                                <div class="attr variable">
            <span class="name">order</span>

        
    </div>
    <a class="headerlink" href="#Process.order"></a>
    
    

                            </div>
                            <div id="Process.is_heterogeneous" class="classattr">
                                <div class="attr variable">
            <span class="name">is_heterogeneous</span>

        
    </div>
    <a class="headerlink" href="#Process.is_heterogeneous"></a>
    
    

                            </div>
                            <div id="Process.species" class="classattr">
                                <div class="attr variable">
            <span class="name">species</span>

        
    </div>
    <a class="headerlink" href="#Process.species"></a>
    
    

                            </div>
                            <div id="Process.reacts_" class="classattr">
                                <div class="attr variable">
            <span class="name">reacts_</span>

        
    </div>
    <a class="headerlink" href="#Process.reacts_"></a>
    
    

                            </div>
                            <div id="Process.prods_" class="classattr">
                                <div class="attr variable">
            <span class="name">prods_</span>

        
    </div>
    <a class="headerlink" href="#Process.prods_"></a>
    
    

                            </div>
                            <div id="Process.from_string" class="classattr">
                                        <input id="Process.from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Process.from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Process.from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Process.from_string-154"><a href="#Process.from_string-154"><span class="linenos">154</span></a>    <span class="nd">@classmethod</span>
</span><span id="Process.from_string-155"><a href="#Process.from_string-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="Process.from_string-156"><a href="#Process.from_string-156"><span class="linenos">156</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="Process.from_string-157"><a href="#Process.from_string-157"><span class="linenos">157</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="Process.from_string-158"><a href="#Process.from_string-158"><span class="linenos">158</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Process.from_string-159"><a href="#Process.from_string-159"><span class="linenos">159</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="Process.from_string-160"><a href="#Process.from_string-160"><span class="linenos">160</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Process.from_string-161"><a href="#Process.from_string-161"><span class="linenos">161</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
</span><span id="Process.from_string-162"><a href="#Process.from_string-162"><span class="linenos">162</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Process.from_string-163"><a href="#Process.from_string-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a process from a string.</span>
</span><span id="Process.from_string-164"><a href="#Process.from_string-164"><span class="linenos">164</span></a>
</span><span id="Process.from_string-165"><a href="#Process.from_string-165"><span class="linenos">165</span></a><span class="sd">        Parameters</span>
</span><span id="Process.from_string-166"><a href="#Process.from_string-166"><span class="linenos">166</span></a><span class="sd">        ----------</span>
</span><span id="Process.from_string-167"><a href="#Process.from_string-167"><span class="linenos">167</span></a><span class="sd">        proc_str : str</span>
</span><span id="Process.from_string-168"><a href="#Process.from_string-168"><span class="linenos">168</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="Process.from_string-169"><a href="#Process.from_string-169"><span class="linenos">169</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="Process.from_string-170"><a href="#Process.from_string-170"><span class="linenos">170</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="Process.from_string-171"><a href="#Process.from_string-171"><span class="linenos">171</span></a><span class="sd">            The rate constant for the given process. If `k` is a float or</span>
</span><span id="Process.from_string-172"><a href="#Process.from_string-172"><span class="linenos">172</span></a><span class="sd">            int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="Process.from_string-173"><a href="#Process.from_string-173"><span class="linenos">173</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="Process.from_string-174"><a href="#Process.from_string-174"><span class="linenos">174</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="Process.from_string-175"><a href="#Process.from_string-175"><span class="linenos">175</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="Process.from_string-176"><a href="#Process.from_string-176"><span class="linenos">176</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="Process.from_string-177"><a href="#Process.from_string-177"><span class="linenos">177</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="Process.from_string-178"><a href="#Process.from_string-178"><span class="linenos">178</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="Process.from_string-179"><a href="#Process.from_string-179"><span class="linenos">179</span></a><span class="sd">            are taking place.</span>
</span><span id="Process.from_string-180"><a href="#Process.from_string-180"><span class="linenos">180</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="Process.from_string-181"><a href="#Process.from_string-181"><span class="linenos">181</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="Process.from_string-182"><a href="#Process.from_string-182"><span class="linenos">182</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="Process.from_string-183"><a href="#Process.from_string-183"><span class="linenos">183</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="Process.from_string-184"><a href="#Process.from_string-184"><span class="linenos">184</span></a>
</span><span id="Process.from_string-185"><a href="#Process.from_string-185"><span class="linenos">185</span></a><span class="sd">        Notes</span>
</span><span id="Process.from_string-186"><a href="#Process.from_string-186"><span class="linenos">186</span></a><span class="sd">        -----</span>
</span><span id="Process.from_string-187"><a href="#Process.from_string-187"><span class="linenos">187</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="Process.from_string-188"><a href="#Process.from_string-188"><span class="linenos">188</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="Process.from_string-189"><a href="#Process.from_string-189"><span class="linenos">189</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="Process.from_string-190"><a href="#Process.from_string-190"><span class="linenos">190</span></a>
</span><span id="Process.from_string-191"><a href="#Process.from_string-191"><span class="linenos">191</span></a><span class="sd">        Examples</span>
</span><span id="Process.from_string-192"><a href="#Process.from_string-192"><span class="linenos">192</span></a><span class="sd">        --------</span>
</span><span id="Process.from_string-193"><a href="#Process.from_string-193"><span class="linenos">193</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;2A + B -&gt; X&quot;, 0.3)</span>
</span><span id="Process.from_string-194"><a href="#Process.from_string-194"><span class="linenos">194</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot; -&gt; Y&quot;, 0.1)  # for a 0th order (birth) process.</span>
</span><span id="Process.from_string-195"><a href="#Process.from_string-195"><span class="linenos">195</span></a><span class="sd">        &gt;&gt;&gt; Process.from_string(&quot;Protein_X -&gt; None&quot;, 0.15)  # for a 1st order degradation process.</span>
</span><span id="Process.from_string-196"><a href="#Process.from_string-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Process.from_string-197"><a href="#Process.from_string-197"><span class="linenos">197</span></a>
</span><span id="Process.from_string-198"><a href="#Process.from_string-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Process.from_string-199"><a href="#Process.from_string-199"><span class="linenos">199</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">_lsp</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Process.from_string-200"><a href="#Process.from_string-200"><span class="linenos">200</span></a>
</span><span id="Process.from_string-201"><a href="#Process.from_string-201"><span class="linenos">201</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="Process.from_string-202"><a href="#Process.from_string-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="Process.from_string-203"><a href="#Process.from_string-203"><span class="linenos">203</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Process.from_string-204"><a href="#Process.from_string-204"><span class="linenos">204</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="Process.from_string-205"><a href="#Process.from_string-205"><span class="linenos">205</span></a>
</span><span id="Process.from_string-206"><a href="#Process.from_string-206"><span class="linenos">206</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="Process.from_string-207"><a href="#Process.from_string-207"><span class="linenos">207</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="Process.from_string-208"><a href="#Process.from_string-208"><span class="linenos">208</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="Process.from_string-209"><a href="#Process.from_string-209"><span class="linenos">209</span></a>
</span><span id="Process.from_string-210"><a href="#Process.from_string-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="Process.from_string-211"><a href="#Process.from_string-211"><span class="linenos">211</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="Process.from_string-212"><a href="#Process.from_string-212"><span class="linenos">212</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="Process.from_string-213"><a href="#Process.from_string-213"><span class="linenos">213</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a process from a string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proc_str</strong> (str):
A string describing the process in standard chemical notation
(e.g., 'A + B -> C')</li>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The rate constant for the given process. If <code><a href="#Process.k">k</a></code> is a float or
int, then the process is homogeneous. If <code><a href="#Process.k">k</a></code> is a list, then
the population of the reactants constsists of distinct subspecies
or subinteractions depending on the order. If <code><a href="#Process.k">k</a></code> is a 2-tuple,
then the constant is normally-distributed with a mean and standard
deviation specified in the tuple's elements.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>sep : str, default</strong> ('->'):
Specifies the characters that distinguish the reactants from the
products. The default is '->'. The code also treats <code>--&gt;</code> as a
default, if it's present in <code>proc_str</code>.</li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>Species names should not contain spaces, dashes, and
should start with a non-numeric character.</li>
<li>Zeroth order processes should be specified by an empty space or 'None'.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#Process.from_string">Process.from_string</a></span><span class="p">(</span><span class="s2">&quot;2A + B -&gt; X&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#Process.from_string">Process.from_string</a></span><span class="p">(</span><span class="s2">&quot; -&gt; Y&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># for a 0th order (birth) process.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#Process.from_string">Process.from_string</a></span><span class="p">(</span><span class="s2">&quot;Protein_X -&gt; None&quot;</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>  <span class="c1"># for a 1st order degradation process.</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
                <section id="ReversibleProcess">
                            <input id="ReversibleProcess-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ReversibleProcess</span><wbr>(<span class="base"><a href="#Process">Process</a></span>):

                <label class="view-source-button" for="ReversibleProcess-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReversibleProcess"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReversibleProcess-345"><a href="#ReversibleProcess-345"><span class="linenos">345</span></a><span class="k">class</span> <span class="nc">ReversibleProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="ReversibleProcess-346"><a href="#ReversibleProcess-346"><span class="linenos">346</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a reversible process.</span>
</span><span id="ReversibleProcess-347"><a href="#ReversibleProcess-347"><span class="linenos">347</span></a>
</span><span id="ReversibleProcess-348"><a href="#ReversibleProcess-348"><span class="linenos">348</span></a><span class="sd">    The class-specific attributes are listed below.</span>
</span><span id="ReversibleProcess-349"><a href="#ReversibleProcess-349"><span class="linenos">349</span></a>
</span><span id="ReversibleProcess-350"><a href="#ReversibleProcess-350"><span class="linenos">350</span></a><span class="sd">    Attributes</span>
</span><span id="ReversibleProcess-351"><a href="#ReversibleProcess-351"><span class="linenos">351</span></a><span class="sd">    ----------</span>
</span><span id="ReversibleProcess-352"><a href="#ReversibleProcess-352"><span class="linenos">352</span></a><span class="sd">    k_rev : float or int or list of floats or 2-tuple of floats</span>
</span><span id="ReversibleProcess-353"><a href="#ReversibleProcess-353"><span class="linenos">353</span></a><span class="sd">        The *microscopic* rate constant for the reverse process.</span>
</span><span id="ReversibleProcess-354"><a href="#ReversibleProcess-354"><span class="linenos">354</span></a><span class="sd">    is_heterogeneous_rev : bool</span>
</span><span id="ReversibleProcess-355"><a href="#ReversibleProcess-355"><span class="linenos">355</span></a><span class="sd">        Denotes if the parameter `k_rev` exhibits heterogeneity</span>
</span><span id="ReversibleProcess-356"><a href="#ReversibleProcess-356"><span class="linenos">356</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="ReversibleProcess-357"><a href="#ReversibleProcess-357"><span class="linenos">357</span></a>
</span><span id="ReversibleProcess-358"><a href="#ReversibleProcess-358"><span class="linenos">358</span></a><span class="sd">    Notes</span>
</span><span id="ReversibleProcess-359"><a href="#ReversibleProcess-359"><span class="linenos">359</span></a><span class="sd">    -----</span>
</span><span id="ReversibleProcess-360"><a href="#ReversibleProcess-360"><span class="linenos">360</span></a><span class="sd">    A `ReversibleProcess` object gets split into two `Process` objects</span>
</span><span id="ReversibleProcess-361"><a href="#ReversibleProcess-361"><span class="linenos">361</span></a><span class="sd">    (forward and reverse process) when the algorithm runs.</span>
</span><span id="ReversibleProcess-362"><a href="#ReversibleProcess-362"><span class="linenos">362</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ReversibleProcess-363"><a href="#ReversibleProcess-363"><span class="linenos">363</span></a>
</span><span id="ReversibleProcess-364"><a href="#ReversibleProcess-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="ReversibleProcess-365"><a href="#ReversibleProcess-365"><span class="linenos">365</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="ReversibleProcess-366"><a href="#ReversibleProcess-366"><span class="linenos">366</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="ReversibleProcess-367"><a href="#ReversibleProcess-367"><span class="linenos">367</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="ReversibleProcess-368"><a href="#ReversibleProcess-368"><span class="linenos">368</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess-369"><a href="#ReversibleProcess-369"><span class="linenos">369</span></a>                 <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess-370"><a href="#ReversibleProcess-370"><span class="linenos">370</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="ReversibleProcess-371"><a href="#ReversibleProcess-371"><span class="linenos">371</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="ReversibleProcess-372"><a href="#ReversibleProcess-372"><span class="linenos">372</span></a>
</span><span id="ReversibleProcess-373"><a href="#ReversibleProcess-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">k_rev</span>  <span class="c1"># rate constant for reverse process</span>
</span><span id="ReversibleProcess-374"><a href="#ReversibleProcess-374"><span class="linenos">374</span></a>
</span><span id="ReversibleProcess-375"><a href="#ReversibleProcess-375"><span class="linenos">375</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="ReversibleProcess-376"><a href="#ReversibleProcess-376"><span class="linenos">376</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="ReversibleProcess-377"><a href="#ReversibleProcess-377"><span class="linenos">377</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="ReversibleProcess-378"><a href="#ReversibleProcess-378"><span class="linenos">378</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="ReversibleProcess-379"><a href="#ReversibleProcess-379"><span class="linenos">379</span></a>
</span><span id="ReversibleProcess-380"><a href="#ReversibleProcess-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_rev</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="ReversibleProcess-381"><a href="#ReversibleProcess-381"><span class="linenos">381</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="ReversibleProcess-382"><a href="#ReversibleProcess-382"><span class="linenos">382</span></a>
</span><span id="ReversibleProcess-383"><a href="#ReversibleProcess-383"><span class="linenos">383</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic rate constants</span>
</span><span id="ReversibleProcess-384"><a href="#ReversibleProcess-384"><span class="linenos">384</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">k_rev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span><span class="p">)</span>
</span><span id="ReversibleProcess-385"><a href="#ReversibleProcess-385"><span class="linenos">385</span></a>
</span><span id="ReversibleProcess-386"><a href="#ReversibleProcess-386"><span class="linenos">386</span></a>    <span class="nd">@classmethod</span>
</span><span id="ReversibleProcess-387"><a href="#ReversibleProcess-387"><span class="linenos">387</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="ReversibleProcess-388"><a href="#ReversibleProcess-388"><span class="linenos">388</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ReversibleProcess-389"><a href="#ReversibleProcess-389"><span class="linenos">389</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="ReversibleProcess-390"><a href="#ReversibleProcess-390"><span class="linenos">390</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess-391"><a href="#ReversibleProcess-391"><span class="linenos">391</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="ReversibleProcess-392"><a href="#ReversibleProcess-392"><span class="linenos">392</span></a>                    <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="ReversibleProcess-393"><a href="#ReversibleProcess-393"><span class="linenos">393</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="ReversibleProcess-394"><a href="#ReversibleProcess-394"><span class="linenos">394</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="ReversibleProcess-395"><a href="#ReversibleProcess-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a reversible process from a string.</span>
</span><span id="ReversibleProcess-396"><a href="#ReversibleProcess-396"><span class="linenos">396</span></a>
</span><span id="ReversibleProcess-397"><a href="#ReversibleProcess-397"><span class="linenos">397</span></a><span class="sd">        Parameters</span>
</span><span id="ReversibleProcess-398"><a href="#ReversibleProcess-398"><span class="linenos">398</span></a><span class="sd">        ----------</span>
</span><span id="ReversibleProcess-399"><a href="#ReversibleProcess-399"><span class="linenos">399</span></a><span class="sd">        proc_str : str</span>
</span><span id="ReversibleProcess-400"><a href="#ReversibleProcess-400"><span class="linenos">400</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="ReversibleProcess-401"><a href="#ReversibleProcess-401"><span class="linenos">401</span></a><span class="sd">            (e.g., &#39;A + B &lt;-&gt; C&#39;)</span>
</span><span id="ReversibleProcess-402"><a href="#ReversibleProcess-402"><span class="linenos">402</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="ReversibleProcess-403"><a href="#ReversibleProcess-403"><span class="linenos">403</span></a><span class="sd">            The *microscopic* rate constant for the forward process.</span>
</span><span id="ReversibleProcess-404"><a href="#ReversibleProcess-404"><span class="linenos">404</span></a><span class="sd">        k_rev : float or int or list of floats or 2-tuple of floats</span>
</span><span id="ReversibleProcess-405"><a href="#ReversibleProcess-405"><span class="linenos">405</span></a><span class="sd">            The *microscopic* rate constant for the reverse process.</span>
</span><span id="ReversibleProcess-406"><a href="#ReversibleProcess-406"><span class="linenos">406</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="ReversibleProcess-407"><a href="#ReversibleProcess-407"><span class="linenos">407</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="ReversibleProcess-408"><a href="#ReversibleProcess-408"><span class="linenos">408</span></a><span class="sd">            are taking place.</span>
</span><span id="ReversibleProcess-409"><a href="#ReversibleProcess-409"><span class="linenos">409</span></a><span class="sd">        sep : str, default: &#39;&lt;-&gt;&#39;</span>
</span><span id="ReversibleProcess-410"><a href="#ReversibleProcess-410"><span class="linenos">410</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="ReversibleProcess-411"><a href="#ReversibleProcess-411"><span class="linenos">411</span></a><span class="sd">            products. The default is &#39;&lt;-&gt;&#39;. The code also treats `&lt;--&gt;` as a</span>
</span><span id="ReversibleProcess-412"><a href="#ReversibleProcess-412"><span class="linenos">412</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="ReversibleProcess-413"><a href="#ReversibleProcess-413"><span class="linenos">413</span></a>
</span><span id="ReversibleProcess-414"><a href="#ReversibleProcess-414"><span class="linenos">414</span></a><span class="sd">        Notes</span>
</span><span id="ReversibleProcess-415"><a href="#ReversibleProcess-415"><span class="linenos">415</span></a><span class="sd">        -----</span>
</span><span id="ReversibleProcess-416"><a href="#ReversibleProcess-416"><span class="linenos">416</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="ReversibleProcess-417"><a href="#ReversibleProcess-417"><span class="linenos">417</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="ReversibleProcess-418"><a href="#ReversibleProcess-418"><span class="linenos">418</span></a>
</span><span id="ReversibleProcess-419"><a href="#ReversibleProcess-419"><span class="linenos">419</span></a><span class="sd">        Examples</span>
</span><span id="ReversibleProcess-420"><a href="#ReversibleProcess-420"><span class="linenos">420</span></a><span class="sd">        --------</span>
</span><span id="ReversibleProcess-421"><a href="#ReversibleProcess-421"><span class="linenos">421</span></a><span class="sd">        &gt;&gt;&gt; ReversibleProcess.from_string(&quot;2A + B &lt;-&gt; X&quot;, 0.3, k_rev=0.2)</span>
</span><span id="ReversibleProcess-422"><a href="#ReversibleProcess-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReversibleProcess-423"><a href="#ReversibleProcess-423"><span class="linenos">423</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;--&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;==&gt;&#39;</span><span class="p">]:</span>
</span><span id="ReversibleProcess-424"><a href="#ReversibleProcess-424"><span class="linenos">424</span></a>            <span class="n">sep</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="ReversibleProcess-425"><a href="#ReversibleProcess-425"><span class="linenos">425</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="ReversibleProcess-426"><a href="#ReversibleProcess-426"><span class="linenos">426</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ReversibleProcess-427"><a href="#ReversibleProcess-427"><span class="linenos">427</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;&lt;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="ReversibleProcess-428"><a href="#ReversibleProcess-428"><span class="linenos">428</span></a>
</span><span id="ReversibleProcess-429"><a href="#ReversibleProcess-429"><span class="linenos">429</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="ReversibleProcess-430"><a href="#ReversibleProcess-430"><span class="linenos">430</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="ReversibleProcess-431"><a href="#ReversibleProcess-431"><span class="linenos">431</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="ReversibleProcess-432"><a href="#ReversibleProcess-432"><span class="linenos">432</span></a>
</span><span id="ReversibleProcess-433"><a href="#ReversibleProcess-433"><span class="linenos">433</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="ReversibleProcess-434"><a href="#ReversibleProcess-434"><span class="linenos">434</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="ReversibleProcess-435"><a href="#ReversibleProcess-435"><span class="linenos">435</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="ReversibleProcess-436"><a href="#ReversibleProcess-436"><span class="linenos">436</span></a>                   <span class="n">k_rev</span><span class="o">=</span><span class="n">k_rev</span><span class="p">,</span>
</span><span id="ReversibleProcess-437"><a href="#ReversibleProcess-437"><span class="linenos">437</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="ReversibleProcess-438"><a href="#ReversibleProcess-438"><span class="linenos">438</span></a>
</span><span id="ReversibleProcess-439"><a href="#ReversibleProcess-439"><span class="linenos">439</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ReversibleProcess-440"><a href="#ReversibleProcess-440"><span class="linenos">440</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="ReversibleProcess-441"><a href="#ReversibleProcess-441"><span class="linenos">441</span></a>        <span class="n">repr_k_rev</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span><span class="p">,</span>
</span><span id="ReversibleProcess-442"><a href="#ReversibleProcess-442"><span class="linenos">442</span></a>                                    <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span>
</span><span id="ReversibleProcess-443"><a href="#ReversibleProcess-443"><span class="linenos">443</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ReversibleProcess Object: ReversibleProcess.from_string(&quot;</span> \
</span><span id="ReversibleProcess-444"><a href="#ReversibleProcess-444"><span class="linenos">444</span></a>               <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="ReversibleProcess-445"><a href="#ReversibleProcess-445"><span class="linenos">445</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="ReversibleProcess-446"><a href="#ReversibleProcess-446"><span class="linenos">446</span></a>               <span class="sa">f</span><span class="s2">&quot;k_rev=</span><span class="si">{</span><span class="n">repr_k_rev</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="ReversibleProcess-447"><a href="#ReversibleProcess-447"><span class="linenos">447</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="ReversibleProcess-448"><a href="#ReversibleProcess-448"><span class="linenos">448</span></a>
</span><span id="ReversibleProcess-449"><a href="#ReversibleProcess-449"><span class="linenos">449</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ReversibleProcess-450"><a href="#ReversibleProcess-450"><span class="linenos">450</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="ReversibleProcess-451"><a href="#ReversibleProcess-451"><span class="linenos">451</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="s2">&quot;Forward homogeneous process.&quot;</span>
</span><span id="ReversibleProcess-452"><a href="#ReversibleProcess-452"><span class="linenos">452</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="ReversibleProcess-453"><a href="#ReversibleProcess-453"><span class="linenos">453</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Forward heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="ReversibleProcess-454"><a href="#ReversibleProcess-454"><span class="linenos">454</span></a>                      <span class="sa">f</span><span class="s2">&quot;distinct subspecies.&quot;</span>
</span><span id="ReversibleProcess-455"><a href="#ReversibleProcess-455"><span class="linenos">455</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReversibleProcess-456"><a href="#ReversibleProcess-456"><span class="linenos">456</span></a>            <span class="n">het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Forward heterogeneous process with normally-distributed &quot;</span> \
</span><span id="ReversibleProcess-457"><a href="#ReversibleProcess-457"><span class="linenos">457</span></a>                      <span class="sa">f</span><span class="s2">&quot;k with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="ReversibleProcess-458"><a href="#ReversibleProcess-458"><span class="linenos">458</span></a>
</span><span id="ReversibleProcess-459"><a href="#ReversibleProcess-459"><span class="linenos">459</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="ReversibleProcess-460"><a href="#ReversibleProcess-460"><span class="linenos">460</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="s2">&quot;Reverse homogeneous process.&quot;</span>
</span><span id="ReversibleProcess-461"><a href="#ReversibleProcess-461"><span class="linenos">461</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="ReversibleProcess-462"><a href="#ReversibleProcess-462"><span class="linenos">462</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Reverse heterogeneous process with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> \
</span><span id="ReversibleProcess-463"><a href="#ReversibleProcess-463"><span class="linenos">463</span></a>                          <span class="sa">f</span><span class="s2">&quot;distinct subspecies.&quot;</span>
</span><span id="ReversibleProcess-464"><a href="#ReversibleProcess-464"><span class="linenos">464</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReversibleProcess-465"><a href="#ReversibleProcess-465"><span class="linenos">465</span></a>            <span class="n">het_rev_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Reverse heterogeneous process with normally-distributed &quot;</span> \
</span><span id="ReversibleProcess-466"><a href="#ReversibleProcess-466"><span class="linenos">466</span></a>                          <span class="sa">f</span><span class="s2">&quot;k with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="ReversibleProcess-467"><a href="#ReversibleProcess-467"><span class="linenos">467</span></a>
</span><span id="ReversibleProcess-468"><a href="#ReversibleProcess-468"><span class="linenos">468</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct_string</span><span class="p">()</span>
</span><span id="ReversibleProcess-469"><a href="#ReversibleProcess-469"><span class="linenos">469</span></a>        <span class="n">vol_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, volume = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2"> L&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="ReversibleProcess-470"><a href="#ReversibleProcess-470"><span class="linenos">470</span></a>        <span class="k">return</span> <span class="s2">&quot; &lt;-&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">])</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;, k = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="si">}</span><span class="s2">, k_rev = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="si">}{</span><span class="n">vol_str</span><span class="si">}</span><span class="s2">; &quot;</span> \
</span><span id="ReversibleProcess-471"><a href="#ReversibleProcess-471"><span class="linenos">471</span></a>                                          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">het_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">het_rev_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="ReversibleProcess-472"><a href="#ReversibleProcess-472"><span class="linenos">472</span></a>
</span><span id="ReversibleProcess-473"><a href="#ReversibleProcess-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">_reconstruct_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ReversibleProcess-474"><a href="#ReversibleProcess-474"><span class="linenos">474</span></a>        <span class="n">lhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="ReversibleProcess-475"><a href="#ReversibleProcess-475"><span class="linenos">475</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="ReversibleProcess-476"><a href="#ReversibleProcess-476"><span class="linenos">476</span></a>        <span class="n">rhs</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
</span><span id="ReversibleProcess-477"><a href="#ReversibleProcess-477"><span class="linenos">477</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</span><span id="ReversibleProcess-478"><a href="#ReversibleProcess-478"><span class="linenos">478</span></a>        <span class="k">return</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span>
</span><span id="ReversibleProcess-479"><a href="#ReversibleProcess-479"><span class="linenos">479</span></a>
</span><span id="ReversibleProcess-480"><a href="#ReversibleProcess-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="ReversibleProcess-481"><a href="#ReversibleProcess-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ReversibleProcess</span><span class="p">):</span>
</span><span id="ReversibleProcess-482"><a href="#ReversibleProcess-482"><span class="linenos">482</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-483"><a href="#ReversibleProcess-483"><span class="linenos">483</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-484"><a href="#ReversibleProcess-484"><span class="linenos">484</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k_rev</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-485"><a href="#ReversibleProcess-485"><span class="linenos">485</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order_rev</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-486"><a href="#ReversibleProcess-486"><span class="linenos">486</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-487"><a href="#ReversibleProcess-487"><span class="linenos">487</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-488"><a href="#ReversibleProcess-488"><span class="linenos">488</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="ReversibleProcess-489"><a href="#ReversibleProcess-489"><span class="linenos">489</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="ReversibleProcess-490"><a href="#ReversibleProcess-490"><span class="linenos">490</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="ReversibleProcess-491"><a href="#ReversibleProcess-491"><span class="linenos">491</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ReversibleProcess-492"><a href="#ReversibleProcess-492"><span class="linenos">492</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="ReversibleProcess-493"><a href="#ReversibleProcess-493"><span class="linenos">493</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReversibleProcess-494"><a href="#ReversibleProcess-494"><span class="linenos">494</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="ReversibleProcess-495"><a href="#ReversibleProcess-495"><span class="linenos">495</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="ReversibleProcess-496"><a href="#ReversibleProcess-496"><span class="linenos">496</span></a>
</span><span id="ReversibleProcess-497"><a href="#ReversibleProcess-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ReversibleProcess-498"><a href="#ReversibleProcess-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Define a reversible process.</p>

<p>The class-specific attributes are listed below.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>k_rev</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the reverse process.</li>
<li><strong>is_heterogeneous_rev</strong> (bool):
Denotes if the parameter <code><a href="#ReversibleProcess.k_rev">k_rev</a></code> exhibits heterogeneity
(distinct subspecies/interactions or normally-distributed).</li>
</ul>

<h6 id="notes">Notes</h6>

<p>A <code><a href="#ReversibleProcess">ReversibleProcess</a></code> object gets split into two <code><a href="#Process">Process</a></code> objects
(forward and reverse process) when the algorithm runs.</p>
</div>


                            <div id="ReversibleProcess.__init__" class="classattr">
                                        <input id="ReversibleProcess.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ReversibleProcess</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="ReversibleProcess.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReversibleProcess.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReversibleProcess.__init__-364"><a href="#ReversibleProcess.__init__-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-365"><a href="#ReversibleProcess.__init__-365"><span class="linenos">365</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-366"><a href="#ReversibleProcess.__init__-366"><span class="linenos">366</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="ReversibleProcess.__init__-367"><a href="#ReversibleProcess.__init__-367"><span class="linenos">367</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="ReversibleProcess.__init__-368"><a href="#ReversibleProcess.__init__-368"><span class="linenos">368</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess.__init__-369"><a href="#ReversibleProcess.__init__-369"><span class="linenos">369</span></a>                 <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess.__init__-370"><a href="#ReversibleProcess.__init__-370"><span class="linenos">370</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-371"><a href="#ReversibleProcess.__init__-371"><span class="linenos">371</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="ReversibleProcess.__init__-372"><a href="#ReversibleProcess.__init__-372"><span class="linenos">372</span></a>
</span><span id="ReversibleProcess.__init__-373"><a href="#ReversibleProcess.__init__-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">k_rev</span>  <span class="c1"># rate constant for reverse process</span>
</span><span id="ReversibleProcess.__init__-374"><a href="#ReversibleProcess.__init__-374"><span class="linenos">374</span></a>
</span><span id="ReversibleProcess.__init__-375"><a href="#ReversibleProcess.__init__-375"><span class="linenos">375</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-376"><a href="#ReversibleProcess.__init__-376"><span class="linenos">376</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-377"><a href="#ReversibleProcess.__init__-377"><span class="linenos">377</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="ReversibleProcess.__init__-378"><a href="#ReversibleProcess.__init__-378"><span class="linenos">378</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="ReversibleProcess.__init__-379"><a href="#ReversibleProcess.__init__-379"><span class="linenos">379</span></a>
</span><span id="ReversibleProcess.__init__-380"><a href="#ReversibleProcess.__init__-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_rev</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="ReversibleProcess.__init__-381"><a href="#ReversibleProcess.__init__-381"><span class="linenos">381</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="ReversibleProcess.__init__-382"><a href="#ReversibleProcess.__init__-382"><span class="linenos">382</span></a>
</span><span id="ReversibleProcess.__init__-383"><a href="#ReversibleProcess.__init__-383"><span class="linenos">383</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic rate constants</span>
</span><span id="ReversibleProcess.__init__-384"><a href="#ReversibleProcess.__init__-384"><span class="linenos">384</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k_rev</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">k_rev</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_rev</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ReversibleProcess.k_rev" class="classattr">
                                <div class="attr variable">
            <span class="name">k_rev</span>

        
    </div>
    <a class="headerlink" href="#ReversibleProcess.k_rev"></a>
    
    

                            </div>
                            <div id="ReversibleProcess.is_heterogeneous_rev" class="classattr">
                                <div class="attr variable">
            <span class="name">is_heterogeneous_rev</span>

        
    </div>
    <a class="headerlink" href="#ReversibleProcess.is_heterogeneous_rev"></a>
    
    

                            </div>
                            <div id="ReversibleProcess.order_rev" class="classattr">
                                <div class="attr variable">
            <span class="name">order_rev</span>

        
    </div>
    <a class="headerlink" href="#ReversibleProcess.order_rev"></a>
    
    

                            </div>
                            <div id="ReversibleProcess.from_string" class="classattr">
                                        <input id="ReversibleProcess.from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;-&gt;&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="ReversibleProcess.from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReversibleProcess.from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReversibleProcess.from_string-386"><a href="#ReversibleProcess.from_string-386"><span class="linenos">386</span></a>    <span class="nd">@classmethod</span>
</span><span id="ReversibleProcess.from_string-387"><a href="#ReversibleProcess.from_string-387"><span class="linenos">387</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-388"><a href="#ReversibleProcess.from_string-388"><span class="linenos">388</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-389"><a href="#ReversibleProcess.from_string-389"><span class="linenos">389</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-390"><a href="#ReversibleProcess.from_string-390"><span class="linenos">390</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="ReversibleProcess.from_string-391"><a href="#ReversibleProcess.from_string-391"><span class="linenos">391</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-392"><a href="#ReversibleProcess.from_string-392"><span class="linenos">392</span></a>                    <span class="n">k_rev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-393"><a href="#ReversibleProcess.from_string-393"><span class="linenos">393</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-394"><a href="#ReversibleProcess.from_string-394"><span class="linenos">394</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="ReversibleProcess.from_string-395"><a href="#ReversibleProcess.from_string-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a reversible process from a string.</span>
</span><span id="ReversibleProcess.from_string-396"><a href="#ReversibleProcess.from_string-396"><span class="linenos">396</span></a>
</span><span id="ReversibleProcess.from_string-397"><a href="#ReversibleProcess.from_string-397"><span class="linenos">397</span></a><span class="sd">        Parameters</span>
</span><span id="ReversibleProcess.from_string-398"><a href="#ReversibleProcess.from_string-398"><span class="linenos">398</span></a><span class="sd">        ----------</span>
</span><span id="ReversibleProcess.from_string-399"><a href="#ReversibleProcess.from_string-399"><span class="linenos">399</span></a><span class="sd">        proc_str : str</span>
</span><span id="ReversibleProcess.from_string-400"><a href="#ReversibleProcess.from_string-400"><span class="linenos">400</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="ReversibleProcess.from_string-401"><a href="#ReversibleProcess.from_string-401"><span class="linenos">401</span></a><span class="sd">            (e.g., &#39;A + B &lt;-&gt; C&#39;)</span>
</span><span id="ReversibleProcess.from_string-402"><a href="#ReversibleProcess.from_string-402"><span class="linenos">402</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="ReversibleProcess.from_string-403"><a href="#ReversibleProcess.from_string-403"><span class="linenos">403</span></a><span class="sd">            The *microscopic* rate constant for the forward process.</span>
</span><span id="ReversibleProcess.from_string-404"><a href="#ReversibleProcess.from_string-404"><span class="linenos">404</span></a><span class="sd">        k_rev : float or int or list of floats or 2-tuple of floats</span>
</span><span id="ReversibleProcess.from_string-405"><a href="#ReversibleProcess.from_string-405"><span class="linenos">405</span></a><span class="sd">            The *microscopic* rate constant for the reverse process.</span>
</span><span id="ReversibleProcess.from_string-406"><a href="#ReversibleProcess.from_string-406"><span class="linenos">406</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="ReversibleProcess.from_string-407"><a href="#ReversibleProcess.from_string-407"><span class="linenos">407</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="ReversibleProcess.from_string-408"><a href="#ReversibleProcess.from_string-408"><span class="linenos">408</span></a><span class="sd">            are taking place.</span>
</span><span id="ReversibleProcess.from_string-409"><a href="#ReversibleProcess.from_string-409"><span class="linenos">409</span></a><span class="sd">        sep : str, default: &#39;&lt;-&gt;&#39;</span>
</span><span id="ReversibleProcess.from_string-410"><a href="#ReversibleProcess.from_string-410"><span class="linenos">410</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="ReversibleProcess.from_string-411"><a href="#ReversibleProcess.from_string-411"><span class="linenos">411</span></a><span class="sd">            products. The default is &#39;&lt;-&gt;&#39;. The code also treats `&lt;--&gt;` as a</span>
</span><span id="ReversibleProcess.from_string-412"><a href="#ReversibleProcess.from_string-412"><span class="linenos">412</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="ReversibleProcess.from_string-413"><a href="#ReversibleProcess.from_string-413"><span class="linenos">413</span></a>
</span><span id="ReversibleProcess.from_string-414"><a href="#ReversibleProcess.from_string-414"><span class="linenos">414</span></a><span class="sd">        Notes</span>
</span><span id="ReversibleProcess.from_string-415"><a href="#ReversibleProcess.from_string-415"><span class="linenos">415</span></a><span class="sd">        -----</span>
</span><span id="ReversibleProcess.from_string-416"><a href="#ReversibleProcess.from_string-416"><span class="linenos">416</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="ReversibleProcess.from_string-417"><a href="#ReversibleProcess.from_string-417"><span class="linenos">417</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="ReversibleProcess.from_string-418"><a href="#ReversibleProcess.from_string-418"><span class="linenos">418</span></a>
</span><span id="ReversibleProcess.from_string-419"><a href="#ReversibleProcess.from_string-419"><span class="linenos">419</span></a><span class="sd">        Examples</span>
</span><span id="ReversibleProcess.from_string-420"><a href="#ReversibleProcess.from_string-420"><span class="linenos">420</span></a><span class="sd">        --------</span>
</span><span id="ReversibleProcess.from_string-421"><a href="#ReversibleProcess.from_string-421"><span class="linenos">421</span></a><span class="sd">        &gt;&gt;&gt; ReversibleProcess.from_string(&quot;2A + B &lt;-&gt; X&quot;, 0.3, k_rev=0.2)</span>
</span><span id="ReversibleProcess.from_string-422"><a href="#ReversibleProcess.from_string-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReversibleProcess.from_string-423"><a href="#ReversibleProcess.from_string-423"><span class="linenos">423</span></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;--&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;==&gt;&#39;</span><span class="p">]:</span>
</span><span id="ReversibleProcess.from_string-424"><a href="#ReversibleProcess.from_string-424"><span class="linenos">424</span></a>            <span class="n">sep</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="ReversibleProcess.from_string-425"><a href="#ReversibleProcess.from_string-425"><span class="linenos">425</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="ReversibleProcess.from_string-426"><a href="#ReversibleProcess.from_string-426"><span class="linenos">426</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ReversibleProcess.from_string-427"><a href="#ReversibleProcess.from_string-427"><span class="linenos">427</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;&lt;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="ReversibleProcess.from_string-428"><a href="#ReversibleProcess.from_string-428"><span class="linenos">428</span></a>
</span><span id="ReversibleProcess.from_string-429"><a href="#ReversibleProcess.from_string-429"><span class="linenos">429</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="ReversibleProcess.from_string-430"><a href="#ReversibleProcess.from_string-430"><span class="linenos">430</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="ReversibleProcess.from_string-431"><a href="#ReversibleProcess.from_string-431"><span class="linenos">431</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="ReversibleProcess.from_string-432"><a href="#ReversibleProcess.from_string-432"><span class="linenos">432</span></a>
</span><span id="ReversibleProcess.from_string-433"><a href="#ReversibleProcess.from_string-433"><span class="linenos">433</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="ReversibleProcess.from_string-434"><a href="#ReversibleProcess.from_string-434"><span class="linenos">434</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="ReversibleProcess.from_string-435"><a href="#ReversibleProcess.from_string-435"><span class="linenos">435</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-436"><a href="#ReversibleProcess.from_string-436"><span class="linenos">436</span></a>                   <span class="n">k_rev</span><span class="o">=</span><span class="n">k_rev</span><span class="p">,</span>
</span><span id="ReversibleProcess.from_string-437"><a href="#ReversibleProcess.from_string-437"><span class="linenos">437</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a reversible process from a string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proc_str</strong> (str):
A string describing the process in standard chemical notation
(e.g., 'A + B &lt;-> C')</li>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the forward process.</li>
<li><strong>k_rev</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the reverse process.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>sep : str, default</strong> ('&lt;->'):
Specifies the characters that distinguish the reactants from the
products. The default is '&lt;->'. The code also treats <code>&lt;--&gt;</code> as a
default, if it's present in <code>proc_str</code>.</li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>Species names should not contain spaces, dashes, and
should start with a non-numeric character.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#ReversibleProcess.from_string">ReversibleProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;2A + B &lt;-&gt; X&quot;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">k_rev</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Process">Process</a></dt>
                                <dd id="ReversibleProcess.reactants" class="variable"><a href="#Process.reactants">reactants</a></dd>
                <dd id="ReversibleProcess.products" class="variable"><a href="#Process.products">products</a></dd>
                <dd id="ReversibleProcess.k" class="variable"><a href="#Process.k">k</a></dd>
                <dd id="ReversibleProcess.volume" class="variable"><a href="#Process.volume">volume</a></dd>
                <dd id="ReversibleProcess.order" class="variable"><a href="#Process.order">order</a></dd>
                <dd id="ReversibleProcess.is_heterogeneous" class="variable"><a href="#Process.is_heterogeneous">is_heterogeneous</a></dd>
                <dd id="ReversibleProcess.species" class="variable"><a href="#Process.species">species</a></dd>
                <dd id="ReversibleProcess.reacts_" class="variable"><a href="#Process.reacts_">reacts_</a></dd>
                <dd id="ReversibleProcess.prods_" class="variable"><a href="#Process.prods_">prods_</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MichaelisMentenProcess">
                            <input id="MichaelisMentenProcess-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MichaelisMentenProcess</span><wbr>(<span class="base"><a href="#Process">Process</a></span>):

                <label class="view-source-button" for="MichaelisMentenProcess-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MichaelisMentenProcess"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MichaelisMentenProcess-501"><a href="#MichaelisMentenProcess-501"><span class="linenos">501</span></a><span class="k">class</span> <span class="nc">MichaelisMentenProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-502"><a href="#MichaelisMentenProcess-502"><span class="linenos">502</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that obeys Michaelis-Menten kinetics.</span>
</span><span id="MichaelisMentenProcess-503"><a href="#MichaelisMentenProcess-503"><span class="linenos">503</span></a>
</span><span id="MichaelisMentenProcess-504"><a href="#MichaelisMentenProcess-504"><span class="linenos">504</span></a><span class="sd">    The class-specific attributes are listed below.</span>
</span><span id="MichaelisMentenProcess-505"><a href="#MichaelisMentenProcess-505"><span class="linenos">505</span></a>
</span><span id="MichaelisMentenProcess-506"><a href="#MichaelisMentenProcess-506"><span class="linenos">506</span></a><span class="sd">    Attributes</span>
</span><span id="MichaelisMentenProcess-507"><a href="#MichaelisMentenProcess-507"><span class="linenos">507</span></a><span class="sd">    ----------</span>
</span><span id="MichaelisMentenProcess-508"><a href="#MichaelisMentenProcess-508"><span class="linenos">508</span></a><span class="sd">    catalyst : str</span>
</span><span id="MichaelisMentenProcess-509"><a href="#MichaelisMentenProcess-509"><span class="linenos">509</span></a><span class="sd">        Name of the species acting as a catalyst for this process.</span>
</span><span id="MichaelisMentenProcess-510"><a href="#MichaelisMentenProcess-510"><span class="linenos">510</span></a><span class="sd">    Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="MichaelisMentenProcess-511"><a href="#MichaelisMentenProcess-511"><span class="linenos">511</span></a><span class="sd">        *Microscopic* Michaelis constant. Corresponds to the number</span>
</span><span id="MichaelisMentenProcess-512"><a href="#MichaelisMentenProcess-512"><span class="linenos">512</span></a><span class="sd">        of `catalyst` agents that would produce half-maximal activity.</span>
</span><span id="MichaelisMentenProcess-513"><a href="#MichaelisMentenProcess-513"><span class="linenos">513</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="MichaelisMentenProcess-514"><a href="#MichaelisMentenProcess-514"><span class="linenos">514</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="MichaelisMentenProcess-515"><a href="#MichaelisMentenProcess-515"><span class="linenos">515</span></a><span class="sd">    is_heterogeneous_Km : bool</span>
</span><span id="MichaelisMentenProcess-516"><a href="#MichaelisMentenProcess-516"><span class="linenos">516</span></a><span class="sd">        Denotes if the parameter `Km` exhibits heterogeneity</span>
</span><span id="MichaelisMentenProcess-517"><a href="#MichaelisMentenProcess-517"><span class="linenos">517</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="MichaelisMentenProcess-518"><a href="#MichaelisMentenProcess-518"><span class="linenos">518</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MichaelisMentenProcess-519"><a href="#MichaelisMentenProcess-519"><span class="linenos">519</span></a>
</span><span id="MichaelisMentenProcess-520"><a href="#MichaelisMentenProcess-520"><span class="linenos">520</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-521"><a href="#MichaelisMentenProcess-521"><span class="linenos">521</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-522"><a href="#MichaelisMentenProcess-522"><span class="linenos">522</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess-523"><a href="#MichaelisMentenProcess-523"><span class="linenos">523</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess-524"><a href="#MichaelisMentenProcess-524"><span class="linenos">524</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess-525"><a href="#MichaelisMentenProcess-525"><span class="linenos">525</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-526"><a href="#MichaelisMentenProcess-526"><span class="linenos">526</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-527"><a href="#MichaelisMentenProcess-527"><span class="linenos">527</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess-528"><a href="#MichaelisMentenProcess-528"><span class="linenos">528</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-529"><a href="#MichaelisMentenProcess-529"><span class="linenos">529</span></a>
</span><span id="MichaelisMentenProcess-530"><a href="#MichaelisMentenProcess-530"><span class="linenos">530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="MichaelisMentenProcess-531"><a href="#MichaelisMentenProcess-531"><span class="linenos">531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="MichaelisMentenProcess-532"><a href="#MichaelisMentenProcess-532"><span class="linenos">532</span></a>
</span><span id="MichaelisMentenProcess-533"><a href="#MichaelisMentenProcess-533"><span class="linenos">533</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-534"><a href="#MichaelisMentenProcess-534"><span class="linenos">534</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-535"><a href="#MichaelisMentenProcess-535"><span class="linenos">535</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-536"><a href="#MichaelisMentenProcess-536"><span class="linenos">536</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-537"><a href="#MichaelisMentenProcess-537"><span class="linenos">537</span></a>
</span><span id="MichaelisMentenProcess-538"><a href="#MichaelisMentenProcess-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="MichaelisMentenProcess-539"><a href="#MichaelisMentenProcess-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-540"><a href="#MichaelisMentenProcess-540"><span class="linenos">540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MichaelisMentenProcess-541"><a href="#MichaelisMentenProcess-541"><span class="linenos">541</span></a>
</span><span id="MichaelisMentenProcess-542"><a href="#MichaelisMentenProcess-542"><span class="linenos">542</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="MichaelisMentenProcess-543"><a href="#MichaelisMentenProcess-543"><span class="linenos">543</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="MichaelisMentenProcess-544"><a href="#MichaelisMentenProcess-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess-545"><a href="#MichaelisMentenProcess-545"><span class="linenos">545</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="MichaelisMentenProcess-546"><a href="#MichaelisMentenProcess-546"><span class="linenos">546</span></a>
</span><span id="MichaelisMentenProcess-547"><a href="#MichaelisMentenProcess-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="MichaelisMentenProcess-548"><a href="#MichaelisMentenProcess-548"><span class="linenos">548</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-549"><a href="#MichaelisMentenProcess-549"><span class="linenos">549</span></a>
</span><span id="MichaelisMentenProcess-550"><a href="#MichaelisMentenProcess-550"><span class="linenos">550</span></a>    <span class="nd">@classmethod</span>
</span><span id="MichaelisMentenProcess-551"><a href="#MichaelisMentenProcess-551"><span class="linenos">551</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-552"><a href="#MichaelisMentenProcess-552"><span class="linenos">552</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-553"><a href="#MichaelisMentenProcess-553"><span class="linenos">553</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-554"><a href="#MichaelisMentenProcess-554"><span class="linenos">554</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess-555"><a href="#MichaelisMentenProcess-555"><span class="linenos">555</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-556"><a href="#MichaelisMentenProcess-556"><span class="linenos">556</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-557"><a href="#MichaelisMentenProcess-557"><span class="linenos">557</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="MichaelisMentenProcess-558"><a href="#MichaelisMentenProcess-558"><span class="linenos">558</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-559"><a href="#MichaelisMentenProcess-559"><span class="linenos">559</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-560"><a href="#MichaelisMentenProcess-560"><span class="linenos">560</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess-561"><a href="#MichaelisMentenProcess-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a Michaelis-Menten process from a string.</span>
</span><span id="MichaelisMentenProcess-562"><a href="#MichaelisMentenProcess-562"><span class="linenos">562</span></a>
</span><span id="MichaelisMentenProcess-563"><a href="#MichaelisMentenProcess-563"><span class="linenos">563</span></a><span class="sd">        Parameters</span>
</span><span id="MichaelisMentenProcess-564"><a href="#MichaelisMentenProcess-564"><span class="linenos">564</span></a><span class="sd">        ----------</span>
</span><span id="MichaelisMentenProcess-565"><a href="#MichaelisMentenProcess-565"><span class="linenos">565</span></a><span class="sd">        proc_str : str</span>
</span><span id="MichaelisMentenProcess-566"><a href="#MichaelisMentenProcess-566"><span class="linenos">566</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="MichaelisMentenProcess-567"><a href="#MichaelisMentenProcess-567"><span class="linenos">567</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="MichaelisMentenProcess-568"><a href="#MichaelisMentenProcess-568"><span class="linenos">568</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="MichaelisMentenProcess-569"><a href="#MichaelisMentenProcess-569"><span class="linenos">569</span></a><span class="sd">            The *microscopic* rate constant for the given process. If `k` is a</span>
</span><span id="MichaelisMentenProcess-570"><a href="#MichaelisMentenProcess-570"><span class="linenos">570</span></a><span class="sd">            float or int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="MichaelisMentenProcess-571"><a href="#MichaelisMentenProcess-571"><span class="linenos">571</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="MichaelisMentenProcess-572"><a href="#MichaelisMentenProcess-572"><span class="linenos">572</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="MichaelisMentenProcess-573"><a href="#MichaelisMentenProcess-573"><span class="linenos">573</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="MichaelisMentenProcess-574"><a href="#MichaelisMentenProcess-574"><span class="linenos">574</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="MichaelisMentenProcess-575"><a href="#MichaelisMentenProcess-575"><span class="linenos">575</span></a><span class="sd">        catalyst : str</span>
</span><span id="MichaelisMentenProcess-576"><a href="#MichaelisMentenProcess-576"><span class="linenos">576</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="MichaelisMentenProcess-577"><a href="#MichaelisMentenProcess-577"><span class="linenos">577</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="MichaelisMentenProcess-578"><a href="#MichaelisMentenProcess-578"><span class="linenos">578</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="MichaelisMentenProcess-579"><a href="#MichaelisMentenProcess-579"><span class="linenos">579</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="MichaelisMentenProcess-580"><a href="#MichaelisMentenProcess-580"><span class="linenos">580</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="MichaelisMentenProcess-581"><a href="#MichaelisMentenProcess-581"><span class="linenos">581</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="MichaelisMentenProcess-582"><a href="#MichaelisMentenProcess-582"><span class="linenos">582</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="MichaelisMentenProcess-583"><a href="#MichaelisMentenProcess-583"><span class="linenos">583</span></a><span class="sd">            are taking place.</span>
</span><span id="MichaelisMentenProcess-584"><a href="#MichaelisMentenProcess-584"><span class="linenos">584</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="MichaelisMentenProcess-585"><a href="#MichaelisMentenProcess-585"><span class="linenos">585</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="MichaelisMentenProcess-586"><a href="#MichaelisMentenProcess-586"><span class="linenos">586</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="MichaelisMentenProcess-587"><a href="#MichaelisMentenProcess-587"><span class="linenos">587</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="MichaelisMentenProcess-588"><a href="#MichaelisMentenProcess-588"><span class="linenos">588</span></a>
</span><span id="MichaelisMentenProcess-589"><a href="#MichaelisMentenProcess-589"><span class="linenos">589</span></a><span class="sd">        Notes</span>
</span><span id="MichaelisMentenProcess-590"><a href="#MichaelisMentenProcess-590"><span class="linenos">590</span></a><span class="sd">        -----</span>
</span><span id="MichaelisMentenProcess-591"><a href="#MichaelisMentenProcess-591"><span class="linenos">591</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="MichaelisMentenProcess-592"><a href="#MichaelisMentenProcess-592"><span class="linenos">592</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="MichaelisMentenProcess-593"><a href="#MichaelisMentenProcess-593"><span class="linenos">593</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="MichaelisMentenProcess-594"><a href="#MichaelisMentenProcess-594"><span class="linenos">594</span></a>
</span><span id="MichaelisMentenProcess-595"><a href="#MichaelisMentenProcess-595"><span class="linenos">595</span></a><span class="sd">        Examples</span>
</span><span id="MichaelisMentenProcess-596"><a href="#MichaelisMentenProcess-596"><span class="linenos">596</span></a><span class="sd">        --------</span>
</span><span id="MichaelisMentenProcess-597"><a href="#MichaelisMentenProcess-597"><span class="linenos">597</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;E&#39;, Km=10)</span>
</span><span id="MichaelisMentenProcess-598"><a href="#MichaelisMentenProcess-598"><span class="linenos">598</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;alpha&#39;, Km=(10, 1))</span>
</span><span id="MichaelisMentenProcess-599"><a href="#MichaelisMentenProcess-599"><span class="linenos">599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MichaelisMentenProcess-600"><a href="#MichaelisMentenProcess-600"><span class="linenos">600</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="MichaelisMentenProcess-601"><a href="#MichaelisMentenProcess-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess-602"><a href="#MichaelisMentenProcess-602"><span class="linenos">602</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MichaelisMentenProcess-603"><a href="#MichaelisMentenProcess-603"><span class="linenos">603</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-604"><a href="#MichaelisMentenProcess-604"><span class="linenos">604</span></a>
</span><span id="MichaelisMentenProcess-605"><a href="#MichaelisMentenProcess-605"><span class="linenos">605</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="MichaelisMentenProcess-606"><a href="#MichaelisMentenProcess-606"><span class="linenos">606</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="MichaelisMentenProcess-607"><a href="#MichaelisMentenProcess-607"><span class="linenos">607</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="MichaelisMentenProcess-608"><a href="#MichaelisMentenProcess-608"><span class="linenos">608</span></a>
</span><span id="MichaelisMentenProcess-609"><a href="#MichaelisMentenProcess-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="MichaelisMentenProcess-610"><a href="#MichaelisMentenProcess-610"><span class="linenos">610</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="MichaelisMentenProcess-611"><a href="#MichaelisMentenProcess-611"><span class="linenos">611</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-612"><a href="#MichaelisMentenProcess-612"><span class="linenos">612</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-613"><a href="#MichaelisMentenProcess-613"><span class="linenos">613</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess-614"><a href="#MichaelisMentenProcess-614"><span class="linenos">614</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-615"><a href="#MichaelisMentenProcess-615"><span class="linenos">615</span></a>
</span><span id="MichaelisMentenProcess-616"><a href="#MichaelisMentenProcess-616"><span class="linenos">616</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-617"><a href="#MichaelisMentenProcess-617"><span class="linenos">617</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="MichaelisMentenProcess-618"><a href="#MichaelisMentenProcess-618"><span class="linenos">618</span></a>        <span class="n">repr_Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Km</span>
</span><span id="MichaelisMentenProcess-619"><a href="#MichaelisMentenProcess-619"><span class="linenos">619</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MichaelisMentenProcess Object: &quot;</span> \
</span><span id="MichaelisMentenProcess-620"><a href="#MichaelisMentenProcess-620"><span class="linenos">620</span></a>               <span class="sa">f</span><span class="s2">&quot;MichaelisMentenProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="MichaelisMentenProcess-621"><a href="#MichaelisMentenProcess-621"><span class="linenos">621</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="MichaelisMentenProcess-622"><a href="#MichaelisMentenProcess-622"><span class="linenos">622</span></a>               <span class="sa">f</span><span class="s2">&quot;catalyst=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="MichaelisMentenProcess-623"><a href="#MichaelisMentenProcess-623"><span class="linenos">623</span></a>               <span class="sa">f</span><span class="s2">&quot;Km=</span><span class="si">{</span><span class="n">repr_Km</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="MichaelisMentenProcess-624"><a href="#MichaelisMentenProcess-624"><span class="linenos">624</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="MichaelisMentenProcess-625"><a href="#MichaelisMentenProcess-625"><span class="linenos">625</span></a>
</span><span id="MichaelisMentenProcess-626"><a href="#MichaelisMentenProcess-626"><span class="linenos">626</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-627"><a href="#MichaelisMentenProcess-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="MichaelisMentenProcess-628"><a href="#MichaelisMentenProcess-628"><span class="linenos">628</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to Km.&quot;</span>
</span><span id="MichaelisMentenProcess-629"><a href="#MichaelisMentenProcess-629"><span class="linenos">629</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-630"><a href="#MichaelisMentenProcess-630"><span class="linenos">630</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to Km &quot;</span> \
</span><span id="MichaelisMentenProcess-631"><a href="#MichaelisMentenProcess-631"><span class="linenos">631</span></a>                         <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="MichaelisMentenProcess-632"><a href="#MichaelisMentenProcess-632"><span class="linenos">632</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess-633"><a href="#MichaelisMentenProcess-633"><span class="linenos">633</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed Km with &quot;</span> \
</span><span id="MichaelisMentenProcess-634"><a href="#MichaelisMentenProcess-634"><span class="linenos">634</span></a>                         <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="MichaelisMentenProcess-635"><a href="#MichaelisMentenProcess-635"><span class="linenos">635</span></a>
</span><span id="MichaelisMentenProcess-636"><a href="#MichaelisMentenProcess-636"><span class="linenos">636</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Catalyst: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="MichaelisMentenProcess-637"><a href="#MichaelisMentenProcess-637"><span class="linenos">637</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Km_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MichaelisMentenProcess-638"><a href="#MichaelisMentenProcess-638"><span class="linenos">638</span></a>
</span><span id="MichaelisMentenProcess-639"><a href="#MichaelisMentenProcess-639"><span class="linenos">639</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-640"><a href="#MichaelisMentenProcess-640"><span class="linenos">640</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MichaelisMentenProcess</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-641"><a href="#MichaelisMentenProcess-641"><span class="linenos">641</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-642"><a href="#MichaelisMentenProcess-642"><span class="linenos">642</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-643"><a href="#MichaelisMentenProcess-643"><span class="linenos">643</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-644"><a href="#MichaelisMentenProcess-644"><span class="linenos">644</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-645"><a href="#MichaelisMentenProcess-645"><span class="linenos">645</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">catalyst</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-646"><a href="#MichaelisMentenProcess-646"><span class="linenos">646</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Km</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-647"><a href="#MichaelisMentenProcess-647"><span class="linenos">647</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="MichaelisMentenProcess-648"><a href="#MichaelisMentenProcess-648"><span class="linenos">648</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-649"><a href="#MichaelisMentenProcess-649"><span class="linenos">649</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="MichaelisMentenProcess-650"><a href="#MichaelisMentenProcess-650"><span class="linenos">650</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-651"><a href="#MichaelisMentenProcess-651"><span class="linenos">651</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="MichaelisMentenProcess-652"><a href="#MichaelisMentenProcess-652"><span class="linenos">652</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess-653"><a href="#MichaelisMentenProcess-653"><span class="linenos">653</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess-654"><a href="#MichaelisMentenProcess-654"><span class="linenos">654</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="MichaelisMentenProcess-655"><a href="#MichaelisMentenProcess-655"><span class="linenos">655</span></a>
</span><span id="MichaelisMentenProcess-656"><a href="#MichaelisMentenProcess-656"><span class="linenos">656</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess-657"><a href="#MichaelisMentenProcess-657"><span class="linenos">657</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Define a process that obeys Michaelis-Menten kinetics.</p>

<p>The class-specific attributes are listed below.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>catalyst</strong> (str):
Name of the species acting as a catalyst for this process.</li>
<li><strong>Km</strong> (float or int or list of floats or 2-tuple of floats):
<em>Microscopic</em> Michaelis constant. Corresponds to the number
of <code><a href="#MichaelisMentenProcess.catalyst">catalyst</a></code> agents that would produce half-maximal activity.
Heterogeneity in this parameter is determined by the type of <code><a href="#MichaelisMentenProcess.Km">Km</a></code>,
using the same rules as for parameter <code><a href="#MichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>is_heterogeneous_Km</strong> (bool):
Denotes if the parameter <code><a href="#MichaelisMentenProcess.Km">Km</a></code> exhibits heterogeneity
(distinct subspecies/interactions or normally-distributed).</li>
</ul>
</div>


                            <div id="MichaelisMentenProcess.__init__" class="classattr">
                                        <input id="MichaelisMentenProcess.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MichaelisMentenProcess</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="MichaelisMentenProcess.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MichaelisMentenProcess.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MichaelisMentenProcess.__init__-520"><a href="#MichaelisMentenProcess.__init__-520"><span class="linenos">520</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-521"><a href="#MichaelisMentenProcess.__init__-521"><span class="linenos">521</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-522"><a href="#MichaelisMentenProcess.__init__-522"><span class="linenos">522</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess.__init__-523"><a href="#MichaelisMentenProcess.__init__-523"><span class="linenos">523</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess.__init__-524"><a href="#MichaelisMentenProcess.__init__-524"><span class="linenos">524</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess.__init__-525"><a href="#MichaelisMentenProcess.__init__-525"><span class="linenos">525</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-526"><a href="#MichaelisMentenProcess.__init__-526"><span class="linenos">526</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-527"><a href="#MichaelisMentenProcess.__init__-527"><span class="linenos">527</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess.__init__-528"><a href="#MichaelisMentenProcess.__init__-528"><span class="linenos">528</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="MichaelisMentenProcess.__init__-529"><a href="#MichaelisMentenProcess.__init__-529"><span class="linenos">529</span></a>
</span><span id="MichaelisMentenProcess.__init__-530"><a href="#MichaelisMentenProcess.__init__-530"><span class="linenos">530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="MichaelisMentenProcess.__init__-531"><a href="#MichaelisMentenProcess.__init__-531"><span class="linenos">531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="MichaelisMentenProcess.__init__-532"><a href="#MichaelisMentenProcess.__init__-532"><span class="linenos">532</span></a>
</span><span id="MichaelisMentenProcess.__init__-533"><a href="#MichaelisMentenProcess.__init__-533"><span class="linenos">533</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-534"><a href="#MichaelisMentenProcess.__init__-534"><span class="linenos">534</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-535"><a href="#MichaelisMentenProcess.__init__-535"><span class="linenos">535</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.__init__-536"><a href="#MichaelisMentenProcess.__init__-536"><span class="linenos">536</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess.__init__-537"><a href="#MichaelisMentenProcess.__init__-537"><span class="linenos">537</span></a>
</span><span id="MichaelisMentenProcess.__init__-538"><a href="#MichaelisMentenProcess.__init__-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="MichaelisMentenProcess.__init__-539"><a href="#MichaelisMentenProcess.__init__-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess.__init__-540"><a href="#MichaelisMentenProcess.__init__-540"><span class="linenos">540</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MichaelisMentenProcess.__init__-541"><a href="#MichaelisMentenProcess.__init__-541"><span class="linenos">541</span></a>
</span><span id="MichaelisMentenProcess.__init__-542"><a href="#MichaelisMentenProcess.__init__-542"><span class="linenos">542</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="MichaelisMentenProcess.__init__-543"><a href="#MichaelisMentenProcess.__init__-543"><span class="linenos">543</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="MichaelisMentenProcess.__init__-544"><a href="#MichaelisMentenProcess.__init__-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess.__init__-545"><a href="#MichaelisMentenProcess.__init__-545"><span class="linenos">545</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="MichaelisMentenProcess.__init__-546"><a href="#MichaelisMentenProcess.__init__-546"><span class="linenos">546</span></a>
</span><span id="MichaelisMentenProcess.__init__-547"><a href="#MichaelisMentenProcess.__init__-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="MichaelisMentenProcess.__init__-548"><a href="#MichaelisMentenProcess.__init__-548"><span class="linenos">548</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MichaelisMentenProcess.catalyst" class="classattr">
                                <div class="attr variable">
            <span class="name">catalyst</span>

        
    </div>
    <a class="headerlink" href="#MichaelisMentenProcess.catalyst"></a>
    
    

                            </div>
                            <div id="MichaelisMentenProcess.Km" class="classattr">
                                <div class="attr variable">
            <span class="name">Km</span>

        
    </div>
    <a class="headerlink" href="#MichaelisMentenProcess.Km"></a>
    
    

                            </div>
                            <div id="MichaelisMentenProcess.is_heterogeneous_Km" class="classattr">
                                <div class="attr variable">
            <span class="name">is_heterogeneous_Km</span>

        
    </div>
    <a class="headerlink" href="#MichaelisMentenProcess.is_heterogeneous_Km"></a>
    
    

                            </div>
                            <div id="MichaelisMentenProcess.from_string" class="classattr">
                                        <input id="MichaelisMentenProcess.from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="MichaelisMentenProcess.from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MichaelisMentenProcess.from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MichaelisMentenProcess.from_string-550"><a href="#MichaelisMentenProcess.from_string-550"><span class="linenos">550</span></a>    <span class="nd">@classmethod</span>
</span><span id="MichaelisMentenProcess.from_string-551"><a href="#MichaelisMentenProcess.from_string-551"><span class="linenos">551</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-552"><a href="#MichaelisMentenProcess.from_string-552"><span class="linenos">552</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-553"><a href="#MichaelisMentenProcess.from_string-553"><span class="linenos">553</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-554"><a href="#MichaelisMentenProcess.from_string-554"><span class="linenos">554</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="MichaelisMentenProcess.from_string-555"><a href="#MichaelisMentenProcess.from_string-555"><span class="linenos">555</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-556"><a href="#MichaelisMentenProcess.from_string-556"><span class="linenos">556</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-557"><a href="#MichaelisMentenProcess.from_string-557"><span class="linenos">557</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="MichaelisMentenProcess.from_string-558"><a href="#MichaelisMentenProcess.from_string-558"><span class="linenos">558</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-559"><a href="#MichaelisMentenProcess.from_string-559"><span class="linenos">559</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-560"><a href="#MichaelisMentenProcess.from_string-560"><span class="linenos">560</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess.from_string-561"><a href="#MichaelisMentenProcess.from_string-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a Michaelis-Menten process from a string.</span>
</span><span id="MichaelisMentenProcess.from_string-562"><a href="#MichaelisMentenProcess.from_string-562"><span class="linenos">562</span></a>
</span><span id="MichaelisMentenProcess.from_string-563"><a href="#MichaelisMentenProcess.from_string-563"><span class="linenos">563</span></a><span class="sd">        Parameters</span>
</span><span id="MichaelisMentenProcess.from_string-564"><a href="#MichaelisMentenProcess.from_string-564"><span class="linenos">564</span></a><span class="sd">        ----------</span>
</span><span id="MichaelisMentenProcess.from_string-565"><a href="#MichaelisMentenProcess.from_string-565"><span class="linenos">565</span></a><span class="sd">        proc_str : str</span>
</span><span id="MichaelisMentenProcess.from_string-566"><a href="#MichaelisMentenProcess.from_string-566"><span class="linenos">566</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="MichaelisMentenProcess.from_string-567"><a href="#MichaelisMentenProcess.from_string-567"><span class="linenos">567</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="MichaelisMentenProcess.from_string-568"><a href="#MichaelisMentenProcess.from_string-568"><span class="linenos">568</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="MichaelisMentenProcess.from_string-569"><a href="#MichaelisMentenProcess.from_string-569"><span class="linenos">569</span></a><span class="sd">            The *microscopic* rate constant for the given process. If `k` is a</span>
</span><span id="MichaelisMentenProcess.from_string-570"><a href="#MichaelisMentenProcess.from_string-570"><span class="linenos">570</span></a><span class="sd">            float or int, then the process is homogeneous. If `k` is a list, then</span>
</span><span id="MichaelisMentenProcess.from_string-571"><a href="#MichaelisMentenProcess.from_string-571"><span class="linenos">571</span></a><span class="sd">            the population of the reactants constsists of distinct subspecies</span>
</span><span id="MichaelisMentenProcess.from_string-572"><a href="#MichaelisMentenProcess.from_string-572"><span class="linenos">572</span></a><span class="sd">            or subinteractions depending on the order. If `k` is a 2-tuple,</span>
</span><span id="MichaelisMentenProcess.from_string-573"><a href="#MichaelisMentenProcess.from_string-573"><span class="linenos">573</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="MichaelisMentenProcess.from_string-574"><a href="#MichaelisMentenProcess.from_string-574"><span class="linenos">574</span></a><span class="sd">            deviation specified in the tuple&#39;s elements.</span>
</span><span id="MichaelisMentenProcess.from_string-575"><a href="#MichaelisMentenProcess.from_string-575"><span class="linenos">575</span></a><span class="sd">        catalyst : str</span>
</span><span id="MichaelisMentenProcess.from_string-576"><a href="#MichaelisMentenProcess.from_string-576"><span class="linenos">576</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="MichaelisMentenProcess.from_string-577"><a href="#MichaelisMentenProcess.from_string-577"><span class="linenos">577</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="MichaelisMentenProcess.from_string-578"><a href="#MichaelisMentenProcess.from_string-578"><span class="linenos">578</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="MichaelisMentenProcess.from_string-579"><a href="#MichaelisMentenProcess.from_string-579"><span class="linenos">579</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="MichaelisMentenProcess.from_string-580"><a href="#MichaelisMentenProcess.from_string-580"><span class="linenos">580</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="MichaelisMentenProcess.from_string-581"><a href="#MichaelisMentenProcess.from_string-581"><span class="linenos">581</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="MichaelisMentenProcess.from_string-582"><a href="#MichaelisMentenProcess.from_string-582"><span class="linenos">582</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="MichaelisMentenProcess.from_string-583"><a href="#MichaelisMentenProcess.from_string-583"><span class="linenos">583</span></a><span class="sd">            are taking place.</span>
</span><span id="MichaelisMentenProcess.from_string-584"><a href="#MichaelisMentenProcess.from_string-584"><span class="linenos">584</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="MichaelisMentenProcess.from_string-585"><a href="#MichaelisMentenProcess.from_string-585"><span class="linenos">585</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="MichaelisMentenProcess.from_string-586"><a href="#MichaelisMentenProcess.from_string-586"><span class="linenos">586</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="MichaelisMentenProcess.from_string-587"><a href="#MichaelisMentenProcess.from_string-587"><span class="linenos">587</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="MichaelisMentenProcess.from_string-588"><a href="#MichaelisMentenProcess.from_string-588"><span class="linenos">588</span></a>
</span><span id="MichaelisMentenProcess.from_string-589"><a href="#MichaelisMentenProcess.from_string-589"><span class="linenos">589</span></a><span class="sd">        Notes</span>
</span><span id="MichaelisMentenProcess.from_string-590"><a href="#MichaelisMentenProcess.from_string-590"><span class="linenos">590</span></a><span class="sd">        -----</span>
</span><span id="MichaelisMentenProcess.from_string-591"><a href="#MichaelisMentenProcess.from_string-591"><span class="linenos">591</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="MichaelisMentenProcess.from_string-592"><a href="#MichaelisMentenProcess.from_string-592"><span class="linenos">592</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="MichaelisMentenProcess.from_string-593"><a href="#MichaelisMentenProcess.from_string-593"><span class="linenos">593</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="MichaelisMentenProcess.from_string-594"><a href="#MichaelisMentenProcess.from_string-594"><span class="linenos">594</span></a>
</span><span id="MichaelisMentenProcess.from_string-595"><a href="#MichaelisMentenProcess.from_string-595"><span class="linenos">595</span></a><span class="sd">        Examples</span>
</span><span id="MichaelisMentenProcess.from_string-596"><a href="#MichaelisMentenProcess.from_string-596"><span class="linenos">596</span></a><span class="sd">        --------</span>
</span><span id="MichaelisMentenProcess.from_string-597"><a href="#MichaelisMentenProcess.from_string-597"><span class="linenos">597</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;E&#39;, Km=10)</span>
</span><span id="MichaelisMentenProcess.from_string-598"><a href="#MichaelisMentenProcess.from_string-598"><span class="linenos">598</span></a><span class="sd">        &gt;&gt;&gt; MichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, catalyst=&#39;alpha&#39;, Km=(10, 1))</span>
</span><span id="MichaelisMentenProcess.from_string-599"><a href="#MichaelisMentenProcess.from_string-599"><span class="linenos">599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MichaelisMentenProcess.from_string-600"><a href="#MichaelisMentenProcess.from_string-600"><span class="linenos">600</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="MichaelisMentenProcess.from_string-601"><a href="#MichaelisMentenProcess.from_string-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="MichaelisMentenProcess.from_string-602"><a href="#MichaelisMentenProcess.from_string-602"><span class="linenos">602</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MichaelisMentenProcess.from_string-603"><a href="#MichaelisMentenProcess.from_string-603"><span class="linenos">603</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="MichaelisMentenProcess.from_string-604"><a href="#MichaelisMentenProcess.from_string-604"><span class="linenos">604</span></a>
</span><span id="MichaelisMentenProcess.from_string-605"><a href="#MichaelisMentenProcess.from_string-605"><span class="linenos">605</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="MichaelisMentenProcess.from_string-606"><a href="#MichaelisMentenProcess.from_string-606"><span class="linenos">606</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="MichaelisMentenProcess.from_string-607"><a href="#MichaelisMentenProcess.from_string-607"><span class="linenos">607</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="MichaelisMentenProcess.from_string-608"><a href="#MichaelisMentenProcess.from_string-608"><span class="linenos">608</span></a>
</span><span id="MichaelisMentenProcess.from_string-609"><a href="#MichaelisMentenProcess.from_string-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="MichaelisMentenProcess.from_string-610"><a href="#MichaelisMentenProcess.from_string-610"><span class="linenos">610</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="MichaelisMentenProcess.from_string-611"><a href="#MichaelisMentenProcess.from_string-611"><span class="linenos">611</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-612"><a href="#MichaelisMentenProcess.from_string-612"><span class="linenos">612</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-613"><a href="#MichaelisMentenProcess.from_string-613"><span class="linenos">613</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="MichaelisMentenProcess.from_string-614"><a href="#MichaelisMentenProcess.from_string-614"><span class="linenos">614</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a Michaelis-Menten process from a string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proc_str</strong> (str):
A string describing the process in standard chemical notation
(e.g., 'A + B -> C')</li>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the given process. If <code><a href="#MichaelisMentenProcess.k">k</a></code> is a
float or int, then the process is homogeneous. If <code><a href="#MichaelisMentenProcess.k">k</a></code> is a list, then
the population of the reactants constsists of distinct subspecies
or subinteractions depending on the order. If <code><a href="#MichaelisMentenProcess.k">k</a></code> is a 2-tuple,
then the constant is normally-distributed with a mean and standard
deviation specified in the tuple's elements.</li>
<li><strong>catalyst</strong> (str):
Name of species acting as a catalyst.</li>
<li><strong>Km</strong> (float or int or list of floats or 2-tuple of floats):
<em>Microscopic</em> Michaelis constant for the process.
Heterogeneity in this parameter is determined by the type of <code><a href="#MichaelisMentenProcess.Km">Km</a></code>,
using the same rules as for parameter <code><a href="#MichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>sep : str, default</strong> ('->'):
Specifies the characters that distinguish the reactants from the
products. The default is '->'. The code also treats <code>--&gt;</code> as a
default, if it's present in <code>proc_str</code>.</li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>Species names should not contain spaces, dashes, and
should start with a non-numeric character.</li>
<li>Zeroth order processes should be specified by an empty space or 'None'.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#MichaelisMentenProcess.from_string">MichaelisMentenProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">catalyst</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">Km</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#MichaelisMentenProcess.from_string">MichaelisMentenProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">catalyst</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">Km</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Process">Process</a></dt>
                                <dd id="MichaelisMentenProcess.reactants" class="variable"><a href="#Process.reactants">reactants</a></dd>
                <dd id="MichaelisMentenProcess.products" class="variable"><a href="#Process.products">products</a></dd>
                <dd id="MichaelisMentenProcess.k" class="variable"><a href="#Process.k">k</a></dd>
                <dd id="MichaelisMentenProcess.volume" class="variable"><a href="#Process.volume">volume</a></dd>
                <dd id="MichaelisMentenProcess.order" class="variable"><a href="#Process.order">order</a></dd>
                <dd id="MichaelisMentenProcess.is_heterogeneous" class="variable"><a href="#Process.is_heterogeneous">is_heterogeneous</a></dd>
                <dd id="MichaelisMentenProcess.species" class="variable"><a href="#Process.species">species</a></dd>
                <dd id="MichaelisMentenProcess.reacts_" class="variable"><a href="#Process.reacts_">reacts_</a></dd>
                <dd id="MichaelisMentenProcess.prods_" class="variable"><a href="#Process.prods_">prods_</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RegulatedProcess">
                            <input id="RegulatedProcess-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RegulatedProcess</span><wbr>(<span class="base"><a href="#Process">Process</a></span>):

                <label class="view-source-button" for="RegulatedProcess-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedProcess"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedProcess-660"><a href="#RegulatedProcess-660"><span class="linenos">660</span></a><span class="k">class</span> <span class="nc">RegulatedProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
</span><span id="RegulatedProcess-661"><a href="#RegulatedProcess-661"><span class="linenos">661</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that is regulated.</span>
</span><span id="RegulatedProcess-662"><a href="#RegulatedProcess-662"><span class="linenos">662</span></a>
</span><span id="RegulatedProcess-663"><a href="#RegulatedProcess-663"><span class="linenos">663</span></a><span class="sd">    This class allows a Process to be defined in terms of how it is regulated.</span>
</span><span id="RegulatedProcess-664"><a href="#RegulatedProcess-664"><span class="linenos">664</span></a><span class="sd">    If there is only one regulating species, then the parameters have the same</span>
</span><span id="RegulatedProcess-665"><a href="#RegulatedProcess-665"><span class="linenos">665</span></a><span class="sd">    type as would be expected for a homogeneous/heterogeneous process.</span>
</span><span id="RegulatedProcess-666"><a href="#RegulatedProcess-666"><span class="linenos">666</span></a><span class="sd">    If there are multiple regulating species, then all parameters are a list</span>
</span><span id="RegulatedProcess-667"><a href="#RegulatedProcess-667"><span class="linenos">667</span></a><span class="sd">    of their expected type, with the length of the list being equal to the</span>
</span><span id="RegulatedProcess-668"><a href="#RegulatedProcess-668"><span class="linenos">668</span></a><span class="sd">    number of regulating species.</span>
</span><span id="RegulatedProcess-669"><a href="#RegulatedProcess-669"><span class="linenos">669</span></a>
</span><span id="RegulatedProcess-670"><a href="#RegulatedProcess-670"><span class="linenos">670</span></a><span class="sd">    The class-specific attributes (except for `k`, which requires some</span>
</span><span id="RegulatedProcess-671"><a href="#RegulatedProcess-671"><span class="linenos">671</span></a><span class="sd">    additional notes) are listed below.</span>
</span><span id="RegulatedProcess-672"><a href="#RegulatedProcess-672"><span class="linenos">672</span></a><span class="sd">    </span>
</span><span id="RegulatedProcess-673"><a href="#RegulatedProcess-673"><span class="linenos">673</span></a><span class="sd">    Attributes</span>
</span><span id="RegulatedProcess-674"><a href="#RegulatedProcess-674"><span class="linenos">674</span></a><span class="sd">    ----------</span>
</span><span id="RegulatedProcess-675"><a href="#RegulatedProcess-675"><span class="linenos">675</span></a><span class="sd">    k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedProcess-676"><a href="#RegulatedProcess-676"><span class="linenos">676</span></a><span class="sd">        The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedProcess-677"><a href="#RegulatedProcess-677"><span class="linenos">677</span></a><span class="sd">        rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="RegulatedProcess-678"><a href="#RegulatedProcess-678"><span class="linenos">678</span></a><span class="sd">        and the maximum rate constant in the case of repression.</span>
</span><span id="RegulatedProcess-679"><a href="#RegulatedProcess-679"><span class="linenos">679</span></a><span class="sd">    regulating_species : str or list of str</span>
</span><span id="RegulatedProcess-680"><a href="#RegulatedProcess-680"><span class="linenos">680</span></a><span class="sd">        Name of the regulating species. Multiple species can be specified as</span>
</span><span id="RegulatedProcess-681"><a href="#RegulatedProcess-681"><span class="linenos">681</span></a><span class="sd">        comma-separated in a string or a list of strings with the species names.</span>
</span><span id="RegulatedProcess-682"><a href="#RegulatedProcess-682"><span class="linenos">682</span></a><span class="sd">    alpha : float or int or list[float or int]</span>
</span><span id="RegulatedProcess-683"><a href="#RegulatedProcess-683"><span class="linenos">683</span></a><span class="sd">        Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedProcess-684"><a href="#RegulatedProcess-684"><span class="linenos">684</span></a>
</span><span id="RegulatedProcess-685"><a href="#RegulatedProcess-685"><span class="linenos">685</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedProcess-686"><a href="#RegulatedProcess-686"><span class="linenos">686</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="RegulatedProcess-687"><a href="#RegulatedProcess-687"><span class="linenos">687</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="RegulatedProcess-688"><a href="#RegulatedProcess-688"><span class="linenos">688</span></a><span class="sd">            </span>
</span><span id="RegulatedProcess-689"><a href="#RegulatedProcess-689"><span class="linenos">689</span></a><span class="sd">        alpha is a multiplier: in the case of activation, the maximum </span>
</span><span id="RegulatedProcess-690"><a href="#RegulatedProcess-690"><span class="linenos">690</span></a><span class="sd">        rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess-691"><a href="#RegulatedProcess-691"><span class="linenos">691</span></a><span class="sd">        In the case of repression, the minimum </span>
</span><span id="RegulatedProcess-692"><a href="#RegulatedProcess-692"><span class="linenos">692</span></a><span class="sd">        rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess-693"><a href="#RegulatedProcess-693"><span class="linenos">693</span></a><span class="sd">    K50 : float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]</span>
</span><span id="RegulatedProcess-694"><a href="#RegulatedProcess-694"><span class="linenos">694</span></a><span class="sd">        *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedProcess-695"><a href="#RegulatedProcess-695"><span class="linenos">695</span></a><span class="sd">        `regulating_species` agents that would produce </span>
</span><span id="RegulatedProcess-696"><a href="#RegulatedProcess-696"><span class="linenos">696</span></a><span class="sd">        half-maximal activation/repression. </span>
</span><span id="RegulatedProcess-697"><a href="#RegulatedProcess-697"><span class="linenos">697</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedProcess-698"><a href="#RegulatedProcess-698"><span class="linenos">698</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="RegulatedProcess-699"><a href="#RegulatedProcess-699"><span class="linenos">699</span></a><span class="sd">    nH : float or int or list[float or int]</span>
</span><span id="RegulatedProcess-700"><a href="#RegulatedProcess-700"><span class="linenos">700</span></a><span class="sd">        Hill coefficient for the given process. Indicates the degree of </span>
</span><span id="RegulatedProcess-701"><a href="#RegulatedProcess-701"><span class="linenos">701</span></a><span class="sd">        cooperativity in the regulatory interaction. </span>
</span><span id="RegulatedProcess-702"><a href="#RegulatedProcess-702"><span class="linenos">702</span></a><span class="sd">    is_heterogeneous_K50 : bool or list of bool</span>
</span><span id="RegulatedProcess-703"><a href="#RegulatedProcess-703"><span class="linenos">703</span></a><span class="sd">        Denotes if the parameter `K50` exhibits heterogeneity</span>
</span><span id="RegulatedProcess-704"><a href="#RegulatedProcess-704"><span class="linenos">704</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="RegulatedProcess-705"><a href="#RegulatedProcess-705"><span class="linenos">705</span></a><span class="sd">    regulation_type : str or list of str</span>
</span><span id="RegulatedProcess-706"><a href="#RegulatedProcess-706"><span class="linenos">706</span></a><span class="sd">        The type of regulation for this process based on the value of alpha:</span>
</span><span id="RegulatedProcess-707"><a href="#RegulatedProcess-707"><span class="linenos">707</span></a><span class="sd">        &#39;activation&#39; or &#39;repression&#39; or &#39;no regulation&#39;.</span>
</span><span id="RegulatedProcess-708"><a href="#RegulatedProcess-708"><span class="linenos">708</span></a>
</span><span id="RegulatedProcess-709"><a href="#RegulatedProcess-709"><span class="linenos">709</span></a><span class="sd">    Notes</span>
</span><span id="RegulatedProcess-710"><a href="#RegulatedProcess-710"><span class="linenos">710</span></a><span class="sd">    -----</span>
</span><span id="RegulatedProcess-711"><a href="#RegulatedProcess-711"><span class="linenos">711</span></a><span class="sd">    Allowing a 0th order process to be regulated. However, heterogeneity</span>
</span><span id="RegulatedProcess-712"><a href="#RegulatedProcess-712"><span class="linenos">712</span></a><span class="sd">    in `k` and `K50` (or any other parameters) is not allowed for such</span>
</span><span id="RegulatedProcess-713"><a href="#RegulatedProcess-713"><span class="linenos">713</span></a><span class="sd">    a process.</span>
</span><span id="RegulatedProcess-714"><a href="#RegulatedProcess-714"><span class="linenos">714</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RegulatedProcess-715"><a href="#RegulatedProcess-715"><span class="linenos">715</span></a>
</span><span id="RegulatedProcess-716"><a href="#RegulatedProcess-716"><span class="linenos">716</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="RegulatedProcess-717"><a href="#RegulatedProcess-717"><span class="linenos">717</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedProcess-718"><a href="#RegulatedProcess-718"><span class="linenos">718</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedProcess-719"><a href="#RegulatedProcess-719"><span class="linenos">719</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedProcess-720"><a href="#RegulatedProcess-720"><span class="linenos">720</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedProcess-721"><a href="#RegulatedProcess-721"><span class="linenos">721</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedProcess-722"><a href="#RegulatedProcess-722"><span class="linenos">722</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess-723"><a href="#RegulatedProcess-723"><span class="linenos">723</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess-724"><a href="#RegulatedProcess-724"><span class="linenos">724</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedProcess-725"><a href="#RegulatedProcess-725"><span class="linenos">725</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="RegulatedProcess-726"><a href="#RegulatedProcess-726"><span class="linenos">726</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess-727"><a href="#RegulatedProcess-727"><span class="linenos">727</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="RegulatedProcess-728"><a href="#RegulatedProcess-728"><span class="linenos">728</span></a>
</span><span id="RegulatedProcess-729"><a href="#RegulatedProcess-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="RegulatedProcess-730"><a href="#RegulatedProcess-730"><span class="linenos">730</span></a>            <span class="n">reg_sp_list</span> <span class="o">=</span> <span class="n">regulating_species</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="RegulatedProcess-731"><a href="#RegulatedProcess-731"><span class="linenos">731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">reg_sp_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reg_sp_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">reg_sp_list</span>
</span><span id="RegulatedProcess-732"><a href="#RegulatedProcess-732"><span class="linenos">732</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if it is a list</span>
</span><span id="RegulatedProcess-733"><a href="#RegulatedProcess-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">regulating_species</span>
</span><span id="RegulatedProcess-734"><a href="#RegulatedProcess-734"><span class="linenos">734</span></a>
</span><span id="RegulatedProcess-735"><a href="#RegulatedProcess-735"><span class="linenos">735</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="RegulatedProcess-736"><a href="#RegulatedProcess-736"><span class="linenos">736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">K50</span>
</span><span id="RegulatedProcess-737"><a href="#RegulatedProcess-737"><span class="linenos">737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">=</span> <span class="n">nH</span>
</span><span id="RegulatedProcess-738"><a href="#RegulatedProcess-738"><span class="linenos">738</span></a>
</span><span id="RegulatedProcess-739"><a href="#RegulatedProcess-739"><span class="linenos">739</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-740"><a href="#RegulatedProcess-740"><span class="linenos">740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">val</span>
</span><span id="RegulatedProcess-741"><a href="#RegulatedProcess-741"><span class="linenos">741</span></a>                                         <span class="ow">in</span> <span class="n">K50</span><span class="p">]</span>
</span><span id="RegulatedProcess-742"><a href="#RegulatedProcess-742"><span class="linenos">742</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-743"><a href="#RegulatedProcess-743"><span class="linenos">743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="RegulatedProcess-744"><a href="#RegulatedProcess-744"><span class="linenos">744</span></a>
</span><span id="RegulatedProcess-745"><a href="#RegulatedProcess-745"><span class="linenos">745</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="RegulatedProcess-746"><a href="#RegulatedProcess-746"><span class="linenos">746</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="RegulatedProcess-747"><a href="#RegulatedProcess-747"><span class="linenos">747</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedProcess-748"><a href="#RegulatedProcess-748"><span class="linenos">748</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess-749"><a href="#RegulatedProcess-749"><span class="linenos">749</span></a>
</span><span id="RegulatedProcess-750"><a href="#RegulatedProcess-750"><span class="linenos">750</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic K50 value</span>
</span><span id="RegulatedProcess-751"><a href="#RegulatedProcess-751"><span class="linenos">751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess-752"><a href="#RegulatedProcess-752"><span class="linenos">752</span></a>
</span><span id="RegulatedProcess-753"><a href="#RegulatedProcess-753"><span class="linenos">753</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, regulating_species = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-754"><a href="#RegulatedProcess-754"><span class="linenos">754</span></a>                     <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="RegulatedProcess-755"><a href="#RegulatedProcess-755"><span class="linenos">755</span></a>
</span><span id="RegulatedProcess-756"><a href="#RegulatedProcess-756"><span class="linenos">756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="RegulatedProcess-757"><a href="#RegulatedProcess-757"><span class="linenos">757</span></a>
</span><span id="RegulatedProcess-758"><a href="#RegulatedProcess-758"><span class="linenos">758</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-759"><a href="#RegulatedProcess-759"><span class="linenos">759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="RegulatedProcess-760"><a href="#RegulatedProcess-760"><span class="linenos">760</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
</span><span id="RegulatedProcess-761"><a href="#RegulatedProcess-761"><span class="linenos">761</span></a>                <span class="n">reg_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span><span id="RegulatedProcess-762"><a href="#RegulatedProcess-762"><span class="linenos">762</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg_type</span><span class="p">)</span>
</span><span id="RegulatedProcess-763"><a href="#RegulatedProcess-763"><span class="linenos">763</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-764"><a href="#RegulatedProcess-764"><span class="linenos">764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span><span id="RegulatedProcess-765"><a href="#RegulatedProcess-765"><span class="linenos">765</span></a>
</span><span id="RegulatedProcess-766"><a href="#RegulatedProcess-766"><span class="linenos">766</span></a>    <span class="k">def</span> <span class="nf">_validate_reg_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedProcess-767"><a href="#RegulatedProcess-767"><span class="linenos">767</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Validate the parameters specific to the regulation. &quot;&quot;&quot;</span>
</span><span id="RegulatedProcess-768"><a href="#RegulatedProcess-768"><span class="linenos">768</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># multiple regulating species</span>
</span><span id="RegulatedProcess-769"><a href="#RegulatedProcess-769"><span class="linenos">769</span></a>            <span class="c1"># First check that the right number of values for each parameter are specified</span>
</span><span id="RegulatedProcess-770"><a href="#RegulatedProcess-770"><span class="linenos">770</span></a>            <span class="n">rs_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">)</span>
</span><span id="RegulatedProcess-771"><a href="#RegulatedProcess-771"><span class="linenos">771</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Must specify </span><span class="si">{</span><span class="n">rs_num</span><span class="si">}</span><span class="s2"> # values when there are </span><span class="si">{</span><span class="n">rs_num</span><span class="si">}</span><span class="s2"> regulating species.&quot;</span>
</span><span id="RegulatedProcess-772"><a href="#RegulatedProcess-772"><span class="linenos">772</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
</span><span id="RegulatedProcess-773"><a href="#RegulatedProcess-773"><span class="linenos">773</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;K50&#39;</span><span class="p">)</span>
</span><span id="RegulatedProcess-774"><a href="#RegulatedProcess-774"><span class="linenos">774</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="p">)</span> <span class="o">==</span> <span class="n">rs_num</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;nH&#39;</span><span class="p">)</span>
</span><span id="RegulatedProcess-775"><a href="#RegulatedProcess-775"><span class="linenos">775</span></a>
</span><span id="RegulatedProcess-776"><a href="#RegulatedProcess-776"><span class="linenos">776</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">)):</span>
</span><span id="RegulatedProcess-777"><a href="#RegulatedProcess-777"><span class="linenos">777</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The alpha parameter must be nonnegative.&quot;</span>
</span><span id="RegulatedProcess-778"><a href="#RegulatedProcess-778"><span class="linenos">778</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RegulatedProcess-779"><a href="#RegulatedProcess-779"><span class="linenos">779</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: alpha=1 means the process is not regulated.&quot;</span><span class="p">)</span>
</span><span id="RegulatedProcess-780"><a href="#RegulatedProcess-780"><span class="linenos">780</span></a>
</span><span id="RegulatedProcess-781"><a href="#RegulatedProcess-781"><span class="linenos">781</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedProcess-782"><a href="#RegulatedProcess-782"><span class="linenos">782</span></a>                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;K50 has to be positive.&quot;</span>
</span><span id="RegulatedProcess-783"><a href="#RegulatedProcess-783"><span class="linenos">783</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-784"><a href="#RegulatedProcess-784"><span class="linenos">784</span></a>                    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> \
</span><span id="RegulatedProcess-785"><a href="#RegulatedProcess-785"><span class="linenos">785</span></a>                        <span class="s2">&quot;Subspecies K50 values have to be positive.&quot;</span>
</span><span id="RegulatedProcess-786"><a href="#RegulatedProcess-786"><span class="linenos">786</span></a>                <span class="k">else</span><span class="p">:</span>  <span class="c1"># isinstance(self.K50, tuple)</span>
</span><span id="RegulatedProcess-787"><a href="#RegulatedProcess-787"><span class="linenos">787</span></a>                    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
</span><span id="RegulatedProcess-788"><a href="#RegulatedProcess-788"><span class="linenos">788</span></a>                        <span class="s2">&quot;Mean and std of K50 have to be positive.&quot;</span>
</span><span id="RegulatedProcess-789"><a href="#RegulatedProcess-789"><span class="linenos">789</span></a>
</span><span id="RegulatedProcess-790"><a href="#RegulatedProcess-790"><span class="linenos">790</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RegulatedProcess-791"><a href="#RegulatedProcess-791"><span class="linenos">791</span></a>                    <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> \
</span><span id="RegulatedProcess-792"><a href="#RegulatedProcess-792"><span class="linenos">792</span></a>                        <span class="s2">&quot;Heterogeneity in parameter K50 is not allowed for a 0th order process.&quot;</span>
</span><span id="RegulatedProcess-793"><a href="#RegulatedProcess-793"><span class="linenos">793</span></a>
</span><span id="RegulatedProcess-794"><a href="#RegulatedProcess-794"><span class="linenos">794</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;nH has to be positive.&quot;</span>
</span><span id="RegulatedProcess-795"><a href="#RegulatedProcess-795"><span class="linenos">795</span></a>
</span><span id="RegulatedProcess-796"><a href="#RegulatedProcess-796"><span class="linenos">796</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># just one regulating species</span>
</span><span id="RegulatedProcess-797"><a href="#RegulatedProcess-797"><span class="linenos">797</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The alpha parameter must be nonnegative.&quot;</span>
</span><span id="RegulatedProcess-798"><a href="#RegulatedProcess-798"><span class="linenos">798</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RegulatedProcess-799"><a href="#RegulatedProcess-799"><span class="linenos">799</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: alpha=1 means the process is not regulated.&quot;</span><span class="p">)</span>
</span><span id="RegulatedProcess-800"><a href="#RegulatedProcess-800"><span class="linenos">800</span></a>
</span><span id="RegulatedProcess-801"><a href="#RegulatedProcess-801"><span class="linenos">801</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedProcess-802"><a href="#RegulatedProcess-802"><span class="linenos">802</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;K50 has to be positive.&quot;</span>
</span><span id="RegulatedProcess-803"><a href="#RegulatedProcess-803"><span class="linenos">803</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-804"><a href="#RegulatedProcess-804"><span class="linenos">804</span></a>                <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">]),</span> \
</span><span id="RegulatedProcess-805"><a href="#RegulatedProcess-805"><span class="linenos">805</span></a>                    <span class="s2">&quot;Subspecies K50 values have to be positive.&quot;</span>
</span><span id="RegulatedProcess-806"><a href="#RegulatedProcess-806"><span class="linenos">806</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># isinstance(self.K50, tuple)</span>
</span><span id="RegulatedProcess-807"><a href="#RegulatedProcess-807"><span class="linenos">807</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> \
</span><span id="RegulatedProcess-808"><a href="#RegulatedProcess-808"><span class="linenos">808</span></a>                    <span class="s2">&quot;Mean and std of K50 have to be positive.&quot;</span>
</span><span id="RegulatedProcess-809"><a href="#RegulatedProcess-809"><span class="linenos">809</span></a>
</span><span id="RegulatedProcess-810"><a href="#RegulatedProcess-810"><span class="linenos">810</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RegulatedProcess-811"><a href="#RegulatedProcess-811"><span class="linenos">811</span></a>                <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span><span class="p">,</span> \
</span><span id="RegulatedProcess-812"><a href="#RegulatedProcess-812"><span class="linenos">812</span></a>                    <span class="s2">&quot;Heterogeneity in parameter K50 is not allowed for a 0th order process.&quot;</span>
</span><span id="RegulatedProcess-813"><a href="#RegulatedProcess-813"><span class="linenos">813</span></a>
</span><span id="RegulatedProcess-814"><a href="#RegulatedProcess-814"><span class="linenos">814</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;nH has to be positive.&quot;</span>
</span><span id="RegulatedProcess-815"><a href="#RegulatedProcess-815"><span class="linenos">815</span></a>
</span><span id="RegulatedProcess-816"><a href="#RegulatedProcess-816"><span class="linenos">816</span></a>    <span class="nd">@classmethod</span>
</span><span id="RegulatedProcess-817"><a href="#RegulatedProcess-817"><span class="linenos">817</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="RegulatedProcess-818"><a href="#RegulatedProcess-818"><span class="linenos">818</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedProcess-819"><a href="#RegulatedProcess-819"><span class="linenos">819</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedProcess-820"><a href="#RegulatedProcess-820"><span class="linenos">820</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedProcess-821"><a href="#RegulatedProcess-821"><span class="linenos">821</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedProcess-822"><a href="#RegulatedProcess-822"><span class="linenos">822</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess-823"><a href="#RegulatedProcess-823"><span class="linenos">823</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RegulatedProcess-824"><a href="#RegulatedProcess-824"><span class="linenos">824</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedProcess-825"><a href="#RegulatedProcess-825"><span class="linenos">825</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedProcess-826"><a href="#RegulatedProcess-826"><span class="linenos">826</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess-827"><a href="#RegulatedProcess-827"><span class="linenos">827</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess-828"><a href="#RegulatedProcess-828"><span class="linenos">828</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess-829"><a href="#RegulatedProcess-829"><span class="linenos">829</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="RegulatedProcess-830"><a href="#RegulatedProcess-830"><span class="linenos">830</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated process from a string.</span>
</span><span id="RegulatedProcess-831"><a href="#RegulatedProcess-831"><span class="linenos">831</span></a>
</span><span id="RegulatedProcess-832"><a href="#RegulatedProcess-832"><span class="linenos">832</span></a><span class="sd">        Parameters</span>
</span><span id="RegulatedProcess-833"><a href="#RegulatedProcess-833"><span class="linenos">833</span></a><span class="sd">        ----------</span>
</span><span id="RegulatedProcess-834"><a href="#RegulatedProcess-834"><span class="linenos">834</span></a><span class="sd">        proc_str : str</span>
</span><span id="RegulatedProcess-835"><a href="#RegulatedProcess-835"><span class="linenos">835</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="RegulatedProcess-836"><a href="#RegulatedProcess-836"><span class="linenos">836</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="RegulatedProcess-837"><a href="#RegulatedProcess-837"><span class="linenos">837</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedProcess-838"><a href="#RegulatedProcess-838"><span class="linenos">838</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedProcess-839"><a href="#RegulatedProcess-839"><span class="linenos">839</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value) </span>
</span><span id="RegulatedProcess-840"><a href="#RegulatedProcess-840"><span class="linenos">840</span></a><span class="sd">            and the maximum rate constant in the case of repression. </span>
</span><span id="RegulatedProcess-841"><a href="#RegulatedProcess-841"><span class="linenos">841</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous. </span>
</span><span id="RegulatedProcess-842"><a href="#RegulatedProcess-842"><span class="linenos">842</span></a><span class="sd">            If `k` is a list, then the population of the reactants </span>
</span><span id="RegulatedProcess-843"><a href="#RegulatedProcess-843"><span class="linenos">843</span></a><span class="sd">            constsists of distinct subspecies or subinteractions </span>
</span><span id="RegulatedProcess-844"><a href="#RegulatedProcess-844"><span class="linenos">844</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="RegulatedProcess-845"><a href="#RegulatedProcess-845"><span class="linenos">845</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="RegulatedProcess-846"><a href="#RegulatedProcess-846"><span class="linenos">846</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="RegulatedProcess-847"><a href="#RegulatedProcess-847"><span class="linenos">847</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="RegulatedProcess-848"><a href="#RegulatedProcess-848"><span class="linenos">848</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="RegulatedProcess-849"><a href="#RegulatedProcess-849"><span class="linenos">849</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="RegulatedProcess-850"><a href="#RegulatedProcess-850"><span class="linenos">850</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="RegulatedProcess-851"><a href="#RegulatedProcess-851"><span class="linenos">851</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedProcess-852"><a href="#RegulatedProcess-852"><span class="linenos">852</span></a>
</span><span id="RegulatedProcess-853"><a href="#RegulatedProcess-853"><span class="linenos">853</span></a><span class="sd">                - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedProcess-854"><a href="#RegulatedProcess-854"><span class="linenos">854</span></a><span class="sd">                - alpha = 1: no regulation</span>
</span><span id="RegulatedProcess-855"><a href="#RegulatedProcess-855"><span class="linenos">855</span></a><span class="sd">                - alpha &gt; 1: activation</span>
</span><span id="RegulatedProcess-856"><a href="#RegulatedProcess-856"><span class="linenos">856</span></a><span class="sd">                </span>
</span><span id="RegulatedProcess-857"><a href="#RegulatedProcess-857"><span class="linenos">857</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum </span>
</span><span id="RegulatedProcess-858"><a href="#RegulatedProcess-858"><span class="linenos">858</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess-859"><a href="#RegulatedProcess-859"><span class="linenos">859</span></a><span class="sd">            In the case of repression, the minimum </span>
</span><span id="RegulatedProcess-860"><a href="#RegulatedProcess-860"><span class="linenos">860</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess-861"><a href="#RegulatedProcess-861"><span class="linenos">861</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="RegulatedProcess-862"><a href="#RegulatedProcess-862"><span class="linenos">862</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedProcess-863"><a href="#RegulatedProcess-863"><span class="linenos">863</span></a><span class="sd">            `regulating_species` agents that would produce </span>
</span><span id="RegulatedProcess-864"><a href="#RegulatedProcess-864"><span class="linenos">864</span></a><span class="sd">            half-maximal activation/repression. </span>
</span><span id="RegulatedProcess-865"><a href="#RegulatedProcess-865"><span class="linenos">865</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedProcess-866"><a href="#RegulatedProcess-866"><span class="linenos">866</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedProcess-867"><a href="#RegulatedProcess-867"><span class="linenos">867</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="RegulatedProcess-868"><a href="#RegulatedProcess-868"><span class="linenos">868</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of </span>
</span><span id="RegulatedProcess-869"><a href="#RegulatedProcess-869"><span class="linenos">869</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="RegulatedProcess-870"><a href="#RegulatedProcess-870"><span class="linenos">870</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="RegulatedProcess-871"><a href="#RegulatedProcess-871"><span class="linenos">871</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="RegulatedProcess-872"><a href="#RegulatedProcess-872"><span class="linenos">872</span></a><span class="sd">            are taking place.</span>
</span><span id="RegulatedProcess-873"><a href="#RegulatedProcess-873"><span class="linenos">873</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="RegulatedProcess-874"><a href="#RegulatedProcess-874"><span class="linenos">874</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="RegulatedProcess-875"><a href="#RegulatedProcess-875"><span class="linenos">875</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="RegulatedProcess-876"><a href="#RegulatedProcess-876"><span class="linenos">876</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="RegulatedProcess-877"><a href="#RegulatedProcess-877"><span class="linenos">877</span></a>
</span><span id="RegulatedProcess-878"><a href="#RegulatedProcess-878"><span class="linenos">878</span></a><span class="sd">        Notes</span>
</span><span id="RegulatedProcess-879"><a href="#RegulatedProcess-879"><span class="linenos">879</span></a><span class="sd">        -----</span>
</span><span id="RegulatedProcess-880"><a href="#RegulatedProcess-880"><span class="linenos">880</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="RegulatedProcess-881"><a href="#RegulatedProcess-881"><span class="linenos">881</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="RegulatedProcess-882"><a href="#RegulatedProcess-882"><span class="linenos">882</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="RegulatedProcess-883"><a href="#RegulatedProcess-883"><span class="linenos">883</span></a>
</span><span id="RegulatedProcess-884"><a href="#RegulatedProcess-884"><span class="linenos">884</span></a><span class="sd">        Examples</span>
</span><span id="RegulatedProcess-885"><a href="#RegulatedProcess-885"><span class="linenos">885</span></a><span class="sd">        --------</span>
</span><span id="RegulatedProcess-886"><a href="#RegulatedProcess-886"><span class="linenos">886</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1)</span>
</span><span id="RegulatedProcess-887"><a href="#RegulatedProcess-887"><span class="linenos">887</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;X&#39;, alpha=0.5, K50=[10, 15], nH=2)</span>
</span><span id="RegulatedProcess-888"><a href="#RegulatedProcess-888"><span class="linenos">888</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A + B -&gt; X&quot;, k=0.5, regulating_species=&#39;B, X&#39;, alpha=[2, 0], K50=[(15, 5), [10, 15]], nH=[1, 2])</span>
</span><span id="RegulatedProcess-889"><a href="#RegulatedProcess-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RegulatedProcess-890"><a href="#RegulatedProcess-890"><span class="linenos">890</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="RegulatedProcess-891"><a href="#RegulatedProcess-891"><span class="linenos">891</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="RegulatedProcess-892"><a href="#RegulatedProcess-892"><span class="linenos">892</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="RegulatedProcess-893"><a href="#RegulatedProcess-893"><span class="linenos">893</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="RegulatedProcess-894"><a href="#RegulatedProcess-894"><span class="linenos">894</span></a>
</span><span id="RegulatedProcess-895"><a href="#RegulatedProcess-895"><span class="linenos">895</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="RegulatedProcess-896"><a href="#RegulatedProcess-896"><span class="linenos">896</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="RegulatedProcess-897"><a href="#RegulatedProcess-897"><span class="linenos">897</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="RegulatedProcess-898"><a href="#RegulatedProcess-898"><span class="linenos">898</span></a>
</span><span id="RegulatedProcess-899"><a href="#RegulatedProcess-899"><span class="linenos">899</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="RegulatedProcess-900"><a href="#RegulatedProcess-900"><span class="linenos">900</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="RegulatedProcess-901"><a href="#RegulatedProcess-901"><span class="linenos">901</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedProcess-902"><a href="#RegulatedProcess-902"><span class="linenos">902</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedProcess-903"><a href="#RegulatedProcess-903"><span class="linenos">903</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedProcess-904"><a href="#RegulatedProcess-904"><span class="linenos">904</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedProcess-905"><a href="#RegulatedProcess-905"><span class="linenos">905</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedProcess-906"><a href="#RegulatedProcess-906"><span class="linenos">906</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess-907"><a href="#RegulatedProcess-907"><span class="linenos">907</span></a>
</span><span id="RegulatedProcess-908"><a href="#RegulatedProcess-908"><span class="linenos">908</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedProcess-909"><a href="#RegulatedProcess-909"><span class="linenos">909</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="RegulatedProcess-910"><a href="#RegulatedProcess-910"><span class="linenos">910</span></a>        <span class="n">repr_K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span>
</span><span id="RegulatedProcess-911"><a href="#RegulatedProcess-911"><span class="linenos">911</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;RegulatedProcess Object: &quot;</span> \
</span><span id="RegulatedProcess-912"><a href="#RegulatedProcess-912"><span class="linenos">912</span></a>               <span class="sa">f</span><span class="s2">&quot;RegulatedProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="RegulatedProcess-913"><a href="#RegulatedProcess-913"><span class="linenos">913</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-914"><a href="#RegulatedProcess-914"><span class="linenos">914</span></a>               <span class="sa">f</span><span class="s2">&quot;regulating_species=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="RegulatedProcess-915"><a href="#RegulatedProcess-915"><span class="linenos">915</span></a>               <span class="sa">f</span><span class="s2">&quot;alpha=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-916"><a href="#RegulatedProcess-916"><span class="linenos">916</span></a>               <span class="sa">f</span><span class="s2">&quot;K50=</span><span class="si">{</span><span class="n">repr_K50</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-917"><a href="#RegulatedProcess-917"><span class="linenos">917</span></a>               <span class="sa">f</span><span class="s2">&quot;nH=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">,&quot;</span> \
</span><span id="RegulatedProcess-918"><a href="#RegulatedProcess-918"><span class="linenos">918</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="RegulatedProcess-919"><a href="#RegulatedProcess-919"><span class="linenos">919</span></a>
</span><span id="RegulatedProcess-920"><a href="#RegulatedProcess-920"><span class="linenos">920</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedProcess-921"><a href="#RegulatedProcess-921"><span class="linenos">921</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-922"><a href="#RegulatedProcess-922"><span class="linenos">922</span></a>            <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="RegulatedProcess-923"><a href="#RegulatedProcess-923"><span class="linenos">923</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">):</span>
</span><span id="RegulatedProcess-924"><a href="#RegulatedProcess-924"><span class="linenos">924</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedProcess-925"><a href="#RegulatedProcess-925"><span class="linenos">925</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Homogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50. &quot;</span>
</span><span id="RegulatedProcess-926"><a href="#RegulatedProcess-926"><span class="linenos">926</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-927"><a href="#RegulatedProcess-927"><span class="linenos">927</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 &quot;</span> \
</span><span id="RegulatedProcess-928"><a href="#RegulatedProcess-928"><span class="linenos">928</span></a>                                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2"> distinct subspecies. &quot;</span>
</span><span id="RegulatedProcess-929"><a href="#RegulatedProcess-929"><span class="linenos">929</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-930"><a href="#RegulatedProcess-930"><span class="linenos">930</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed &quot;</span> \
</span><span id="RegulatedProcess-931"><a href="#RegulatedProcess-931"><span class="linenos">931</span></a>                                   <span class="sa">f</span><span class="s2">&quot;species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and &quot;</span> \
</span><span id="RegulatedProcess-932"><a href="#RegulatedProcess-932"><span class="linenos">932</span></a>                                   <span class="sa">f</span><span class="s2">&quot;standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="RegulatedProcess-933"><a href="#RegulatedProcess-933"><span class="linenos">933</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-934"><a href="#RegulatedProcess-934"><span class="linenos">934</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedProcess-935"><a href="#RegulatedProcess-935"><span class="linenos">935</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to K50.&quot;</span>
</span><span id="RegulatedProcess-936"><a href="#RegulatedProcess-936"><span class="linenos">936</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess-937"><a href="#RegulatedProcess-937"><span class="linenos">937</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to K50 &quot;</span> \
</span><span id="RegulatedProcess-938"><a href="#RegulatedProcess-938"><span class="linenos">938</span></a>                              <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="RegulatedProcess-939"><a href="#RegulatedProcess-939"><span class="linenos">939</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-940"><a href="#RegulatedProcess-940"><span class="linenos">940</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed K50 with &quot;</span> \
</span><span id="RegulatedProcess-941"><a href="#RegulatedProcess-941"><span class="linenos">941</span></a>                              <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="RegulatedProcess-942"><a href="#RegulatedProcess-942"><span class="linenos">942</span></a>
</span><span id="RegulatedProcess-943"><a href="#RegulatedProcess-943"><span class="linenos">943</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Regulating Species: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-944"><a href="#RegulatedProcess-944"><span class="linenos">944</span></a>                                   <span class="sa">f</span><span class="s2">&quot;alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess-945"><a href="#RegulatedProcess-945"><span class="linenos">945</span></a>                                   <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">K50_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="RegulatedProcess-946"><a href="#RegulatedProcess-946"><span class="linenos">946</span></a>
</span><span id="RegulatedProcess-947"><a href="#RegulatedProcess-947"><span class="linenos">947</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="RegulatedProcess-948"><a href="#RegulatedProcess-948"><span class="linenos">948</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RegulatedProcess</span><span class="p">):</span>
</span><span id="RegulatedProcess-949"><a href="#RegulatedProcess-949"><span class="linenos">949</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-950"><a href="#RegulatedProcess-950"><span class="linenos">950</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-951"><a href="#RegulatedProcess-951"><span class="linenos">951</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-952"><a href="#RegulatedProcess-952"><span class="linenos">952</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-953"><a href="#RegulatedProcess-953"><span class="linenos">953</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">regulating_species</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-954"><a href="#RegulatedProcess-954"><span class="linenos">954</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-955"><a href="#RegulatedProcess-955"><span class="linenos">955</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">K50</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-956"><a href="#RegulatedProcess-956"><span class="linenos">956</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nH</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-957"><a href="#RegulatedProcess-957"><span class="linenos">957</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="RegulatedProcess-958"><a href="#RegulatedProcess-958"><span class="linenos">958</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess-959"><a href="#RegulatedProcess-959"><span class="linenos">959</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="RegulatedProcess-960"><a href="#RegulatedProcess-960"><span class="linenos">960</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="RegulatedProcess-961"><a href="#RegulatedProcess-961"><span class="linenos">961</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="RegulatedProcess-962"><a href="#RegulatedProcess-962"><span class="linenos">962</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess-963"><a href="#RegulatedProcess-963"><span class="linenos">963</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="RegulatedProcess-964"><a href="#RegulatedProcess-964"><span class="linenos">964</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="RegulatedProcess-965"><a href="#RegulatedProcess-965"><span class="linenos">965</span></a>
</span><span id="RegulatedProcess-966"><a href="#RegulatedProcess-966"><span class="linenos">966</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedProcess-967"><a href="#RegulatedProcess-967"><span class="linenos">967</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Define a process that is regulated.</p>

<p>This class allows a Process to be defined in terms of how it is regulated.
If there is only one regulating species, then the parameters have the same
type as would be expected for a homogeneous/heterogeneous process.
If there are multiple regulating species, then all parameters are a list
of their expected type, with the length of the list being equal to the
number of regulating species.</p>

<p>The class-specific attributes (except for <code><a href="#RegulatedProcess.k">k</a></code>, which requires some
additional notes) are listed below.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the given process. It is the <em>basal</em>
rate constant in the case of activation (or the minimum <code><a href="#RegulatedProcess.k">k</a></code> value)
and the maximum rate constant in the case of repression.</li>
<li><strong>regulating_species</strong> (str or list of str):
Name of the regulating species. Multiple species can be specified as
comma-separated in a string or a list of strings with the species names.</li>
<li><p><strong>alpha</strong> (float or int or list[float or int]):
Parameter denoting the degree of activation/repression.</p>

<pre><code>- 0 &lt;= alpha &lt; 1: repression
- alpha = 1: no regulation
- alpha &gt; 1: activation
</code></pre>

<p>alpha is a multiplier: in the case of activation, the maximum 
rate constant value will be <code>alpha * k</code>. 
In the case of repression, the minimum 
rate constant value will be <code>alpha * k</code>.</p></li>
<li><strong>K50</strong> (float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]):
<em>Microscopic</em> constant that corresponds to the number of
<code>regulating_species</code> agents that would produce 
half-maximal activation/repression. 
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedProcess.K50">K50</a></code>,
using the same rules as for parameter <code><a href="#RegulatedProcess.k">k</a></code>.</li>
<li><strong>nH</strong> (float or int or list[float or int]):
Hill coefficient for the given process. Indicates the degree of 
cooperativity in the regulatory interaction.</li>
<li><strong>is_heterogeneous_K50</strong> (bool or list of bool):
Denotes if the parameter <code><a href="#RegulatedProcess.K50">K50</a></code> exhibits heterogeneity
(distinct subspecies/interactions or normally-distributed).</li>
<li><strong>regulation_type</strong> (str or list of str):
The type of regulation for this process based on the value of alpha:
'activation' or 'repression' or 'no regulation'.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Allowing a 0th order process to be regulated. However, heterogeneity
in <code><a href="#RegulatedProcess.k">k</a></code> and <code><a href="#RegulatedProcess.K50">K50</a></code> (or any other parameters) is not allowed for such
a process.</p>
</div>


                            <div id="RegulatedProcess.__init__" class="classattr">
                                        <input id="RegulatedProcess.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RegulatedProcess</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="RegulatedProcess.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedProcess.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedProcess.__init__-716"><a href="#RegulatedProcess.__init__-716"><span class="linenos">716</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-717"><a href="#RegulatedProcess.__init__-717"><span class="linenos">717</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-718"><a href="#RegulatedProcess.__init__-718"><span class="linenos">718</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-719"><a href="#RegulatedProcess.__init__-719"><span class="linenos">719</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-720"><a href="#RegulatedProcess.__init__-720"><span class="linenos">720</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-721"><a href="#RegulatedProcess.__init__-721"><span class="linenos">721</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-722"><a href="#RegulatedProcess.__init__-722"><span class="linenos">722</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-723"><a href="#RegulatedProcess.__init__-723"><span class="linenos">723</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-724"><a href="#RegulatedProcess.__init__-724"><span class="linenos">724</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedProcess.__init__-725"><a href="#RegulatedProcess.__init__-725"><span class="linenos">725</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="RegulatedProcess.__init__-726"><a href="#RegulatedProcess.__init__-726"><span class="linenos">726</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedProcess.__init__-727"><a href="#RegulatedProcess.__init__-727"><span class="linenos">727</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="RegulatedProcess.__init__-728"><a href="#RegulatedProcess.__init__-728"><span class="linenos">728</span></a>
</span><span id="RegulatedProcess.__init__-729"><a href="#RegulatedProcess.__init__-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="RegulatedProcess.__init__-730"><a href="#RegulatedProcess.__init__-730"><span class="linenos">730</span></a>            <span class="n">reg_sp_list</span> <span class="o">=</span> <span class="n">regulating_species</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="RegulatedProcess.__init__-731"><a href="#RegulatedProcess.__init__-731"><span class="linenos">731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">reg_sp_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reg_sp_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">reg_sp_list</span>
</span><span id="RegulatedProcess.__init__-732"><a href="#RegulatedProcess.__init__-732"><span class="linenos">732</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if it is a list</span>
</span><span id="RegulatedProcess.__init__-733"><a href="#RegulatedProcess.__init__-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">=</span> <span class="n">regulating_species</span>
</span><span id="RegulatedProcess.__init__-734"><a href="#RegulatedProcess.__init__-734"><span class="linenos">734</span></a>
</span><span id="RegulatedProcess.__init__-735"><a href="#RegulatedProcess.__init__-735"><span class="linenos">735</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="RegulatedProcess.__init__-736"><a href="#RegulatedProcess.__init__-736"><span class="linenos">736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">K50</span>
</span><span id="RegulatedProcess.__init__-737"><a href="#RegulatedProcess.__init__-737"><span class="linenos">737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">=</span> <span class="n">nH</span>
</span><span id="RegulatedProcess.__init__-738"><a href="#RegulatedProcess.__init__-738"><span class="linenos">738</span></a>
</span><span id="RegulatedProcess.__init__-739"><a href="#RegulatedProcess.__init__-739"><span class="linenos">739</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess.__init__-740"><a href="#RegulatedProcess.__init__-740"><span class="linenos">740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">val</span>
</span><span id="RegulatedProcess.__init__-741"><a href="#RegulatedProcess.__init__-741"><span class="linenos">741</span></a>                                         <span class="ow">in</span> <span class="n">K50</span><span class="p">]</span>
</span><span id="RegulatedProcess.__init__-742"><a href="#RegulatedProcess.__init__-742"><span class="linenos">742</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess.__init__-743"><a href="#RegulatedProcess.__init__-743"><span class="linenos">743</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_K50</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="RegulatedProcess.__init__-744"><a href="#RegulatedProcess.__init__-744"><span class="linenos">744</span></a>
</span><span id="RegulatedProcess.__init__-745"><a href="#RegulatedProcess.__init__-745"><span class="linenos">745</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-746"><a href="#RegulatedProcess.__init__-746"><span class="linenos">746</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-747"><a href="#RegulatedProcess.__init__-747"><span class="linenos">747</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedProcess.__init__-748"><a href="#RegulatedProcess.__init__-748"><span class="linenos">748</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess.__init__-749"><a href="#RegulatedProcess.__init__-749"><span class="linenos">749</span></a>
</span><span id="RegulatedProcess.__init__-750"><a href="#RegulatedProcess.__init__-750"><span class="linenos">750</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic K50 value</span>
</span><span id="RegulatedProcess.__init__-751"><a href="#RegulatedProcess.__init__-751"><span class="linenos">751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedProcess.__init__-752"><a href="#RegulatedProcess.__init__-752"><span class="linenos">752</span></a>
</span><span id="RegulatedProcess.__init__-753"><a href="#RegulatedProcess.__init__-753"><span class="linenos">753</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, regulating_species = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedProcess.__init__-754"><a href="#RegulatedProcess.__init__-754"><span class="linenos">754</span></a>                     <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="RegulatedProcess.__init__-755"><a href="#RegulatedProcess.__init__-755"><span class="linenos">755</span></a>
</span><span id="RegulatedProcess.__init__-756"><a href="#RegulatedProcess.__init__-756"><span class="linenos">756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="RegulatedProcess.__init__-757"><a href="#RegulatedProcess.__init__-757"><span class="linenos">757</span></a>
</span><span id="RegulatedProcess.__init__-758"><a href="#RegulatedProcess.__init__-758"><span class="linenos">758</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedProcess.__init__-759"><a href="#RegulatedProcess.__init__-759"><span class="linenos">759</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="RegulatedProcess.__init__-760"><a href="#RegulatedProcess.__init__-760"><span class="linenos">760</span></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
</span><span id="RegulatedProcess.__init__-761"><a href="#RegulatedProcess.__init__-761"><span class="linenos">761</span></a>                <span class="n">reg_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span><span id="RegulatedProcess.__init__-762"><a href="#RegulatedProcess.__init__-762"><span class="linenos">762</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg_type</span><span class="p">)</span>
</span><span id="RegulatedProcess.__init__-763"><a href="#RegulatedProcess.__init__-763"><span class="linenos">763</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedProcess.__init__-764"><a href="#RegulatedProcess.__init__-764"><span class="linenos">764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regulation_type</span> <span class="o">=</span> <span class="s1">&#39;activation&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;repression&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;no regulation&#39;</span>
</span></pre></div>


    

                            </div>
                            <div id="RegulatedProcess.alpha" class="classattr">
                                <div class="attr variable">
            <span class="name">alpha</span>

        
    </div>
    <a class="headerlink" href="#RegulatedProcess.alpha"></a>
    
    

                            </div>
                            <div id="RegulatedProcess.K50" class="classattr">
                                <div class="attr variable">
            <span class="name">K50</span>

        
    </div>
    <a class="headerlink" href="#RegulatedProcess.K50"></a>
    
    

                            </div>
                            <div id="RegulatedProcess.nH" class="classattr">
                                <div class="attr variable">
            <span class="name">nH</span>

        
    </div>
    <a class="headerlink" href="#RegulatedProcess.nH"></a>
    
    

                            </div>
                            <div id="RegulatedProcess.from_string" class="classattr">
                                        <input id="RegulatedProcess.from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="RegulatedProcess.from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedProcess.from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedProcess.from_string-816"><a href="#RegulatedProcess.from_string-816"><span class="linenos">816</span></a>    <span class="nd">@classmethod</span>
</span><span id="RegulatedProcess.from_string-817"><a href="#RegulatedProcess.from_string-817"><span class="linenos">817</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-818"><a href="#RegulatedProcess.from_string-818"><span class="linenos">818</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-819"><a href="#RegulatedProcess.from_string-819"><span class="linenos">819</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-820"><a href="#RegulatedProcess.from_string-820"><span class="linenos">820</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedProcess.from_string-821"><a href="#RegulatedProcess.from_string-821"><span class="linenos">821</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-822"><a href="#RegulatedProcess.from_string-822"><span class="linenos">822</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-823"><a href="#RegulatedProcess.from_string-823"><span class="linenos">823</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-824"><a href="#RegulatedProcess.from_string-824"><span class="linenos">824</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedProcess.from_string-825"><a href="#RegulatedProcess.from_string-825"><span class="linenos">825</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedProcess.from_string-826"><a href="#RegulatedProcess.from_string-826"><span class="linenos">826</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-827"><a href="#RegulatedProcess.from_string-827"><span class="linenos">827</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-828"><a href="#RegulatedProcess.from_string-828"><span class="linenos">828</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-829"><a href="#RegulatedProcess.from_string-829"><span class="linenos">829</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="RegulatedProcess.from_string-830"><a href="#RegulatedProcess.from_string-830"><span class="linenos">830</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated process from a string.</span>
</span><span id="RegulatedProcess.from_string-831"><a href="#RegulatedProcess.from_string-831"><span class="linenos">831</span></a>
</span><span id="RegulatedProcess.from_string-832"><a href="#RegulatedProcess.from_string-832"><span class="linenos">832</span></a><span class="sd">        Parameters</span>
</span><span id="RegulatedProcess.from_string-833"><a href="#RegulatedProcess.from_string-833"><span class="linenos">833</span></a><span class="sd">        ----------</span>
</span><span id="RegulatedProcess.from_string-834"><a href="#RegulatedProcess.from_string-834"><span class="linenos">834</span></a><span class="sd">        proc_str : str</span>
</span><span id="RegulatedProcess.from_string-835"><a href="#RegulatedProcess.from_string-835"><span class="linenos">835</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="RegulatedProcess.from_string-836"><a href="#RegulatedProcess.from_string-836"><span class="linenos">836</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="RegulatedProcess.from_string-837"><a href="#RegulatedProcess.from_string-837"><span class="linenos">837</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedProcess.from_string-838"><a href="#RegulatedProcess.from_string-838"><span class="linenos">838</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedProcess.from_string-839"><a href="#RegulatedProcess.from_string-839"><span class="linenos">839</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value) </span>
</span><span id="RegulatedProcess.from_string-840"><a href="#RegulatedProcess.from_string-840"><span class="linenos">840</span></a><span class="sd">            and the maximum rate constant in the case of repression. </span>
</span><span id="RegulatedProcess.from_string-841"><a href="#RegulatedProcess.from_string-841"><span class="linenos">841</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous. </span>
</span><span id="RegulatedProcess.from_string-842"><a href="#RegulatedProcess.from_string-842"><span class="linenos">842</span></a><span class="sd">            If `k` is a list, then the population of the reactants </span>
</span><span id="RegulatedProcess.from_string-843"><a href="#RegulatedProcess.from_string-843"><span class="linenos">843</span></a><span class="sd">            constsists of distinct subspecies or subinteractions </span>
</span><span id="RegulatedProcess.from_string-844"><a href="#RegulatedProcess.from_string-844"><span class="linenos">844</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="RegulatedProcess.from_string-845"><a href="#RegulatedProcess.from_string-845"><span class="linenos">845</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="RegulatedProcess.from_string-846"><a href="#RegulatedProcess.from_string-846"><span class="linenos">846</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="RegulatedProcess.from_string-847"><a href="#RegulatedProcess.from_string-847"><span class="linenos">847</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="RegulatedProcess.from_string-848"><a href="#RegulatedProcess.from_string-848"><span class="linenos">848</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="RegulatedProcess.from_string-849"><a href="#RegulatedProcess.from_string-849"><span class="linenos">849</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="RegulatedProcess.from_string-850"><a href="#RegulatedProcess.from_string-850"><span class="linenos">850</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="RegulatedProcess.from_string-851"><a href="#RegulatedProcess.from_string-851"><span class="linenos">851</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedProcess.from_string-852"><a href="#RegulatedProcess.from_string-852"><span class="linenos">852</span></a>
</span><span id="RegulatedProcess.from_string-853"><a href="#RegulatedProcess.from_string-853"><span class="linenos">853</span></a><span class="sd">                - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedProcess.from_string-854"><a href="#RegulatedProcess.from_string-854"><span class="linenos">854</span></a><span class="sd">                - alpha = 1: no regulation</span>
</span><span id="RegulatedProcess.from_string-855"><a href="#RegulatedProcess.from_string-855"><span class="linenos">855</span></a><span class="sd">                - alpha &gt; 1: activation</span>
</span><span id="RegulatedProcess.from_string-856"><a href="#RegulatedProcess.from_string-856"><span class="linenos">856</span></a><span class="sd">                </span>
</span><span id="RegulatedProcess.from_string-857"><a href="#RegulatedProcess.from_string-857"><span class="linenos">857</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum </span>
</span><span id="RegulatedProcess.from_string-858"><a href="#RegulatedProcess.from_string-858"><span class="linenos">858</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess.from_string-859"><a href="#RegulatedProcess.from_string-859"><span class="linenos">859</span></a><span class="sd">            In the case of repression, the minimum </span>
</span><span id="RegulatedProcess.from_string-860"><a href="#RegulatedProcess.from_string-860"><span class="linenos">860</span></a><span class="sd">            rate constant value will be `alpha * k`. </span>
</span><span id="RegulatedProcess.from_string-861"><a href="#RegulatedProcess.from_string-861"><span class="linenos">861</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="RegulatedProcess.from_string-862"><a href="#RegulatedProcess.from_string-862"><span class="linenos">862</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedProcess.from_string-863"><a href="#RegulatedProcess.from_string-863"><span class="linenos">863</span></a><span class="sd">            `regulating_species` agents that would produce </span>
</span><span id="RegulatedProcess.from_string-864"><a href="#RegulatedProcess.from_string-864"><span class="linenos">864</span></a><span class="sd">            half-maximal activation/repression. </span>
</span><span id="RegulatedProcess.from_string-865"><a href="#RegulatedProcess.from_string-865"><span class="linenos">865</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedProcess.from_string-866"><a href="#RegulatedProcess.from_string-866"><span class="linenos">866</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedProcess.from_string-867"><a href="#RegulatedProcess.from_string-867"><span class="linenos">867</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="RegulatedProcess.from_string-868"><a href="#RegulatedProcess.from_string-868"><span class="linenos">868</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of </span>
</span><span id="RegulatedProcess.from_string-869"><a href="#RegulatedProcess.from_string-869"><span class="linenos">869</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="RegulatedProcess.from_string-870"><a href="#RegulatedProcess.from_string-870"><span class="linenos">870</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="RegulatedProcess.from_string-871"><a href="#RegulatedProcess.from_string-871"><span class="linenos">871</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="RegulatedProcess.from_string-872"><a href="#RegulatedProcess.from_string-872"><span class="linenos">872</span></a><span class="sd">            are taking place.</span>
</span><span id="RegulatedProcess.from_string-873"><a href="#RegulatedProcess.from_string-873"><span class="linenos">873</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="RegulatedProcess.from_string-874"><a href="#RegulatedProcess.from_string-874"><span class="linenos">874</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="RegulatedProcess.from_string-875"><a href="#RegulatedProcess.from_string-875"><span class="linenos">875</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="RegulatedProcess.from_string-876"><a href="#RegulatedProcess.from_string-876"><span class="linenos">876</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="RegulatedProcess.from_string-877"><a href="#RegulatedProcess.from_string-877"><span class="linenos">877</span></a>
</span><span id="RegulatedProcess.from_string-878"><a href="#RegulatedProcess.from_string-878"><span class="linenos">878</span></a><span class="sd">        Notes</span>
</span><span id="RegulatedProcess.from_string-879"><a href="#RegulatedProcess.from_string-879"><span class="linenos">879</span></a><span class="sd">        -----</span>
</span><span id="RegulatedProcess.from_string-880"><a href="#RegulatedProcess.from_string-880"><span class="linenos">880</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="RegulatedProcess.from_string-881"><a href="#RegulatedProcess.from_string-881"><span class="linenos">881</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="RegulatedProcess.from_string-882"><a href="#RegulatedProcess.from_string-882"><span class="linenos">882</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="RegulatedProcess.from_string-883"><a href="#RegulatedProcess.from_string-883"><span class="linenos">883</span></a>
</span><span id="RegulatedProcess.from_string-884"><a href="#RegulatedProcess.from_string-884"><span class="linenos">884</span></a><span class="sd">        Examples</span>
</span><span id="RegulatedProcess.from_string-885"><a href="#RegulatedProcess.from_string-885"><span class="linenos">885</span></a><span class="sd">        --------</span>
</span><span id="RegulatedProcess.from_string-886"><a href="#RegulatedProcess.from_string-886"><span class="linenos">886</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1)</span>
</span><span id="RegulatedProcess.from_string-887"><a href="#RegulatedProcess.from_string-887"><span class="linenos">887</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;X&#39;, alpha=0.5, K50=[10, 15], nH=2)</span>
</span><span id="RegulatedProcess.from_string-888"><a href="#RegulatedProcess.from_string-888"><span class="linenos">888</span></a><span class="sd">        &gt;&gt;&gt; RegulatedProcess.from_string(&quot;A + B -&gt; X&quot;, k=0.5, regulating_species=&#39;B, X&#39;, alpha=[2, 0], K50=[(15, 5), [10, 15]], nH=[1, 2])</span>
</span><span id="RegulatedProcess.from_string-889"><a href="#RegulatedProcess.from_string-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RegulatedProcess.from_string-890"><a href="#RegulatedProcess.from_string-890"><span class="linenos">890</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="RegulatedProcess.from_string-891"><a href="#RegulatedProcess.from_string-891"><span class="linenos">891</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="RegulatedProcess.from_string-892"><a href="#RegulatedProcess.from_string-892"><span class="linenos">892</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="RegulatedProcess.from_string-893"><a href="#RegulatedProcess.from_string-893"><span class="linenos">893</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="RegulatedProcess.from_string-894"><a href="#RegulatedProcess.from_string-894"><span class="linenos">894</span></a>
</span><span id="RegulatedProcess.from_string-895"><a href="#RegulatedProcess.from_string-895"><span class="linenos">895</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="RegulatedProcess.from_string-896"><a href="#RegulatedProcess.from_string-896"><span class="linenos">896</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="RegulatedProcess.from_string-897"><a href="#RegulatedProcess.from_string-897"><span class="linenos">897</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="RegulatedProcess.from_string-898"><a href="#RegulatedProcess.from_string-898"><span class="linenos">898</span></a>
</span><span id="RegulatedProcess.from_string-899"><a href="#RegulatedProcess.from_string-899"><span class="linenos">899</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="RegulatedProcess.from_string-900"><a href="#RegulatedProcess.from_string-900"><span class="linenos">900</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="RegulatedProcess.from_string-901"><a href="#RegulatedProcess.from_string-901"><span class="linenos">901</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-902"><a href="#RegulatedProcess.from_string-902"><span class="linenos">902</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-903"><a href="#RegulatedProcess.from_string-903"><span class="linenos">903</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-904"><a href="#RegulatedProcess.from_string-904"><span class="linenos">904</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-905"><a href="#RegulatedProcess.from_string-905"><span class="linenos">905</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedProcess.from_string-906"><a href="#RegulatedProcess.from_string-906"><span class="linenos">906</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a regulated process from a string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proc_str</strong> (str):
A string describing the process in standard chemical notation
(e.g., 'A + B -> C')</li>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the given process. It is the <em>basal</em>
rate constant in the case of activation (or the minimum <code><a href="#RegulatedProcess.k">k</a></code> value) 
and the maximum rate constant in the case of repression. 
If <code><a href="#RegulatedProcess.k">k</a></code> is a float or int, then the process is homogeneous. 
If <code><a href="#RegulatedProcess.k">k</a></code> is a list, then the population of the reactants 
constsists of distinct subspecies or subinteractions 
depending on the order. If <code><a href="#RegulatedProcess.k">k</a></code> is a 2-tuple,
then the constant is normally-distributed with a mean and standard
deviation specified in the tuple's elements. Note that <code><a href="#RegulatedProcess.k">k</a></code> cannot
be zero for this form of regulation.</li>
<li><strong>regulating_species</strong> (str or list of str):
Name of the regulating species.</li>
<li><p><strong>alpha</strong> (float or int or list[float or int]):
Parameter denoting the degree of activation/repression.</p>

<pre><code>- 0 &lt;= alpha &lt; 1: repression
- alpha = 1: no regulation
- alpha &gt; 1: activation
</code></pre>

<p>alpha is a multiplier: in the case of activation, the maximum 
rate constant value will be <code>alpha * k</code>. 
In the case of repression, the minimum 
rate constant value will be <code>alpha * k</code>.</p></li>
<li><strong>K50</strong> (float or int or list of floats or 2-tuple of floats or list of each of the previous types):
<em>Microscopic</em> constant that corresponds to the number of
<code>regulating_species</code> agents that would produce 
half-maximal activation/repression. 
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedProcess.K50">K50</a></code>,
using the same rules as for parameter <code><a href="#RegulatedProcess.k">k</a></code>.</li>
<li><strong>nH</strong> (float or int or list[float or int]):
Hill coefficient for the given process. Indicates the degree of 
cooperativity in the regulatory interaction.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>sep : str, default</strong> ('->'):
Specifies the characters that distinguish the reactants from the
products. The default is '->'. The code also treats <code>--&gt;</code> as a
default, if it's present in <code>proc_str</code>.</li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>Species names should not contain spaces, dashes, and
should start with a non-numeric character.</li>
<li>Zeroth order processes should be specified by an empty space or 'None'.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#RegulatedProcess.from_string">RegulatedProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">regulating_species</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">K50</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nH</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#RegulatedProcess.from_string">RegulatedProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">regulating_species</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">K50</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">nH</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#RegulatedProcess.from_string">RegulatedProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A + B -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">regulating_species</span><span class="o">=</span><span class="s1">&#39;B, X&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">K50</span><span class="o">=</span><span class="p">[(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]],</span> <span class="n">nH</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Process">Process</a></dt>
                                <dd id="RegulatedProcess.reactants" class="variable"><a href="#Process.reactants">reactants</a></dd>
                <dd id="RegulatedProcess.products" class="variable"><a href="#Process.products">products</a></dd>
                <dd id="RegulatedProcess.k" class="variable"><a href="#Process.k">k</a></dd>
                <dd id="RegulatedProcess.volume" class="variable"><a href="#Process.volume">volume</a></dd>
                <dd id="RegulatedProcess.order" class="variable"><a href="#Process.order">order</a></dd>
                <dd id="RegulatedProcess.is_heterogeneous" class="variable"><a href="#Process.is_heterogeneous">is_heterogeneous</a></dd>
                <dd id="RegulatedProcess.species" class="variable"><a href="#Process.species">species</a></dd>
                <dd id="RegulatedProcess.reacts_" class="variable"><a href="#Process.reacts_">reacts_</a></dd>
                <dd id="RegulatedProcess.prods_" class="variable"><a href="#Process.prods_">prods_</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RegulatedMichaelisMentenProcess">
                            <input id="RegulatedMichaelisMentenProcess-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RegulatedMichaelisMentenProcess</span><wbr>(<span class="base"><a href="#RegulatedProcess">RegulatedProcess</a></span>):

                <label class="view-source-button" for="RegulatedMichaelisMentenProcess-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedMichaelisMentenProcess-970"><a href="#RegulatedMichaelisMentenProcess-970"><span class="linenos"> 970</span></a><span class="k">class</span> <span class="nc">RegulatedMichaelisMentenProcess</span><span class="p">(</span><span class="n">RegulatedProcess</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-971"><a href="#RegulatedMichaelisMentenProcess-971"><span class="linenos"> 971</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a process that is regulated and obeys Michaelis-Menten kinetics.</span>
</span><span id="RegulatedMichaelisMentenProcess-972"><a href="#RegulatedMichaelisMentenProcess-972"><span class="linenos"> 972</span></a>
</span><span id="RegulatedMichaelisMentenProcess-973"><a href="#RegulatedMichaelisMentenProcess-973"><span class="linenos"> 973</span></a><span class="sd">    This class allows a Michaelis-Menten Process to be defined</span>
</span><span id="RegulatedMichaelisMentenProcess-974"><a href="#RegulatedMichaelisMentenProcess-974"><span class="linenos"> 974</span></a><span class="sd">    in terms of how it is regulated.</span>
</span><span id="RegulatedMichaelisMentenProcess-975"><a href="#RegulatedMichaelisMentenProcess-975"><span class="linenos"> 975</span></a><span class="sd">    If there is only one regulating species, then the parameters have the same</span>
</span><span id="RegulatedMichaelisMentenProcess-976"><a href="#RegulatedMichaelisMentenProcess-976"><span class="linenos"> 976</span></a><span class="sd">    type as would be expected for a homogeneous/heterogeneous process.</span>
</span><span id="RegulatedMichaelisMentenProcess-977"><a href="#RegulatedMichaelisMentenProcess-977"><span class="linenos"> 977</span></a><span class="sd">    If there are multiple regulating species, then all parameters are a list</span>
</span><span id="RegulatedMichaelisMentenProcess-978"><a href="#RegulatedMichaelisMentenProcess-978"><span class="linenos"> 978</span></a><span class="sd">    of their expected type, with the length of the list being equal to the</span>
</span><span id="RegulatedMichaelisMentenProcess-979"><a href="#RegulatedMichaelisMentenProcess-979"><span class="linenos"> 979</span></a><span class="sd">    number of regulating species.</span>
</span><span id="RegulatedMichaelisMentenProcess-980"><a href="#RegulatedMichaelisMentenProcess-980"><span class="linenos"> 980</span></a>
</span><span id="RegulatedMichaelisMentenProcess-981"><a href="#RegulatedMichaelisMentenProcess-981"><span class="linenos"> 981</span></a><span class="sd">    The class-specific attributes (except for `k`, which requires some</span>
</span><span id="RegulatedMichaelisMentenProcess-982"><a href="#RegulatedMichaelisMentenProcess-982"><span class="linenos"> 982</span></a><span class="sd">    additional notes) are listed below.</span>
</span><span id="RegulatedMichaelisMentenProcess-983"><a href="#RegulatedMichaelisMentenProcess-983"><span class="linenos"> 983</span></a>
</span><span id="RegulatedMichaelisMentenProcess-984"><a href="#RegulatedMichaelisMentenProcess-984"><span class="linenos"> 984</span></a><span class="sd">    Attributes</span>
</span><span id="RegulatedMichaelisMentenProcess-985"><a href="#RegulatedMichaelisMentenProcess-985"><span class="linenos"> 985</span></a><span class="sd">    ----------</span>
</span><span id="RegulatedMichaelisMentenProcess-986"><a href="#RegulatedMichaelisMentenProcess-986"><span class="linenos"> 986</span></a><span class="sd">    k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess-987"><a href="#RegulatedMichaelisMentenProcess-987"><span class="linenos"> 987</span></a><span class="sd">        The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedMichaelisMentenProcess-988"><a href="#RegulatedMichaelisMentenProcess-988"><span class="linenos"> 988</span></a><span class="sd">        rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="RegulatedMichaelisMentenProcess-989"><a href="#RegulatedMichaelisMentenProcess-989"><span class="linenos"> 989</span></a><span class="sd">        and the maximum rate constant in the case of repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-990"><a href="#RegulatedMichaelisMentenProcess-990"><span class="linenos"> 990</span></a><span class="sd">    regulating_species : str or list of str</span>
</span><span id="RegulatedMichaelisMentenProcess-991"><a href="#RegulatedMichaelisMentenProcess-991"><span class="linenos"> 991</span></a><span class="sd">        Name of the regulating species. Multiple species can be specified as</span>
</span><span id="RegulatedMichaelisMentenProcess-992"><a href="#RegulatedMichaelisMentenProcess-992"><span class="linenos"> 992</span></a><span class="sd">        comma-separated in a string or a list of strings with the species names.</span>
</span><span id="RegulatedMichaelisMentenProcess-993"><a href="#RegulatedMichaelisMentenProcess-993"><span class="linenos"> 993</span></a><span class="sd">    alpha : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess-994"><a href="#RegulatedMichaelisMentenProcess-994"><span class="linenos"> 994</span></a><span class="sd">        Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-995"><a href="#RegulatedMichaelisMentenProcess-995"><span class="linenos"> 995</span></a>
</span><span id="RegulatedMichaelisMentenProcess-996"><a href="#RegulatedMichaelisMentenProcess-996"><span class="linenos"> 996</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedMichaelisMentenProcess-997"><a href="#RegulatedMichaelisMentenProcess-997"><span class="linenos"> 997</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="RegulatedMichaelisMentenProcess-998"><a href="#RegulatedMichaelisMentenProcess-998"><span class="linenos"> 998</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="RegulatedMichaelisMentenProcess-999"><a href="#RegulatedMichaelisMentenProcess-999"><span class="linenos"> 999</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1000"><a href="#RegulatedMichaelisMentenProcess-1000"><span class="linenos">1000</span></a><span class="sd">        alpha is a multiplier: in the case of activation, the maximum</span>
</span><span id="RegulatedMichaelisMentenProcess-1001"><a href="#RegulatedMichaelisMentenProcess-1001"><span class="linenos">1001</span></a><span class="sd">        rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1002"><a href="#RegulatedMichaelisMentenProcess-1002"><span class="linenos">1002</span></a><span class="sd">        In the case of repression, the minimum</span>
</span><span id="RegulatedMichaelisMentenProcess-1003"><a href="#RegulatedMichaelisMentenProcess-1003"><span class="linenos">1003</span></a><span class="sd">        rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1004"><a href="#RegulatedMichaelisMentenProcess-1004"><span class="linenos">1004</span></a><span class="sd">    K50 : float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]</span>
</span><span id="RegulatedMichaelisMentenProcess-1005"><a href="#RegulatedMichaelisMentenProcess-1005"><span class="linenos">1005</span></a><span class="sd">        *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedMichaelisMentenProcess-1006"><a href="#RegulatedMichaelisMentenProcess-1006"><span class="linenos">1006</span></a><span class="sd">        `regulating_species` agents that would produce</span>
</span><span id="RegulatedMichaelisMentenProcess-1007"><a href="#RegulatedMichaelisMentenProcess-1007"><span class="linenos">1007</span></a><span class="sd">        half-maximal activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-1008"><a href="#RegulatedMichaelisMentenProcess-1008"><span class="linenos">1008</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedMichaelisMentenProcess-1009"><a href="#RegulatedMichaelisMentenProcess-1009"><span class="linenos">1009</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1010"><a href="#RegulatedMichaelisMentenProcess-1010"><span class="linenos">1010</span></a><span class="sd">    nH : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess-1011"><a href="#RegulatedMichaelisMentenProcess-1011"><span class="linenos">1011</span></a><span class="sd">        Hill coefficient for the given process. Indicates the degree of</span>
</span><span id="RegulatedMichaelisMentenProcess-1012"><a href="#RegulatedMichaelisMentenProcess-1012"><span class="linenos">1012</span></a><span class="sd">        cooperativity in the regulatory interaction.</span>
</span><span id="RegulatedMichaelisMentenProcess-1013"><a href="#RegulatedMichaelisMentenProcess-1013"><span class="linenos">1013</span></a><span class="sd">    is_heterogeneous_K50 : bool or list of bool</span>
</span><span id="RegulatedMichaelisMentenProcess-1014"><a href="#RegulatedMichaelisMentenProcess-1014"><span class="linenos">1014</span></a><span class="sd">        Denotes if the parameter `K50` exhibits heterogeneity</span>
</span><span id="RegulatedMichaelisMentenProcess-1015"><a href="#RegulatedMichaelisMentenProcess-1015"><span class="linenos">1015</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="RegulatedMichaelisMentenProcess-1016"><a href="#RegulatedMichaelisMentenProcess-1016"><span class="linenos">1016</span></a><span class="sd">    regulation_type : str or list of str</span>
</span><span id="RegulatedMichaelisMentenProcess-1017"><a href="#RegulatedMichaelisMentenProcess-1017"><span class="linenos">1017</span></a><span class="sd">        The type of regulation for this process based on the value of alpha:</span>
</span><span id="RegulatedMichaelisMentenProcess-1018"><a href="#RegulatedMichaelisMentenProcess-1018"><span class="linenos">1018</span></a><span class="sd">        &#39;activation&#39; or &#39;repression&#39; or &#39;no regulation&#39;.</span>
</span><span id="RegulatedMichaelisMentenProcess-1019"><a href="#RegulatedMichaelisMentenProcess-1019"><span class="linenos">1019</span></a><span class="sd">    catalyst : str</span>
</span><span id="RegulatedMichaelisMentenProcess-1020"><a href="#RegulatedMichaelisMentenProcess-1020"><span class="linenos">1020</span></a><span class="sd">        Name of the species acting as a catalyst for this process.</span>
</span><span id="RegulatedMichaelisMentenProcess-1021"><a href="#RegulatedMichaelisMentenProcess-1021"><span class="linenos">1021</span></a><span class="sd">    Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess-1022"><a href="#RegulatedMichaelisMentenProcess-1022"><span class="linenos">1022</span></a><span class="sd">        *Microscopic* Michaelis constant. Corresponds to the number</span>
</span><span id="RegulatedMichaelisMentenProcess-1023"><a href="#RegulatedMichaelisMentenProcess-1023"><span class="linenos">1023</span></a><span class="sd">        of `catalyst` agents that would produce half-maximal activity.</span>
</span><span id="RegulatedMichaelisMentenProcess-1024"><a href="#RegulatedMichaelisMentenProcess-1024"><span class="linenos">1024</span></a><span class="sd">        Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedMichaelisMentenProcess-1025"><a href="#RegulatedMichaelisMentenProcess-1025"><span class="linenos">1025</span></a><span class="sd">        using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1026"><a href="#RegulatedMichaelisMentenProcess-1026"><span class="linenos">1026</span></a><span class="sd">    is_heterogeneous_Km : bool</span>
</span><span id="RegulatedMichaelisMentenProcess-1027"><a href="#RegulatedMichaelisMentenProcess-1027"><span class="linenos">1027</span></a><span class="sd">        Denotes if the parameter `Km` exhibits heterogeneity</span>
</span><span id="RegulatedMichaelisMentenProcess-1028"><a href="#RegulatedMichaelisMentenProcess-1028"><span class="linenos">1028</span></a><span class="sd">        (distinct subspecies/interactions or normally-distributed).</span>
</span><span id="RegulatedMichaelisMentenProcess-1029"><a href="#RegulatedMichaelisMentenProcess-1029"><span class="linenos">1029</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1030"><a href="#RegulatedMichaelisMentenProcess-1030"><span class="linenos">1030</span></a><span class="sd">    Notes</span>
</span><span id="RegulatedMichaelisMentenProcess-1031"><a href="#RegulatedMichaelisMentenProcess-1031"><span class="linenos">1031</span></a><span class="sd">    -----</span>
</span><span id="RegulatedMichaelisMentenProcess-1032"><a href="#RegulatedMichaelisMentenProcess-1032"><span class="linenos">1032</span></a><span class="sd">    Currently only implemented for 1st order processes. 0th order processes</span>
</span><span id="RegulatedMichaelisMentenProcess-1033"><a href="#RegulatedMichaelisMentenProcess-1033"><span class="linenos">1033</span></a><span class="sd">    cannot obey Michaelis-Menten kinetics and 2nd order Michaelis-Menten</span>
</span><span id="RegulatedMichaelisMentenProcess-1034"><a href="#RegulatedMichaelisMentenProcess-1034"><span class="linenos">1034</span></a><span class="sd">    processes are not implemented yet.</span>
</span><span id="RegulatedMichaelisMentenProcess-1035"><a href="#RegulatedMichaelisMentenProcess-1035"><span class="linenos">1035</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1036"><a href="#RegulatedMichaelisMentenProcess-1036"><span class="linenos">1036</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1037"><a href="#RegulatedMichaelisMentenProcess-1037"><span class="linenos">1037</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1038"><a href="#RegulatedMichaelisMentenProcess-1038"><span class="linenos">1038</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1039"><a href="#RegulatedMichaelisMentenProcess-1039"><span class="linenos">1039</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1040"><a href="#RegulatedMichaelisMentenProcess-1040"><span class="linenos">1040</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1041"><a href="#RegulatedMichaelisMentenProcess-1041"><span class="linenos">1041</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1042"><a href="#RegulatedMichaelisMentenProcess-1042"><span class="linenos">1042</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1043"><a href="#RegulatedMichaelisMentenProcess-1043"><span class="linenos">1043</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1044"><a href="#RegulatedMichaelisMentenProcess-1044"><span class="linenos">1044</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1045"><a href="#RegulatedMichaelisMentenProcess-1045"><span class="linenos">1045</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedMichaelisMentenProcess-1046"><a href="#RegulatedMichaelisMentenProcess-1046"><span class="linenos">1046</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="RegulatedMichaelisMentenProcess-1047"><a href="#RegulatedMichaelisMentenProcess-1047"><span class="linenos">1047</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1048"><a href="#RegulatedMichaelisMentenProcess-1048"><span class="linenos">1048</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1049"><a href="#RegulatedMichaelisMentenProcess-1049"><span class="linenos">1049</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1050"><a href="#RegulatedMichaelisMentenProcess-1050"><span class="linenos">1050</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1051"><a href="#RegulatedMichaelisMentenProcess-1051"><span class="linenos">1051</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1052"><a href="#RegulatedMichaelisMentenProcess-1052"><span class="linenos">1052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="RegulatedMichaelisMentenProcess-1053"><a href="#RegulatedMichaelisMentenProcess-1053"><span class="linenos">1053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="RegulatedMichaelisMentenProcess-1054"><a href="#RegulatedMichaelisMentenProcess-1054"><span class="linenos">1054</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="RegulatedMichaelisMentenProcess-1055"><a href="#RegulatedMichaelisMentenProcess-1055"><span class="linenos">1055</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1056"><a href="#RegulatedMichaelisMentenProcess-1056"><span class="linenos">1056</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1057"><a href="#RegulatedMichaelisMentenProcess-1057"><span class="linenos">1057</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1058"><a href="#RegulatedMichaelisMentenProcess-1058"><span class="linenos">1058</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1059"><a href="#RegulatedMichaelisMentenProcess-1059"><span class="linenos">1059</span></a>                         <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1060"><a href="#RegulatedMichaelisMentenProcess-1060"><span class="linenos">1060</span></a>                         <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1061"><a href="#RegulatedMichaelisMentenProcess-1061"><span class="linenos">1061</span></a>                         <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1062"><a href="#RegulatedMichaelisMentenProcess-1062"><span class="linenos">1062</span></a>                         <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1063"><a href="#RegulatedMichaelisMentenProcess-1063"><span class="linenos">1063</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1064"><a href="#RegulatedMichaelisMentenProcess-1064"><span class="linenos">1064</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1065"><a href="#RegulatedMichaelisMentenProcess-1065"><span class="linenos">1065</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="RegulatedMichaelisMentenProcess-1066"><a href="#RegulatedMichaelisMentenProcess-1066"><span class="linenos">1066</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1067"><a href="#RegulatedMichaelisMentenProcess-1067"><span class="linenos">1067</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1068"><a href="#RegulatedMichaelisMentenProcess-1068"><span class="linenos">1068</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1069"><a href="#RegulatedMichaelisMentenProcess-1069"><span class="linenos">1069</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1070"><a href="#RegulatedMichaelisMentenProcess-1070"><span class="linenos">1070</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="RegulatedMichaelisMentenProcess-1071"><a href="#RegulatedMichaelisMentenProcess-1071"><span class="linenos">1071</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1072"><a href="#RegulatedMichaelisMentenProcess-1072"><span class="linenos">1072</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="RegulatedMichaelisMentenProcess-1073"><a href="#RegulatedMichaelisMentenProcess-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1074"><a href="#RegulatedMichaelisMentenProcess-1074"><span class="linenos">1074</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1075"><a href="#RegulatedMichaelisMentenProcess-1075"><span class="linenos">1075</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1076"><a href="#RegulatedMichaelisMentenProcess-1076"><span class="linenos">1076</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1077"><a href="#RegulatedMichaelisMentenProcess-1077"><span class="linenos">1077</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1078"><a href="#RegulatedMichaelisMentenProcess-1078"><span class="linenos">1078</span></a>    <span class="nd">@classmethod</span>
</span><span id="RegulatedMichaelisMentenProcess-1079"><a href="#RegulatedMichaelisMentenProcess-1079"><span class="linenos">1079</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1080"><a href="#RegulatedMichaelisMentenProcess-1080"><span class="linenos">1080</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1081"><a href="#RegulatedMichaelisMentenProcess-1081"><span class="linenos">1081</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1082"><a href="#RegulatedMichaelisMentenProcess-1082"><span class="linenos">1082</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess-1083"><a href="#RegulatedMichaelisMentenProcess-1083"><span class="linenos">1083</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1084"><a href="#RegulatedMichaelisMentenProcess-1084"><span class="linenos">1084</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1085"><a href="#RegulatedMichaelisMentenProcess-1085"><span class="linenos">1085</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1086"><a href="#RegulatedMichaelisMentenProcess-1086"><span class="linenos">1086</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedMichaelisMentenProcess-1087"><a href="#RegulatedMichaelisMentenProcess-1087"><span class="linenos">1087</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedMichaelisMentenProcess-1088"><a href="#RegulatedMichaelisMentenProcess-1088"><span class="linenos">1088</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1089"><a href="#RegulatedMichaelisMentenProcess-1089"><span class="linenos">1089</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1090"><a href="#RegulatedMichaelisMentenProcess-1090"><span class="linenos">1090</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1091"><a href="#RegulatedMichaelisMentenProcess-1091"><span class="linenos">1091</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedMichaelisMentenProcess-1092"><a href="#RegulatedMichaelisMentenProcess-1092"><span class="linenos">1092</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1093"><a href="#RegulatedMichaelisMentenProcess-1093"><span class="linenos">1093</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1094"><a href="#RegulatedMichaelisMentenProcess-1094"><span class="linenos">1094</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1095"><a href="#RegulatedMichaelisMentenProcess-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated Michaelis-Menten process from a string.</span>
</span><span id="RegulatedMichaelisMentenProcess-1096"><a href="#RegulatedMichaelisMentenProcess-1096"><span class="linenos">1096</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1097"><a href="#RegulatedMichaelisMentenProcess-1097"><span class="linenos">1097</span></a><span class="sd">        Parameters</span>
</span><span id="RegulatedMichaelisMentenProcess-1098"><a href="#RegulatedMichaelisMentenProcess-1098"><span class="linenos">1098</span></a><span class="sd">        ----------</span>
</span><span id="RegulatedMichaelisMentenProcess-1099"><a href="#RegulatedMichaelisMentenProcess-1099"><span class="linenos">1099</span></a><span class="sd">        proc_str : str</span>
</span><span id="RegulatedMichaelisMentenProcess-1100"><a href="#RegulatedMichaelisMentenProcess-1100"><span class="linenos">1100</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="RegulatedMichaelisMentenProcess-1101"><a href="#RegulatedMichaelisMentenProcess-1101"><span class="linenos">1101</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="RegulatedMichaelisMentenProcess-1102"><a href="#RegulatedMichaelisMentenProcess-1102"><span class="linenos">1102</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess-1103"><a href="#RegulatedMichaelisMentenProcess-1103"><span class="linenos">1103</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedMichaelisMentenProcess-1104"><a href="#RegulatedMichaelisMentenProcess-1104"><span class="linenos">1104</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="RegulatedMichaelisMentenProcess-1105"><a href="#RegulatedMichaelisMentenProcess-1105"><span class="linenos">1105</span></a><span class="sd">            and the maximum rate constant in the case of repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-1106"><a href="#RegulatedMichaelisMentenProcess-1106"><span class="linenos">1106</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous.</span>
</span><span id="RegulatedMichaelisMentenProcess-1107"><a href="#RegulatedMichaelisMentenProcess-1107"><span class="linenos">1107</span></a><span class="sd">            If `k` is a list, then the population of the reactants</span>
</span><span id="RegulatedMichaelisMentenProcess-1108"><a href="#RegulatedMichaelisMentenProcess-1108"><span class="linenos">1108</span></a><span class="sd">            constsists of distinct subspecies or subinteractions</span>
</span><span id="RegulatedMichaelisMentenProcess-1109"><a href="#RegulatedMichaelisMentenProcess-1109"><span class="linenos">1109</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="RegulatedMichaelisMentenProcess-1110"><a href="#RegulatedMichaelisMentenProcess-1110"><span class="linenos">1110</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="RegulatedMichaelisMentenProcess-1111"><a href="#RegulatedMichaelisMentenProcess-1111"><span class="linenos">1111</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="RegulatedMichaelisMentenProcess-1112"><a href="#RegulatedMichaelisMentenProcess-1112"><span class="linenos">1112</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="RegulatedMichaelisMentenProcess-1113"><a href="#RegulatedMichaelisMentenProcess-1113"><span class="linenos">1113</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="RegulatedMichaelisMentenProcess-1114"><a href="#RegulatedMichaelisMentenProcess-1114"><span class="linenos">1114</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="RegulatedMichaelisMentenProcess-1115"><a href="#RegulatedMichaelisMentenProcess-1115"><span class="linenos">1115</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess-1116"><a href="#RegulatedMichaelisMentenProcess-1116"><span class="linenos">1116</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-1117"><a href="#RegulatedMichaelisMentenProcess-1117"><span class="linenos">1117</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1118"><a href="#RegulatedMichaelisMentenProcess-1118"><span class="linenos">1118</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedMichaelisMentenProcess-1119"><a href="#RegulatedMichaelisMentenProcess-1119"><span class="linenos">1119</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="RegulatedMichaelisMentenProcess-1120"><a href="#RegulatedMichaelisMentenProcess-1120"><span class="linenos">1120</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="RegulatedMichaelisMentenProcess-1121"><a href="#RegulatedMichaelisMentenProcess-1121"><span class="linenos">1121</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1122"><a href="#RegulatedMichaelisMentenProcess-1122"><span class="linenos">1122</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum</span>
</span><span id="RegulatedMichaelisMentenProcess-1123"><a href="#RegulatedMichaelisMentenProcess-1123"><span class="linenos">1123</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1124"><a href="#RegulatedMichaelisMentenProcess-1124"><span class="linenos">1124</span></a><span class="sd">            In the case of repression, the minimum</span>
</span><span id="RegulatedMichaelisMentenProcess-1125"><a href="#RegulatedMichaelisMentenProcess-1125"><span class="linenos">1125</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1126"><a href="#RegulatedMichaelisMentenProcess-1126"><span class="linenos">1126</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="RegulatedMichaelisMentenProcess-1127"><a href="#RegulatedMichaelisMentenProcess-1127"><span class="linenos">1127</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedMichaelisMentenProcess-1128"><a href="#RegulatedMichaelisMentenProcess-1128"><span class="linenos">1128</span></a><span class="sd">            `regulating_species` agents that would produce</span>
</span><span id="RegulatedMichaelisMentenProcess-1129"><a href="#RegulatedMichaelisMentenProcess-1129"><span class="linenos">1129</span></a><span class="sd">            half-maximal activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess-1130"><a href="#RegulatedMichaelisMentenProcess-1130"><span class="linenos">1130</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedMichaelisMentenProcess-1131"><a href="#RegulatedMichaelisMentenProcess-1131"><span class="linenos">1131</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1132"><a href="#RegulatedMichaelisMentenProcess-1132"><span class="linenos">1132</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess-1133"><a href="#RegulatedMichaelisMentenProcess-1133"><span class="linenos">1133</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of</span>
</span><span id="RegulatedMichaelisMentenProcess-1134"><a href="#RegulatedMichaelisMentenProcess-1134"><span class="linenos">1134</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="RegulatedMichaelisMentenProcess-1135"><a href="#RegulatedMichaelisMentenProcess-1135"><span class="linenos">1135</span></a><span class="sd">        catalyst : str</span>
</span><span id="RegulatedMichaelisMentenProcess-1136"><a href="#RegulatedMichaelisMentenProcess-1136"><span class="linenos">1136</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="RegulatedMichaelisMentenProcess-1137"><a href="#RegulatedMichaelisMentenProcess-1137"><span class="linenos">1137</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess-1138"><a href="#RegulatedMichaelisMentenProcess-1138"><span class="linenos">1138</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="RegulatedMichaelisMentenProcess-1139"><a href="#RegulatedMichaelisMentenProcess-1139"><span class="linenos">1139</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="RegulatedMichaelisMentenProcess-1140"><a href="#RegulatedMichaelisMentenProcess-1140"><span class="linenos">1140</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1141"><a href="#RegulatedMichaelisMentenProcess-1141"><span class="linenos">1141</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="RegulatedMichaelisMentenProcess-1142"><a href="#RegulatedMichaelisMentenProcess-1142"><span class="linenos">1142</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="RegulatedMichaelisMentenProcess-1143"><a href="#RegulatedMichaelisMentenProcess-1143"><span class="linenos">1143</span></a><span class="sd">            are taking place.</span>
</span><span id="RegulatedMichaelisMentenProcess-1144"><a href="#RegulatedMichaelisMentenProcess-1144"><span class="linenos">1144</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="RegulatedMichaelisMentenProcess-1145"><a href="#RegulatedMichaelisMentenProcess-1145"><span class="linenos">1145</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="RegulatedMichaelisMentenProcess-1146"><a href="#RegulatedMichaelisMentenProcess-1146"><span class="linenos">1146</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="RegulatedMichaelisMentenProcess-1147"><a href="#RegulatedMichaelisMentenProcess-1147"><span class="linenos">1147</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="RegulatedMichaelisMentenProcess-1148"><a href="#RegulatedMichaelisMentenProcess-1148"><span class="linenos">1148</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1149"><a href="#RegulatedMichaelisMentenProcess-1149"><span class="linenos">1149</span></a><span class="sd">        Notes</span>
</span><span id="RegulatedMichaelisMentenProcess-1150"><a href="#RegulatedMichaelisMentenProcess-1150"><span class="linenos">1150</span></a><span class="sd">        -----</span>
</span><span id="RegulatedMichaelisMentenProcess-1151"><a href="#RegulatedMichaelisMentenProcess-1151"><span class="linenos">1151</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="RegulatedMichaelisMentenProcess-1152"><a href="#RegulatedMichaelisMentenProcess-1152"><span class="linenos">1152</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="RegulatedMichaelisMentenProcess-1153"><a href="#RegulatedMichaelisMentenProcess-1153"><span class="linenos">1153</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="RegulatedMichaelisMentenProcess-1154"><a href="#RegulatedMichaelisMentenProcess-1154"><span class="linenos">1154</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1155"><a href="#RegulatedMichaelisMentenProcess-1155"><span class="linenos">1155</span></a><span class="sd">        Examples</span>
</span><span id="RegulatedMichaelisMentenProcess-1156"><a href="#RegulatedMichaelisMentenProcess-1156"><span class="linenos">1156</span></a><span class="sd">        --------</span>
</span><span id="RegulatedMichaelisMentenProcess-1157"><a href="#RegulatedMichaelisMentenProcess-1157"><span class="linenos">1157</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1, catalyst=&#39;E&#39;, Km=15)</span>
</span><span id="RegulatedMichaelisMentenProcess-1158"><a href="#RegulatedMichaelisMentenProcess-1158"><span class="linenos">1158</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;A&#39;, alpha=0.5, K50=[10, 15], nH=2, catalyst=&#39;C&#39;, Km=5)</span>
</span><span id="RegulatedMichaelisMentenProcess-1159"><a href="#RegulatedMichaelisMentenProcess-1159"><span class="linenos">1159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1160"><a href="#RegulatedMichaelisMentenProcess-1160"><span class="linenos">1160</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="RegulatedMichaelisMentenProcess-1161"><a href="#RegulatedMichaelisMentenProcess-1161"><span class="linenos">1161</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1162"><a href="#RegulatedMichaelisMentenProcess-1162"><span class="linenos">1162</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1163"><a href="#RegulatedMichaelisMentenProcess-1163"><span class="linenos">1163</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1164"><a href="#RegulatedMichaelisMentenProcess-1164"><span class="linenos">1164</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1165"><a href="#RegulatedMichaelisMentenProcess-1165"><span class="linenos">1165</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="RegulatedMichaelisMentenProcess-1166"><a href="#RegulatedMichaelisMentenProcess-1166"><span class="linenos">1166</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="RegulatedMichaelisMentenProcess-1167"><a href="#RegulatedMichaelisMentenProcess-1167"><span class="linenos">1167</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="RegulatedMichaelisMentenProcess-1168"><a href="#RegulatedMichaelisMentenProcess-1168"><span class="linenos">1168</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1169"><a href="#RegulatedMichaelisMentenProcess-1169"><span class="linenos">1169</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="RegulatedMichaelisMentenProcess-1170"><a href="#RegulatedMichaelisMentenProcess-1170"><span class="linenos">1170</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="RegulatedMichaelisMentenProcess-1171"><a href="#RegulatedMichaelisMentenProcess-1171"><span class="linenos">1171</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1172"><a href="#RegulatedMichaelisMentenProcess-1172"><span class="linenos">1172</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1173"><a href="#RegulatedMichaelisMentenProcess-1173"><span class="linenos">1173</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1174"><a href="#RegulatedMichaelisMentenProcess-1174"><span class="linenos">1174</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1175"><a href="#RegulatedMichaelisMentenProcess-1175"><span class="linenos">1175</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1176"><a href="#RegulatedMichaelisMentenProcess-1176"><span class="linenos">1176</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1177"><a href="#RegulatedMichaelisMentenProcess-1177"><span class="linenos">1177</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess-1178"><a href="#RegulatedMichaelisMentenProcess-1178"><span class="linenos">1178</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1179"><a href="#RegulatedMichaelisMentenProcess-1179"><span class="linenos">1179</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1180"><a href="#RegulatedMichaelisMentenProcess-1180"><span class="linenos">1180</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1181"><a href="#RegulatedMichaelisMentenProcess-1181"><span class="linenos">1181</span></a>        <span class="n">repr_k</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
</span><span id="RegulatedMichaelisMentenProcess-1182"><a href="#RegulatedMichaelisMentenProcess-1182"><span class="linenos">1182</span></a>        <span class="n">repr_K50</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">K50</span>
</span><span id="RegulatedMichaelisMentenProcess-1183"><a href="#RegulatedMichaelisMentenProcess-1183"><span class="linenos">1183</span></a>        <span class="n">repr_Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Km</span>
</span><span id="RegulatedMichaelisMentenProcess-1184"><a href="#RegulatedMichaelisMentenProcess-1184"><span class="linenos">1184</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;RegulatedMichaelisMentenProcess Object: &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1185"><a href="#RegulatedMichaelisMentenProcess-1185"><span class="linenos">1185</span></a>               <span class="sa">f</span><span class="s2">&quot;RegulatedMichaelisMentenProcess.from_string(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1186"><a href="#RegulatedMichaelisMentenProcess-1186"><span class="linenos">1186</span></a>               <span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">repr_k</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1187"><a href="#RegulatedMichaelisMentenProcess-1187"><span class="linenos">1187</span></a>               <span class="sa">f</span><span class="s2">&quot;regulating_species=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1188"><a href="#RegulatedMichaelisMentenProcess-1188"><span class="linenos">1188</span></a>               <span class="sa">f</span><span class="s2">&quot;alpha=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1189"><a href="#RegulatedMichaelisMentenProcess-1189"><span class="linenos">1189</span></a>               <span class="sa">f</span><span class="s2">&quot;K50=</span><span class="si">{</span><span class="n">repr_K50</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1190"><a href="#RegulatedMichaelisMentenProcess-1190"><span class="linenos">1190</span></a>               <span class="sa">f</span><span class="s2">&quot;nH=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1191"><a href="#RegulatedMichaelisMentenProcess-1191"><span class="linenos">1191</span></a>               <span class="sa">f</span><span class="s2">&quot;catalyst=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1192"><a href="#RegulatedMichaelisMentenProcess-1192"><span class="linenos">1192</span></a>               <span class="sa">f</span><span class="s2">&quot;Km=</span><span class="si">{</span><span class="n">repr_Km</span><span class="si">}</span><span class="s2">,&quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1193"><a href="#RegulatedMichaelisMentenProcess-1193"><span class="linenos">1193</span></a>               <span class="sa">f</span><span class="s2">&quot;volume=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1194"><a href="#RegulatedMichaelisMentenProcess-1194"><span class="linenos">1194</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1195"><a href="#RegulatedMichaelisMentenProcess-1195"><span class="linenos">1195</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1196"><a href="#RegulatedMichaelisMentenProcess-1196"><span class="linenos">1196</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1197"><a href="#RegulatedMichaelisMentenProcess-1197"><span class="linenos">1197</span></a>            <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1198"><a href="#RegulatedMichaelisMentenProcess-1198"><span class="linenos">1198</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1199"><a href="#RegulatedMichaelisMentenProcess-1199"><span class="linenos">1199</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedMichaelisMentenProcess-1200"><a href="#RegulatedMichaelisMentenProcess-1200"><span class="linenos">1200</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Homogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50. &quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1201"><a href="#RegulatedMichaelisMentenProcess-1201"><span class="linenos">1201</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1202"><a href="#RegulatedMichaelisMentenProcess-1202"><span class="linenos">1202</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1203"><a href="#RegulatedMichaelisMentenProcess-1203"><span class="linenos">1203</span></a>                                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2"> distinct subspecies. &quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1204"><a href="#RegulatedMichaelisMentenProcess-1204"><span class="linenos">1204</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1205"><a href="#RegulatedMichaelisMentenProcess-1205"><span class="linenos">1205</span></a>                    <span class="n">K50_het_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1206"><a href="#RegulatedMichaelisMentenProcess-1206"><span class="linenos">1206</span></a>                                   <span class="sa">f</span><span class="s2">&quot;species </span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s2"> K50 with mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1207"><a href="#RegulatedMichaelisMentenProcess-1207"><span class="linenos">1207</span></a>                                   <span class="sa">f</span><span class="s2">&quot;standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1208"><a href="#RegulatedMichaelisMentenProcess-1208"><span class="linenos">1208</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1209"><a href="#RegulatedMichaelisMentenProcess-1209"><span class="linenos">1209</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedMichaelisMentenProcess-1210"><a href="#RegulatedMichaelisMentenProcess-1210"><span class="linenos">1210</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to K50.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1211"><a href="#RegulatedMichaelisMentenProcess-1211"><span class="linenos">1211</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1212"><a href="#RegulatedMichaelisMentenProcess-1212"><span class="linenos">1212</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to K50 &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1213"><a href="#RegulatedMichaelisMentenProcess-1213"><span class="linenos">1213</span></a>                              <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1214"><a href="#RegulatedMichaelisMentenProcess-1214"><span class="linenos">1214</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1215"><a href="#RegulatedMichaelisMentenProcess-1215"><span class="linenos">1215</span></a>                <span class="n">K50_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed K50 with &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1216"><a href="#RegulatedMichaelisMentenProcess-1216"><span class="linenos">1216</span></a>                              <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1217"><a href="#RegulatedMichaelisMentenProcess-1217"><span class="linenos">1217</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1218"><a href="#RegulatedMichaelisMentenProcess-1218"><span class="linenos">1218</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="RegulatedMichaelisMentenProcess-1219"><a href="#RegulatedMichaelisMentenProcess-1219"><span class="linenos">1219</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="s2">&quot;Homogeneous process with respect to Km.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1220"><a href="#RegulatedMichaelisMentenProcess-1220"><span class="linenos">1220</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1221"><a href="#RegulatedMichaelisMentenProcess-1221"><span class="linenos">1221</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with respect to Km &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1222"><a href="#RegulatedMichaelisMentenProcess-1222"><span class="linenos">1222</span></a>                         <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">)</span><span class="si">}</span><span class="s2"> distinct subspecies.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1223"><a href="#RegulatedMichaelisMentenProcess-1223"><span class="linenos">1223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1224"><a href="#RegulatedMichaelisMentenProcess-1224"><span class="linenos">1224</span></a>            <span class="n">Km_het_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Heterogeneous process with normally-distributed Km with &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1225"><a href="#RegulatedMichaelisMentenProcess-1225"><span class="linenos">1225</span></a>                         <span class="sa">f</span><span class="s2">&quot;mean </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and standard deviation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1226"><a href="#RegulatedMichaelisMentenProcess-1226"><span class="linenos">1226</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1227"><a href="#RegulatedMichaelisMentenProcess-1227"><span class="linenos">1227</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Regulating Species: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1228"><a href="#RegulatedMichaelisMentenProcess-1228"><span class="linenos">1228</span></a>                                   <span class="sa">f</span><span class="s2">&quot;alpha = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, nH = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1229"><a href="#RegulatedMichaelisMentenProcess-1229"><span class="linenos">1229</span></a>                                   <span class="sa">f</span><span class="s2">&quot;K50 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">K50</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">K50_het_str</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1230"><a href="#RegulatedMichaelisMentenProcess-1230"><span class="linenos">1230</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Catalyst: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess-1231"><a href="#RegulatedMichaelisMentenProcess-1231"><span class="linenos">1231</span></a>                                   <span class="sa">f</span><span class="s2">&quot;Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Km_het_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess-1232"><a href="#RegulatedMichaelisMentenProcess-1232"><span class="linenos">1232</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1233"><a href="#RegulatedMichaelisMentenProcess-1233"><span class="linenos">1233</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1234"><a href="#RegulatedMichaelisMentenProcess-1234"><span class="linenos">1234</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RegulatedMichaelisMentenProcess</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1235"><a href="#RegulatedMichaelisMentenProcess-1235"><span class="linenos">1235</span></a>            <span class="n">is_equal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">k</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1236"><a href="#RegulatedMichaelisMentenProcess-1236"><span class="linenos">1236</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1237"><a href="#RegulatedMichaelisMentenProcess-1237"><span class="linenos">1237</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reactants</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1238"><a href="#RegulatedMichaelisMentenProcess-1238"><span class="linenos">1238</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">products</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">products</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1239"><a href="#RegulatedMichaelisMentenProcess-1239"><span class="linenos">1239</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">regulating_species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">regulating_species</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1240"><a href="#RegulatedMichaelisMentenProcess-1240"><span class="linenos">1240</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1241"><a href="#RegulatedMichaelisMentenProcess-1241"><span class="linenos">1241</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">K50</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">K50</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1242"><a href="#RegulatedMichaelisMentenProcess-1242"><span class="linenos">1242</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nH</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1243"><a href="#RegulatedMichaelisMentenProcess-1243"><span class="linenos">1243</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">catalyst</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1244"><a href="#RegulatedMichaelisMentenProcess-1244"><span class="linenos">1244</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Km</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1245"><a href="#RegulatedMichaelisMentenProcess-1245"><span class="linenos">1245</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">species</span> <span class="ow">and</span>
</span><span id="RegulatedMichaelisMentenProcess-1246"><a href="#RegulatedMichaelisMentenProcess-1246"><span class="linenos">1246</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1247"><a href="#RegulatedMichaelisMentenProcess-1247"><span class="linenos">1247</span></a>            <span class="k">return</span> <span class="n">is_equal</span>
</span><span id="RegulatedMichaelisMentenProcess-1248"><a href="#RegulatedMichaelisMentenProcess-1248"><span class="linenos">1248</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1249"><a href="#RegulatedMichaelisMentenProcess-1249"><span class="linenos">1249</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="RegulatedMichaelisMentenProcess-1250"><a href="#RegulatedMichaelisMentenProcess-1250"><span class="linenos">1250</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess-1251"><a href="#RegulatedMichaelisMentenProcess-1251"><span class="linenos">1251</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2"> are instances of different classes.&quot;</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess-1252"><a href="#RegulatedMichaelisMentenProcess-1252"><span class="linenos">1252</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="RegulatedMichaelisMentenProcess-1253"><a href="#RegulatedMichaelisMentenProcess-1253"><span class="linenos">1253</span></a>
</span><span id="RegulatedMichaelisMentenProcess-1254"><a href="#RegulatedMichaelisMentenProcess-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess-1255"><a href="#RegulatedMichaelisMentenProcess-1255"><span class="linenos">1255</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Define a process that is regulated and obeys Michaelis-Menten kinetics.</p>

<p>This class allows a Michaelis-Menten Process to be defined
in terms of how it is regulated.
If there is only one regulating species, then the parameters have the same
type as would be expected for a homogeneous/heterogeneous process.
If there are multiple regulating species, then all parameters are a list
of their expected type, with the length of the list being equal to the
number of regulating species.</p>

<p>The class-specific attributes (except for <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code>, which requires some
additional notes) are listed below.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the given process. It is the <em>basal</em>
rate constant in the case of activation (or the minimum <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> value)
and the maximum rate constant in the case of repression.</li>
<li><strong>regulating_species</strong> (str or list of str):
Name of the regulating species. Multiple species can be specified as
comma-separated in a string or a list of strings with the species names.</li>
<li><p><strong>alpha</strong> (float or int or list[float or int]):
Parameter denoting the degree of activation/repression.</p>

<pre><code>- 0 &lt;= alpha &lt; 1: repression
- alpha = 1: no regulation
- alpha &gt; 1: activation
</code></pre>

<p>alpha is a multiplier: in the case of activation, the maximum
rate constant value will be <code>alpha * k</code>.
In the case of repression, the minimum
rate constant value will be <code>alpha * k</code>.</p></li>
<li><strong>K50</strong> (float or int or list of floats or 2-tuple of floats or list[float or int or list of floats or 2-tuple of floats]):
<em>Microscopic</em> constant that corresponds to the number of
<code>regulating_species</code> agents that would produce
half-maximal activation/repression.
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedMichaelisMentenProcess.K50">K50</a></code>,
using the same rules as for parameter <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>nH</strong> (float or int or list[float or int]):
Hill coefficient for the given process. Indicates the degree of
cooperativity in the regulatory interaction.</li>
<li><strong>is_heterogeneous_K50</strong> (bool or list of bool):
Denotes if the parameter <code><a href="#RegulatedMichaelisMentenProcess.K50">K50</a></code> exhibits heterogeneity
(distinct subspecies/interactions or normally-distributed).</li>
<li><strong>regulation_type</strong> (str or list of str):
The type of regulation for this process based on the value of alpha:
'activation' or 'repression' or 'no regulation'.</li>
<li><strong>catalyst</strong> (str):
Name of the species acting as a catalyst for this process.</li>
<li><strong>Km</strong> (float or int or list of floats or 2-tuple of floats):
<em>Microscopic</em> Michaelis constant. Corresponds to the number
of <code><a href="#RegulatedMichaelisMentenProcess.catalyst">catalyst</a></code> agents that would produce half-maximal activity.
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedMichaelisMentenProcess.K50">K50</a></code>,
using the same rules as for parameter <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>is_heterogeneous_Km</strong> (bool):
Denotes if the parameter <code><a href="#RegulatedMichaelisMentenProcess.Km">Km</a></code> exhibits heterogeneity
(distinct subspecies/interactions or normally-distributed).</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Currently only implemented for 1st order processes. 0th order processes
cannot obey Michaelis-Menten kinetics and 2nd order Michaelis-Menten
processes are not implemented yet.</p>
</div>


                            <div id="RegulatedMichaelisMentenProcess.__init__" class="classattr">
                                        <input id="RegulatedMichaelisMentenProcess.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RegulatedMichaelisMentenProcess</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="RegulatedMichaelisMentenProcess.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedMichaelisMentenProcess.__init__-1037"><a href="#RegulatedMichaelisMentenProcess.__init__-1037"><span class="linenos">1037</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1038"><a href="#RegulatedMichaelisMentenProcess.__init__-1038"><span class="linenos">1038</span></a>                 <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1039"><a href="#RegulatedMichaelisMentenProcess.__init__-1039"><span class="linenos">1039</span></a>                 <span class="n">reactants</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1040"><a href="#RegulatedMichaelisMentenProcess.__init__-1040"><span class="linenos">1040</span></a>                 <span class="n">products</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1041"><a href="#RegulatedMichaelisMentenProcess.__init__-1041"><span class="linenos">1041</span></a>                 <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1042"><a href="#RegulatedMichaelisMentenProcess.__init__-1042"><span class="linenos">1042</span></a>                 <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1043"><a href="#RegulatedMichaelisMentenProcess.__init__-1043"><span class="linenos">1043</span></a>                 <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1044"><a href="#RegulatedMichaelisMentenProcess.__init__-1044"><span class="linenos">1044</span></a>                 <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1045"><a href="#RegulatedMichaelisMentenProcess.__init__-1045"><span class="linenos">1045</span></a>                 <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1046"><a href="#RegulatedMichaelisMentenProcess.__init__-1046"><span class="linenos">1046</span></a>                      <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1047"><a href="#RegulatedMichaelisMentenProcess.__init__-1047"><span class="linenos">1047</span></a>                 <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1048"><a href="#RegulatedMichaelisMentenProcess.__init__-1048"><span class="linenos">1048</span></a>                 <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1049"><a href="#RegulatedMichaelisMentenProcess.__init__-1049"><span class="linenos">1049</span></a>                 <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1050"><a href="#RegulatedMichaelisMentenProcess.__init__-1050"><span class="linenos">1050</span></a>                 <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1051"><a href="#RegulatedMichaelisMentenProcess.__init__-1051"><span class="linenos">1051</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1052"><a href="#RegulatedMichaelisMentenProcess.__init__-1052"><span class="linenos">1052</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span> <span class="o">=</span> <span class="n">catalyst</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1053"><a href="#RegulatedMichaelisMentenProcess.__init__-1053"><span class="linenos">1053</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">Km</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1054"><a href="#RegulatedMichaelisMentenProcess.__init__-1054"><span class="linenos">1054</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_heterogeneous_Km</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1055"><a href="#RegulatedMichaelisMentenProcess.__init__-1055"><span class="linenos">1055</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1056"><a href="#RegulatedMichaelisMentenProcess.__init__-1056"><span class="linenos">1056</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1057"><a href="#RegulatedMichaelisMentenProcess.__init__-1057"><span class="linenos">1057</span></a>                         <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1058"><a href="#RegulatedMichaelisMentenProcess.__init__-1058"><span class="linenos">1058</span></a>                         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1059"><a href="#RegulatedMichaelisMentenProcess.__init__-1059"><span class="linenos">1059</span></a>                         <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1060"><a href="#RegulatedMichaelisMentenProcess.__init__-1060"><span class="linenos">1060</span></a>                         <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1061"><a href="#RegulatedMichaelisMentenProcess.__init__-1061"><span class="linenos">1061</span></a>                         <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1062"><a href="#RegulatedMichaelisMentenProcess.__init__-1062"><span class="linenos">1062</span></a>                         <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1063"><a href="#RegulatedMichaelisMentenProcess.__init__-1063"><span class="linenos">1063</span></a>                         <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1064"><a href="#RegulatedMichaelisMentenProcess.__init__-1064"><span class="linenos">1064</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1065"><a href="#RegulatedMichaelisMentenProcess.__init__-1065"><span class="linenos">1065</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_validate_reg_params</span><span class="p">()</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1066"><a href="#RegulatedMichaelisMentenProcess.__init__-1066"><span class="linenos">1066</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1067"><a href="#RegulatedMichaelisMentenProcess.__init__-1067"><span class="linenos">1067</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A 0th order process has no substrate for a catalyst &quot;</span> \
</span><span id="RegulatedMichaelisMentenProcess.__init__-1068"><a href="#RegulatedMichaelisMentenProcess.__init__-1068"><span class="linenos">1068</span></a>                                <span class="s2">&quot;to act on, therefore it cannot follow Michaelis-Menten kinetics.&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1069"><a href="#RegulatedMichaelisMentenProcess.__init__-1069"><span class="linenos">1069</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1070"><a href="#RegulatedMichaelisMentenProcess.__init__-1070"><span class="linenos">1070</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1071"><a href="#RegulatedMichaelisMentenProcess.__init__-1071"><span class="linenos">1071</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1072"><a href="#RegulatedMichaelisMentenProcess.__init__-1072"><span class="linenos">1072</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Convert macroscopic to microscopic Km value</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1073"><a href="#RegulatedMichaelisMentenProcess.__init__-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Km</span> <span class="o">=</span> <span class="n">macro_to_micro</span><span class="p">(</span><span class="n">Km</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1074"><a href="#RegulatedMichaelisMentenProcess.__init__-1074"><span class="linenos">1074</span></a>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1075"><a href="#RegulatedMichaelisMentenProcess.__init__-1075"><span class="linenos">1075</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess.__init__-1076"><a href="#RegulatedMichaelisMentenProcess.__init__-1076"><span class="linenos">1076</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, catalyst = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalyst</span><span class="si">}</span><span class="s2">, Km = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Km</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


    

                            </div>
                            <div id="RegulatedMichaelisMentenProcess.catalyst" class="classattr">
                                <div class="attr variable">
            <span class="name">catalyst</span>

        
    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess.catalyst"></a>
    
    

                            </div>
                            <div id="RegulatedMichaelisMentenProcess.Km" class="classattr">
                                <div class="attr variable">
            <span class="name">Km</span>

        
    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess.Km"></a>
    
    

                            </div>
                            <div id="RegulatedMichaelisMentenProcess.is_heterogeneous_Km" class="classattr">
                                <div class="attr variable">
            <span class="name">is_heterogeneous_Km</span>

        
    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess.is_heterogeneous_Km"></a>
    
    

                            </div>
                            <div id="RegulatedMichaelisMentenProcess.from_string" class="classattr">
                                        <input id="RegulatedMichaelisMentenProcess.from_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_string</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="RegulatedMichaelisMentenProcess.from_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RegulatedMichaelisMentenProcess.from_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RegulatedMichaelisMentenProcess.from_string-1078"><a href="#RegulatedMichaelisMentenProcess.from_string-1078"><span class="linenos">1078</span></a>    <span class="nd">@classmethod</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1079"><a href="#RegulatedMichaelisMentenProcess.from_string-1079"><span class="linenos">1079</span></a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1080"><a href="#RegulatedMichaelisMentenProcess.from_string-1080"><span class="linenos">1080</span></a>                    <span class="n">proc_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1081"><a href="#RegulatedMichaelisMentenProcess.from_string-1081"><span class="linenos">1081</span></a>                    <span class="o">/</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1082"><a href="#RegulatedMichaelisMentenProcess.from_string-1082"><span class="linenos">1082</span></a>                    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1083"><a href="#RegulatedMichaelisMentenProcess.from_string-1083"><span class="linenos">1083</span></a>                    <span class="o">*</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1084"><a href="#RegulatedMichaelisMentenProcess.from_string-1084"><span class="linenos">1084</span></a>                    <span class="n">regulating_species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1085"><a href="#RegulatedMichaelisMentenProcess.from_string-1085"><span class="linenos">1085</span></a>                    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1086"><a href="#RegulatedMichaelisMentenProcess.from_string-1086"><span class="linenos">1086</span></a>                    <span class="n">K50</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1087"><a href="#RegulatedMichaelisMentenProcess.from_string-1087"><span class="linenos">1087</span></a>                         <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1088"><a href="#RegulatedMichaelisMentenProcess.from_string-1088"><span class="linenos">1088</span></a>                             <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1089"><a href="#RegulatedMichaelisMentenProcess.from_string-1089"><span class="linenos">1089</span></a>                    <span class="n">nH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1090"><a href="#RegulatedMichaelisMentenProcess.from_string-1090"><span class="linenos">1090</span></a>                    <span class="n">catalyst</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1091"><a href="#RegulatedMichaelisMentenProcess.from_string-1091"><span class="linenos">1091</span></a>                    <span class="n">Km</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1092"><a href="#RegulatedMichaelisMentenProcess.from_string-1092"><span class="linenos">1092</span></a>                        <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1093"><a href="#RegulatedMichaelisMentenProcess.from_string-1093"><span class="linenos">1093</span></a>                    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1094"><a href="#RegulatedMichaelisMentenProcess.from_string-1094"><span class="linenos">1094</span></a>                    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1095"><a href="#RegulatedMichaelisMentenProcess.from_string-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a regulated Michaelis-Menten process from a string.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1096"><a href="#RegulatedMichaelisMentenProcess.from_string-1096"><span class="linenos">1096</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1097"><a href="#RegulatedMichaelisMentenProcess.from_string-1097"><span class="linenos">1097</span></a><span class="sd">        Parameters</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1098"><a href="#RegulatedMichaelisMentenProcess.from_string-1098"><span class="linenos">1098</span></a><span class="sd">        ----------</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1099"><a href="#RegulatedMichaelisMentenProcess.from_string-1099"><span class="linenos">1099</span></a><span class="sd">        proc_str : str</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1100"><a href="#RegulatedMichaelisMentenProcess.from_string-1100"><span class="linenos">1100</span></a><span class="sd">            A string describing the process in standard chemical notation</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1101"><a href="#RegulatedMichaelisMentenProcess.from_string-1101"><span class="linenos">1101</span></a><span class="sd">            (e.g., &#39;A + B -&gt; C&#39;)</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1102"><a href="#RegulatedMichaelisMentenProcess.from_string-1102"><span class="linenos">1102</span></a><span class="sd">        k : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1103"><a href="#RegulatedMichaelisMentenProcess.from_string-1103"><span class="linenos">1103</span></a><span class="sd">            The *microscopic* rate constant for the given process. It is the *basal*</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1104"><a href="#RegulatedMichaelisMentenProcess.from_string-1104"><span class="linenos">1104</span></a><span class="sd">            rate constant in the case of activation (or the minimum `k` value)</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1105"><a href="#RegulatedMichaelisMentenProcess.from_string-1105"><span class="linenos">1105</span></a><span class="sd">            and the maximum rate constant in the case of repression.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1106"><a href="#RegulatedMichaelisMentenProcess.from_string-1106"><span class="linenos">1106</span></a><span class="sd">            If `k` is a float or int, then the process is homogeneous.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1107"><a href="#RegulatedMichaelisMentenProcess.from_string-1107"><span class="linenos">1107</span></a><span class="sd">            If `k` is a list, then the population of the reactants</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1108"><a href="#RegulatedMichaelisMentenProcess.from_string-1108"><span class="linenos">1108</span></a><span class="sd">            constsists of distinct subspecies or subinteractions</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1109"><a href="#RegulatedMichaelisMentenProcess.from_string-1109"><span class="linenos">1109</span></a><span class="sd">            depending on the order. If `k` is a 2-tuple,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1110"><a href="#RegulatedMichaelisMentenProcess.from_string-1110"><span class="linenos">1110</span></a><span class="sd">            then the constant is normally-distributed with a mean and standard</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1111"><a href="#RegulatedMichaelisMentenProcess.from_string-1111"><span class="linenos">1111</span></a><span class="sd">            deviation specified in the tuple&#39;s elements. Note that `k` cannot</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1112"><a href="#RegulatedMichaelisMentenProcess.from_string-1112"><span class="linenos">1112</span></a><span class="sd">            be zero for this form of regulation.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1113"><a href="#RegulatedMichaelisMentenProcess.from_string-1113"><span class="linenos">1113</span></a><span class="sd">        regulating_species : str or list of str</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1114"><a href="#RegulatedMichaelisMentenProcess.from_string-1114"><span class="linenos">1114</span></a><span class="sd">            Name of the regulating species.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1115"><a href="#RegulatedMichaelisMentenProcess.from_string-1115"><span class="linenos">1115</span></a><span class="sd">        alpha : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1116"><a href="#RegulatedMichaelisMentenProcess.from_string-1116"><span class="linenos">1116</span></a><span class="sd">            Parameter denoting the degree of activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1117"><a href="#RegulatedMichaelisMentenProcess.from_string-1117"><span class="linenos">1117</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1118"><a href="#RegulatedMichaelisMentenProcess.from_string-1118"><span class="linenos">1118</span></a><span class="sd">            - 0 &lt;= alpha &lt; 1: repression</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1119"><a href="#RegulatedMichaelisMentenProcess.from_string-1119"><span class="linenos">1119</span></a><span class="sd">            - alpha = 1: no regulation</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1120"><a href="#RegulatedMichaelisMentenProcess.from_string-1120"><span class="linenos">1120</span></a><span class="sd">            - alpha &gt; 1: activation</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1121"><a href="#RegulatedMichaelisMentenProcess.from_string-1121"><span class="linenos">1121</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1122"><a href="#RegulatedMichaelisMentenProcess.from_string-1122"><span class="linenos">1122</span></a><span class="sd">            alpha is a multiplier: in the case of activation, the maximum</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1123"><a href="#RegulatedMichaelisMentenProcess.from_string-1123"><span class="linenos">1123</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1124"><a href="#RegulatedMichaelisMentenProcess.from_string-1124"><span class="linenos">1124</span></a><span class="sd">            In the case of repression, the minimum</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1125"><a href="#RegulatedMichaelisMentenProcess.from_string-1125"><span class="linenos">1125</span></a><span class="sd">            rate constant value will be `alpha * k`.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1126"><a href="#RegulatedMichaelisMentenProcess.from_string-1126"><span class="linenos">1126</span></a><span class="sd">        K50 : float or int or list of floats or 2-tuple of floats or list of each of the previous types</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1127"><a href="#RegulatedMichaelisMentenProcess.from_string-1127"><span class="linenos">1127</span></a><span class="sd">            *Microscopic* constant that corresponds to the number of</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1128"><a href="#RegulatedMichaelisMentenProcess.from_string-1128"><span class="linenos">1128</span></a><span class="sd">            `regulating_species` agents that would produce</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1129"><a href="#RegulatedMichaelisMentenProcess.from_string-1129"><span class="linenos">1129</span></a><span class="sd">            half-maximal activation/repression.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1130"><a href="#RegulatedMichaelisMentenProcess.from_string-1130"><span class="linenos">1130</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `K50`,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1131"><a href="#RegulatedMichaelisMentenProcess.from_string-1131"><span class="linenos">1131</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1132"><a href="#RegulatedMichaelisMentenProcess.from_string-1132"><span class="linenos">1132</span></a><span class="sd">        nH : float or int or list[float or int]</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1133"><a href="#RegulatedMichaelisMentenProcess.from_string-1133"><span class="linenos">1133</span></a><span class="sd">            Hill coefficient for the given process. Indicates the degree of</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1134"><a href="#RegulatedMichaelisMentenProcess.from_string-1134"><span class="linenos">1134</span></a><span class="sd">            cooperativity in the regulatory interaction.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1135"><a href="#RegulatedMichaelisMentenProcess.from_string-1135"><span class="linenos">1135</span></a><span class="sd">        catalyst : str</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1136"><a href="#RegulatedMichaelisMentenProcess.from_string-1136"><span class="linenos">1136</span></a><span class="sd">            Name of species acting as a catalyst.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1137"><a href="#RegulatedMichaelisMentenProcess.from_string-1137"><span class="linenos">1137</span></a><span class="sd">        Km : float or int or list of floats or 2-tuple of floats</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1138"><a href="#RegulatedMichaelisMentenProcess.from_string-1138"><span class="linenos">1138</span></a><span class="sd">            *Microscopic* Michaelis constant for the process.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1139"><a href="#RegulatedMichaelisMentenProcess.from_string-1139"><span class="linenos">1139</span></a><span class="sd">            Heterogeneity in this parameter is determined by the type of `Km`,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1140"><a href="#RegulatedMichaelisMentenProcess.from_string-1140"><span class="linenos">1140</span></a><span class="sd">            using the same rules as for parameter `k`.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1141"><a href="#RegulatedMichaelisMentenProcess.from_string-1141"><span class="linenos">1141</span></a><span class="sd">        volume : float, default : None, optional</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1142"><a href="#RegulatedMichaelisMentenProcess.from_string-1142"><span class="linenos">1142</span></a><span class="sd">            The volume *in liters* of the compartment in which the processes</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1143"><a href="#RegulatedMichaelisMentenProcess.from_string-1143"><span class="linenos">1143</span></a><span class="sd">            are taking place.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1144"><a href="#RegulatedMichaelisMentenProcess.from_string-1144"><span class="linenos">1144</span></a><span class="sd">        sep : str, default: &#39;-&gt;&#39;</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1145"><a href="#RegulatedMichaelisMentenProcess.from_string-1145"><span class="linenos">1145</span></a><span class="sd">            Specifies the characters that distinguish the reactants from the</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1146"><a href="#RegulatedMichaelisMentenProcess.from_string-1146"><span class="linenos">1146</span></a><span class="sd">            products. The default is &#39;-&gt;&#39;. The code also treats `--&gt;` as a</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1147"><a href="#RegulatedMichaelisMentenProcess.from_string-1147"><span class="linenos">1147</span></a><span class="sd">            default, if it&#39;s present in `proc_str`.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1148"><a href="#RegulatedMichaelisMentenProcess.from_string-1148"><span class="linenos">1148</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1149"><a href="#RegulatedMichaelisMentenProcess.from_string-1149"><span class="linenos">1149</span></a><span class="sd">        Notes</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1150"><a href="#RegulatedMichaelisMentenProcess.from_string-1150"><span class="linenos">1150</span></a><span class="sd">        -----</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1151"><a href="#RegulatedMichaelisMentenProcess.from_string-1151"><span class="linenos">1151</span></a><span class="sd">        - Species names should not contain spaces, dashes, and</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1152"><a href="#RegulatedMichaelisMentenProcess.from_string-1152"><span class="linenos">1152</span></a><span class="sd">          should start with a non-numeric character.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1153"><a href="#RegulatedMichaelisMentenProcess.from_string-1153"><span class="linenos">1153</span></a><span class="sd">        - Zeroth order processes should be specified by an empty space or &#39;None&#39;.</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1154"><a href="#RegulatedMichaelisMentenProcess.from_string-1154"><span class="linenos">1154</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1155"><a href="#RegulatedMichaelisMentenProcess.from_string-1155"><span class="linenos">1155</span></a><span class="sd">        Examples</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1156"><a href="#RegulatedMichaelisMentenProcess.from_string-1156"><span class="linenos">1156</span></a><span class="sd">        --------</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1157"><a href="#RegulatedMichaelisMentenProcess.from_string-1157"><span class="linenos">1157</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.2, regulating_species=&#39;X&#39;, alpha=2, K50=10, nH=1, catalyst=&#39;E&#39;, Km=15)</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1158"><a href="#RegulatedMichaelisMentenProcess.from_string-1158"><span class="linenos">1158</span></a><span class="sd">        &gt;&gt;&gt; RegulatedMichaelisMentenProcess.from_string(&quot;A -&gt; X&quot;, k=0.3, regulating_species=&#39;A&#39;, alpha=0.5, K50=[10, 15], nH=2, catalyst=&#39;C&#39;, Km=5)</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1159"><a href="#RegulatedMichaelisMentenProcess.from_string-1159"><span class="linenos">1159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1160"><a href="#RegulatedMichaelisMentenProcess.from_string-1160"><span class="linenos">1160</span></a>        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="k">if</span> <span class="s1">&#39;--&gt;&#39;</span> <span class="ow">in</span> <span class="n">proc_str</span> <span class="k">else</span> <span class="n">sep</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1161"><a href="#RegulatedMichaelisMentenProcess.from_string-1161"><span class="linenos">1161</span></a>        <span class="k">if</span> <span class="n">sep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proc_str</span><span class="p">:</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1162"><a href="#RegulatedMichaelisMentenProcess.from_string-1162"><span class="linenos">1162</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot distinguish the reactants from the products.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1163"><a href="#RegulatedMichaelisMentenProcess.from_string-1163"><span class="linenos">1163</span></a>                            <span class="s2">&quot;Please use the *sep* keyword: e.g. sep=&#39;-&gt;&#39;.&quot;</span><span class="p">)</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1164"><a href="#RegulatedMichaelisMentenProcess.from_string-1164"><span class="linenos">1164</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1165"><a href="#RegulatedMichaelisMentenProcess.from_string-1165"><span class="linenos">1165</span></a>        <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">proc_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># Left- and Right-hand sides of process</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1166"><a href="#RegulatedMichaelisMentenProcess.from_string-1166"><span class="linenos">1166</span></a>        <span class="n">lhs_terms</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the left-hand side</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1167"><a href="#RegulatedMichaelisMentenProcess.from_string-1167"><span class="linenos">1167</span></a>        <span class="n">rhs_terms</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>  <span class="c1"># Separate the terms on the right-hand side</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1168"><a href="#RegulatedMichaelisMentenProcess.from_string-1168"><span class="linenos">1168</span></a>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1169"><a href="#RegulatedMichaelisMentenProcess.from_string-1169"><span class="linenos">1169</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">lhs_terms</span><span class="p">),</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1170"><a href="#RegulatedMichaelisMentenProcess.from_string-1170"><span class="linenos">1170</span></a>                   <span class="n">products</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="n">rhs_terms</span><span class="p">),</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1171"><a href="#RegulatedMichaelisMentenProcess.from_string-1171"><span class="linenos">1171</span></a>                   <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1172"><a href="#RegulatedMichaelisMentenProcess.from_string-1172"><span class="linenos">1172</span></a>                   <span class="n">regulating_species</span><span class="o">=</span><span class="n">regulating_species</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1173"><a href="#RegulatedMichaelisMentenProcess.from_string-1173"><span class="linenos">1173</span></a>                   <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1174"><a href="#RegulatedMichaelisMentenProcess.from_string-1174"><span class="linenos">1174</span></a>                   <span class="n">K50</span><span class="o">=</span><span class="n">K50</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1175"><a href="#RegulatedMichaelisMentenProcess.from_string-1175"><span class="linenos">1175</span></a>                   <span class="n">nH</span><span class="o">=</span><span class="n">nH</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1176"><a href="#RegulatedMichaelisMentenProcess.from_string-1176"><span class="linenos">1176</span></a>                   <span class="n">catalyst</span><span class="o">=</span><span class="n">catalyst</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1177"><a href="#RegulatedMichaelisMentenProcess.from_string-1177"><span class="linenos">1177</span></a>                   <span class="n">Km</span><span class="o">=</span><span class="n">Km</span><span class="p">,</span>
</span><span id="RegulatedMichaelisMentenProcess.from_string-1178"><a href="#RegulatedMichaelisMentenProcess.from_string-1178"><span class="linenos">1178</span></a>                   <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a regulated Michaelis-Menten process from a string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proc_str</strong> (str):
A string describing the process in standard chemical notation
(e.g., 'A + B -> C')</li>
<li><strong>k</strong> (float or int or list of floats or 2-tuple of floats):
The <em>microscopic</em> rate constant for the given process. It is the <em>basal</em>
rate constant in the case of activation (or the minimum <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> value)
and the maximum rate constant in the case of repression.
If <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> is a float or int, then the process is homogeneous.
If <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> is a list, then the population of the reactants
constsists of distinct subspecies or subinteractions
depending on the order. If <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> is a 2-tuple,
then the constant is normally-distributed with a mean and standard
deviation specified in the tuple's elements. Note that <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code> cannot
be zero for this form of regulation.</li>
<li><strong>regulating_species</strong> (str or list of str):
Name of the regulating species.</li>
<li><p><strong>alpha</strong> (float or int or list[float or int]):
Parameter denoting the degree of activation/repression.</p>

<ul>
<li>0 &lt;= alpha &lt; 1: repression</li>
<li>alpha = 1: no regulation</li>
<li>alpha &gt; 1: activation</li>
</ul>

<p>alpha is a multiplier: in the case of activation, the maximum
rate constant value will be <code>alpha * k</code>.
In the case of repression, the minimum
rate constant value will be <code>alpha * k</code>.</p></li>
<li><strong>K50</strong> (float or int or list of floats or 2-tuple of floats or list of each of the previous types):
<em>Microscopic</em> constant that corresponds to the number of
<code>regulating_species</code> agents that would produce
half-maximal activation/repression.
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedMichaelisMentenProcess.K50">K50</a></code>,
using the same rules as for parameter <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>nH</strong> (float or int or list[float or int]):
Hill coefficient for the given process. Indicates the degree of
cooperativity in the regulatory interaction.</li>
<li><strong>catalyst</strong> (str):
Name of species acting as a catalyst.</li>
<li><strong>Km</strong> (float or int or list of floats or 2-tuple of floats):
<em>Microscopic</em> Michaelis constant for the process.
Heterogeneity in this parameter is determined by the type of <code><a href="#RegulatedMichaelisMentenProcess.Km">Km</a></code>,
using the same rules as for parameter <code><a href="#RegulatedMichaelisMentenProcess.k">k</a></code>.</li>
<li><strong>volume : float, default</strong> (None, optional):
The volume <em>in liters</em> of the compartment in which the processes
are taking place.</li>
<li><strong>sep : str, default</strong> ('->'):
Specifies the characters that distinguish the reactants from the
products. The default is '->'. The code also treats <code>--&gt;</code> as a
default, if it's present in <code>proc_str</code>.</li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>Species names should not contain spaces, dashes, and
should start with a non-numeric character.</li>
<li>Zeroth order processes should be specified by an empty space or 'None'.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#RegulatedMichaelisMentenProcess.from_string">RegulatedMichaelisMentenProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">regulating_species</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">K50</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nH</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">catalyst</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">Km</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#RegulatedMichaelisMentenProcess.from_string">RegulatedMichaelisMentenProcess.from_string</a></span><span class="p">(</span><span class="s2">&quot;A -&gt; X&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">regulating_species</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">K50</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">nH</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">catalyst</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">Km</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#RegulatedProcess">RegulatedProcess</a></dt>
                                <dd id="RegulatedMichaelisMentenProcess.alpha" class="variable"><a href="#RegulatedProcess.alpha">alpha</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.K50" class="variable"><a href="#RegulatedProcess.K50">K50</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.nH" class="variable"><a href="#RegulatedProcess.nH">nH</a></dd>

            </div>
            <div><dt><a href="#Process">Process</a></dt>
                                <dd id="RegulatedMichaelisMentenProcess.reactants" class="variable"><a href="#Process.reactants">reactants</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.products" class="variable"><a href="#Process.products">products</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.k" class="variable"><a href="#Process.k">k</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.volume" class="variable"><a href="#Process.volume">volume</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.order" class="variable"><a href="#Process.order">order</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.is_heterogeneous" class="variable"><a href="#Process.is_heterogeneous">is_heterogeneous</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.species" class="variable"><a href="#Process.species">species</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.reacts_" class="variable"><a href="#Process.reacts_">reacts_</a></dd>
                <dd id="RegulatedMichaelisMentenProcess.prods_" class="variable"><a href="#Process.prods_">prods_</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="NullSpeciesNameError">
                            <input id="NullSpeciesNameError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">NullSpeciesNameError</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="NullSpeciesNameError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NullSpeciesNameError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NullSpeciesNameError-1258"><a href="#NullSpeciesNameError-1258"><span class="linenos">1258</span></a><span class="k">class</span> <span class="nc">NullSpeciesNameError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="NullSpeciesNameError-1259"><a href="#NullSpeciesNameError-1259"><span class="linenos">1259</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Error when the species name is an empty string. &quot;&quot;&quot;</span>
</span><span id="NullSpeciesNameError-1260"><a href="#NullSpeciesNameError-1260"><span class="linenos">1260</span></a>
</span><span id="NullSpeciesNameError-1261"><a href="#NullSpeciesNameError-1261"><span class="linenos">1261</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NullSpeciesNameError-1262"><a href="#NullSpeciesNameError-1262"><span class="linenos">1262</span></a>        <span class="k">return</span> <span class="s2">&quot;A species name cannot be an empty string.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Error when the species name is an empty string.</p>
</div>


                </section>
                <section id="update_all_species">
                            <input id="update_all_species-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_all_species</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">procs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n"><a href="#Process">Process</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="update_all_species-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#update_all_species"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="update_all_species-1265"><a href="#update_all_species-1265"><span class="linenos">1265</span></a><span class="k">def</span> <span class="nf">update_all_species</span><span class="p">(</span><span class="n">procs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Process</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
</span><span id="update_all_species-1266"><a href="#update_all_species-1266"><span class="linenos">1266</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Categorize all species in a list of processes.</span>
</span><span id="update_all_species-1267"><a href="#update_all_species-1267"><span class="linenos">1267</span></a>
</span><span id="update_all_species-1268"><a href="#update_all_species-1268"><span class="linenos">1268</span></a><span class="sd">    Extract all species from a list of processes. Then categorize each of them</span>
</span><span id="update_all_species-1269"><a href="#update_all_species-1269"><span class="linenos">1269</span></a><span class="sd">    as a reactant or product and list the process(es) it takes part in.</span>
</span><span id="update_all_species-1270"><a href="#update_all_species-1270"><span class="linenos">1270</span></a>
</span><span id="update_all_species-1271"><a href="#update_all_species-1271"><span class="linenos">1271</span></a><span class="sd">    Parameters</span>
</span><span id="update_all_species-1272"><a href="#update_all_species-1272"><span class="linenos">1272</span></a><span class="sd">    ----------</span>
</span><span id="update_all_species-1273"><a href="#update_all_species-1273"><span class="linenos">1273</span></a><span class="sd">    procs : tuple</span>
</span><span id="update_all_species-1274"><a href="#update_all_species-1274"><span class="linenos">1274</span></a><span class="sd">        A tuple of objects of type `Process` or its subclasses.</span>
</span><span id="update_all_species-1275"><a href="#update_all_species-1275"><span class="linenos">1275</span></a>
</span><span id="update_all_species-1276"><a href="#update_all_species-1276"><span class="linenos">1276</span></a><span class="sd">    Returns</span>
</span><span id="update_all_species-1277"><a href="#update_all_species-1277"><span class="linenos">1277</span></a><span class="sd">    -------</span>
</span><span id="update_all_species-1278"><a href="#update_all_species-1278"><span class="linenos">1278</span></a><span class="sd">    tuple</span>
</span><span id="update_all_species-1279"><a href="#update_all_species-1279"><span class="linenos">1279</span></a><span class="sd">        all_species : set of strings</span>
</span><span id="update_all_species-1280"><a href="#update_all_species-1280"><span class="linenos">1280</span></a><span class="sd">            A set of all species present in the processes.</span>
</span><span id="update_all_species-1281"><a href="#update_all_species-1281"><span class="linenos">1281</span></a><span class="sd">        procs_by_reactant : dict</span>
</span><span id="update_all_species-1282"><a href="#update_all_species-1282"><span class="linenos">1282</span></a><span class="sd">            A dictionary whose keys are the species that are</span>
</span><span id="update_all_species-1283"><a href="#update_all_species-1283"><span class="linenos">1283</span></a><span class="sd">            reactants in one or more processes. The value for each</span>
</span><span id="update_all_species-1284"><a href="#update_all_species-1284"><span class="linenos">1284</span></a><span class="sd">            key is a list of processes.</span>
</span><span id="update_all_species-1285"><a href="#update_all_species-1285"><span class="linenos">1285</span></a><span class="sd">        procs_by_product : dict</span>
</span><span id="update_all_species-1286"><a href="#update_all_species-1286"><span class="linenos">1286</span></a><span class="sd">            A dictionary whose keys are the species that are</span>
</span><span id="update_all_species-1287"><a href="#update_all_species-1287"><span class="linenos">1287</span></a><span class="sd">            products in one or more processes. The value for each</span>
</span><span id="update_all_species-1288"><a href="#update_all_species-1288"><span class="linenos">1288</span></a><span class="sd">            key is a list of processes.</span>
</span><span id="update_all_species-1289"><a href="#update_all_species-1289"><span class="linenos">1289</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="update_all_species-1290"><a href="#update_all_species-1290"><span class="linenos">1290</span></a>    <span class="n">procs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">procs</span><span class="p">)</span>
</span><span id="update_all_species-1291"><a href="#update_all_species-1291"><span class="linenos">1291</span></a>    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
</span><span id="update_all_species-1292"><a href="#update_all_species-1292"><span class="linenos">1292</span></a>        <span class="c1"># For a reversible process, replace it with separate instances</span>
</span><span id="update_all_species-1293"><a href="#update_all_species-1293"><span class="linenos">1293</span></a>        <span class="c1"># of Process objects representing the forward and reverse reactions.</span>
</span><span id="update_all_species-1294"><a href="#update_all_species-1294"><span class="linenos">1294</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">ReversibleProcess</span><span class="p">):</span>
</span><span id="update_all_species-1295"><a href="#update_all_species-1295"><span class="linenos">1295</span></a>            <span class="n">forward_proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
</span><span id="update_all_species-1296"><a href="#update_all_species-1296"><span class="linenos">1296</span></a>            <span class="n">reverse_proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">,</span> <span class="n">proc</span><span class="o">.</span><span class="n">k_rev</span><span class="p">)</span>
</span><span id="update_all_species-1297"><a href="#update_all_species-1297"><span class="linenos">1297</span></a>            <span class="n">procs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
</span><span id="update_all_species-1298"><a href="#update_all_species-1298"><span class="linenos">1298</span></a>            <span class="n">procs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">forward_proc</span><span class="p">,</span> <span class="n">reverse_proc</span><span class="p">])</span>
</span><span id="update_all_species-1299"><a href="#update_all_species-1299"><span class="linenos">1299</span></a>
</span><span id="update_all_species-1300"><a href="#update_all_species-1300"><span class="linenos">1300</span></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">procs</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">procs</span><span class="p">),</span> \
</span><span id="update_all_species-1301"><a href="#update_all_species-1301"><span class="linenos">1301</span></a>        <span class="s2">&quot;WARNING: Duplicate processes found. Examine the list of processes to resolve this.&quot;</span>
</span><span id="update_all_species-1302"><a href="#update_all_species-1302"><span class="linenos">1302</span></a>
</span><span id="update_all_species-1303"><a href="#update_all_species-1303"><span class="linenos">1303</span></a>    <span class="n">all_species</span><span class="p">,</span> <span class="n">rspecies</span><span class="p">,</span> <span class="n">pspecies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="update_all_species-1304"><a href="#update_all_species-1304"><span class="linenos">1304</span></a>    <span class="n">procs_by_reactant</span><span class="p">,</span> <span class="n">procs_by_product</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="update_all_species-1305"><a href="#update_all_species-1305"><span class="linenos">1305</span></a>
</span><span id="update_all_species-1306"><a href="#update_all_species-1306"><span class="linenos">1306</span></a>    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
</span><span id="update_all_species-1307"><a href="#update_all_species-1307"><span class="linenos">1307</span></a>        <span class="n">all_species</span> <span class="o">=</span> <span class="n">all_species</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">species</span><span class="p">)</span>
</span><span id="update_all_species-1308"><a href="#update_all_species-1308"><span class="linenos">1308</span></a>        <span class="n">rspecies</span> <span class="o">=</span> <span class="n">rspecies</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">)</span>
</span><span id="update_all_species-1309"><a href="#update_all_species-1309"><span class="linenos">1309</span></a>        <span class="n">pspecies</span> <span class="o">=</span> <span class="n">pspecies</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">)</span>
</span><span id="update_all_species-1310"><a href="#update_all_species-1310"><span class="linenos">1310</span></a>
</span><span id="update_all_species-1311"><a href="#update_all_species-1311"><span class="linenos">1311</span></a>    <span class="c1"># Make a list containing the processes each reactant species takes part in.</span>
</span><span id="update_all_species-1312"><a href="#update_all_species-1312"><span class="linenos">1312</span></a>    <span class="c1"># This will be used when solving the system ODEs.</span>
</span><span id="update_all_species-1313"><a href="#update_all_species-1313"><span class="linenos">1313</span></a>    <span class="k">for</span> <span class="n">rspec</span> <span class="ow">in</span> <span class="n">rspecies</span><span class="p">:</span>
</span><span id="update_all_species-1314"><a href="#update_all_species-1314"><span class="linenos">1314</span></a>        <span class="k">if</span> <span class="n">rspec</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>  <span class="c1"># omit reactant species parsed from 0th order processes</span>
</span><span id="update_all_species-1315"><a href="#update_all_species-1315"><span class="linenos">1315</span></a>            <span class="n">procs_by_reactant</span><span class="p">[</span><span class="n">rspec</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">proc</span> <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span> <span class="k">if</span> <span class="n">rspec</span> <span class="ow">in</span> <span class="n">proc</span><span class="o">.</span><span class="n">reactants</span><span class="p">]</span>
</span><span id="update_all_species-1316"><a href="#update_all_species-1316"><span class="linenos">1316</span></a>            <span class="c1"># deleted 1st clause in above `if`: `rspec != &#39;&#39; and`</span>
</span><span id="update_all_species-1317"><a href="#update_all_species-1317"><span class="linenos">1317</span></a>
</span><span id="update_all_species-1318"><a href="#update_all_species-1318"><span class="linenos">1318</span></a>    <span class="c1"># Make a list containing the processes each product species takes part in.</span>
</span><span id="update_all_species-1319"><a href="#update_all_species-1319"><span class="linenos">1319</span></a>    <span class="c1"># This will be used for solving the system ODEs.</span>
</span><span id="update_all_species-1320"><a href="#update_all_species-1320"><span class="linenos">1320</span></a>    <span class="k">for</span> <span class="n">pspec</span> <span class="ow">in</span> <span class="n">pspecies</span><span class="p">:</span>
</span><span id="update_all_species-1321"><a href="#update_all_species-1321"><span class="linenos">1321</span></a>        <span class="k">if</span> <span class="n">pspec</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>  <span class="c1"># omitting product species parsed from degradation processes</span>
</span><span id="update_all_species-1322"><a href="#update_all_species-1322"><span class="linenos">1322</span></a>            <span class="n">procs_by_product</span><span class="p">[</span><span class="n">pspec</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">proc</span> <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span> <span class="k">if</span> <span class="n">pspec</span> <span class="ow">in</span> <span class="n">proc</span><span class="o">.</span><span class="n">products</span><span class="p">]</span>
</span><span id="update_all_species-1323"><a href="#update_all_species-1323"><span class="linenos">1323</span></a>
</span><span id="update_all_species-1324"><a href="#update_all_species-1324"><span class="linenos">1324</span></a>    <span class="k">return</span> <span class="n">all_species</span><span class="p">,</span> <span class="n">procs_by_reactant</span><span class="p">,</span> <span class="n">procs_by_product</span>
</span></pre></div>


            <div class="docstring"><p>Categorize all species in a list of processes.</p>

<p>Extract all species from a list of processes. Then categorize each of them
as a reactant or product and list the process(es) it takes part in.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>procs</strong> (tuple):
A tuple of objects of type <code><a href="#Process">Process</a></code> or its subclasses.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: all_species : set of strings
A set of all species present in the processes.
procs_by_reactant : dict
A dictionary whose keys are the species that are
reactants in one or more processes. The value for each
key is a list of processes.
procs_by_product : dict
A dictionary whose keys are the species that are
products in one or more processes. The value for each
key is a list of processes.</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>